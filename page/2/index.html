<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-BuuCTF-Misc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/BuuCTF-Misc/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:59:37.334Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><ul>
<li>gifframe捕捉帧</li>
</ul>
<h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><ul>
<li>binwalk检测出隐藏zip</li>
<li>foremost分离zip</li>
<li>azpr破解zip密码得到flag</li>
</ul>
<h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><ul>
<li>winhex查看，末尾存flag</li>
</ul>
<h2 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h2><ul>
<li>同上</li>
</ul>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><ul>
<li>图片高度隐藏，winhex修改图片高度即可</li>
</ul>
<h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><ul>
<li><p>假的exe文件，010打开发现是个base64，网站在线解码输出为png，是个二维码，扫码得flag</p>
</li>
<li><p>直接将原字符作为url获得二维码</p>
</li>
<li><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;png&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;img src=&quot;data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h2 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h2><ul>
<li>azpr破解zip密码</li>
</ul>
<h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><ul>
<li><p>wireshark捕获post请求即可</p>
<blockquote>
<p>http.request.method&#x3D;&#x3D;POST</p>
</blockquote>
</li>
</ul>
<h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><ul>
<li>右键属性即可</li>
</ul>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><ul>
<li>Stegsolve发现最上方隐写</li>
<li>输出为png二维码</li>
</ul>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><ul>
<li>修改deflags为0即可</li>
</ul>
<h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><ul>
<li>直接爆破四位数字</li>
</ul>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><ul>
<li>wireshark打开搜索flag</li>
</ul>
<h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><ul>
<li>qr直接识别</li>
</ul>
<h2 id="镜子中的世界"><a href="#镜子中的世界" class="headerlink" title="镜子中的世界"></a>镜子中的世界</h2><ul>
<li>LSB，RGB三个0</li>
</ul>
<h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><ul>
<li>提示加密，是个图片</li>
<li>binwalk分离zip，然后爆破zip密码</li>
</ul>
<h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><ul>
<li>同上</li>
</ul>
<h2 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h2><ul>
<li>同上，但是密码放在了图片属性里</li>
</ul>
<h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><ul>
<li>wireshark搜索追踪</li>
</ul>
<h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><ul>
<li>010搜索flag</li>
<li>base64</li>
<li>翻找没有意义，永远相信ctrlf</li>
</ul>
<h2 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h2><ul>
<li>010打开发现01串，转为acsii</li>
</ul>
<h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><ul>
<li>LSB rgb勾选保存为zip</li>
<li>linux运行elf文件</li>
</ul>
<h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><ul>
<li>爆破，brainfuck</li>
</ul>
<h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><ul>
<li>盲文解密压缩包，摩斯密码音频</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/BuuCTF-Misc/" data-id="clfwpfz5k0005vws48vgs28up" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-UNCTF2022" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/UNCTF2022/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:57:25.977Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="总述"><a href="#总述" class="headerlink" title="总述"></a>总述</h1><ul>
<li>这场比赛算是我第一场长时间全程投入的比赛，每天从早上打到晚上12点，不得不说，还挺享受整个过程。全程rank最好的时候是第3，前期分数拉满，中期乏力，最后两天直接冥想坐牢，比赛结束前半小时才A掉培根密码题，守住了rank19。后10名的分差是真的小，再加上最后垂直上分的佬，节目效果拉满，刺激。</li>
<li>赛题方面，从我的角度看的话：<ul>
<li>reverse方面的题可能不是很友好，重复+部分偏门。2个upx壳、1个手动壳，2个rust逆向，以及ast普及和小改xxtea。</li>
<li>crypto和misc方向的题目基本知识点覆盖还是比较全面的。很多东西之前都没有见过，纯google现场学习。尤其是隐写文章看了一大堆，虽然misc没写出几道…….太菜了</li>
</ul>
</li>
<li>整个比赛打下来确实学到不少东西，挺好</li>
</ul>
<h1 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><code>Reverse</code></h2><h3 id="whereisyourkey-广东海洋大学"><a href="#whereisyourkey-广东海洋大学" class="headerlink" title="whereisyourkey-广东海洋大学"></a>whereisyourkey-广东海洋大学</h3><ul>
<li>直接模拟加密过程就行了，不多说</li>
<li>远程linux调试elf执行到加密结束提取数据也行</li>
</ul>
<h3 id="halo-绍兴元培"><a href="#halo-绍兴元培" class="headerlink" title="halo-绍兴元培"></a>halo-绍兴元培</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`upx脱壳`，`逻辑运算`，`异或解密</span><br></pre></td></tr></table></figure>

<ul>
<li><p>这个题多少有点绕</p>
</li>
<li><p>最后用来校对的那一堆异或和或，只有每个异或结果为0条件才为真，也就是说单个异或的结果都是相等的，通过这里就可以得到操作过后的flag</p>
</li>
<li><p>中间的加密，通过分析代码可以发现规律</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f0 = f0^0  </span><br><span class="line">ff1 = f0^0^f1^1</span><br><span class="line">f2 = f2^2^f0^0^f1^1</span><br><span class="line"></span><br><span class="line">相当于，顺序加密：fn = fn-1 ^ n</span><br><span class="line"></span><br><span class="line">所以反过来异或回去就完了</span><br></pre></td></tr></table></figure>
</li>
<li><p>最上面还有个array^0x33，就是array数组第一位异或，弄一下就行</p>
</li>
<li><p>解密脚本</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">102</span>, <span class="number">0xb</span>,<span class="number">0x68</span>,<span class="number">0xc</span>,<span class="number">0x73</span>,<span class="number">0x3e</span>,<span class="number">0xc</span>,<span class="number">0x3a</span>,<span class="number">0x5d</span>,<span class="number">0x1b</span>,<span class="number">0x21</span>,<span class="number">0x75</span>,<span class="number">0x4f</span>,<span class="number">0x20</span>,<span class="number">0x4c</span>,<span class="number">0x71</span>,<span class="number">0x58</span>,<span class="number">0x7b</span>,<span class="number">0x59</span>,<span class="number">0x2c</span>,<span class="number">0x0</span>,<span class="number">0x77</span>,<span class="number">0x58</span>,<span class="number">0x77</span>,<span class="number">0xe</span>,<span class="number">0x72</span>,<span class="number">0x5b</span>,<span class="number">0x26</span>,<span class="number">0xb</span>,<span class="number">0x70</span>,<span class="number">0xa</span>,<span class="number">0x77</span>,<span class="number">0x66</span>,<span class="number">0x77</span>,<span class="number">0x36</span>,<span class="number">0x76</span>,<span class="number">0x37</span>,<span class="number">0x76</span>,<span class="number">0x62</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x27</span>,<span class="number">0x3f</span>,<span class="number">0x77</span>,<span class="number">0x26</span>]</span><br><span class="line">x = <span class="number">44</span></span><br><span class="line"><span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    list[x] = list[x]^list[x<span class="number">-1</span>]^x</span><br><span class="line">    x -= <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i in list:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;)</span></span><br><span class="line"><span class="string"># flag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对了，还有个upx脱壳，直接工具搞一下</p>
</li>
</ul>
<h3 id="ezzzzre-广东海洋大学"><a href="#ezzzzre-广东海洋大学" class="headerlink" title="ezzzzre-广东海洋大学"></a>ezzzzre-广东海洋大学</h3><ul>
<li><p>有个upx壳，工具脱掉</p>
</li>
<li><p>F5主函数</p>
</li>
<li><p>核心代码就这一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if ( Str[i] != 2 * aHelloctf[i] - 69 )</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取Helloctf[i]直接计算即可</p>
</li>
</ul>
<h3 id="Sudoku-陆军工程大学"><a href="#Sudoku-陆军工程大学" class="headerlink" title="Sudoku-陆军工程大学"></a>Sudoku-陆军工程大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`动态调试`，`数据提取`，`python</span><br></pre></td></tr></table></figure>

<ul>
<li><p>IDA反编F5+cmd运行测试</p>
</li>
<li><p>好像是个数独，分析一下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  </span><br><span class="line">  ......  </span><br><span class="line"><span class="comment">//生成检测数独</span></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">Prepare</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12) )		  </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !v12[<span class="number">9</span> * i + j] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">            v4[k] = <span class="number">0</span>;									<span class="comment">//生成函数</span></span><br><span class="line">          <span class="built_in">line</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i);</span><br><span class="line">          <span class="built_in">row</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, j);</span><br><span class="line">          <span class="built_in">SquireNine</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">          <span class="built_in">FillBlank</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//提示信息输出</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This is a game called Sudoku,just enjoy it!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Pls input your answer in the following format:&quot;</span>);</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v14, &amp;unk_4051C0, <span class="number">0x144</span>ui64);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)v14[<span class="number">9</span> * i + j]);		</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//输入数独</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Then you will get your flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v11[<span class="number">9</span> * i + j]);			              </span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//校验</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt;= <span class="number">8</span>; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v11[<span class="number">9</span> * k + m] != v12[<span class="number">9</span> * k + m] )			 </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Y0u_Ar3_Wr0ng!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Y0u_Ar3_R1ght!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第一眼就看到v11和v12比较，所以我们要想办法把v12搞出来，首先跟踪上面的生成函数，很复杂，那就动态调试，让机器生成v12我们去提取数据</p>
</li>
<li><p>v12生成函数结束后位置设断点，运行，然后f5反编找到v12对应栈位置，写脚本提取数据</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x000000000062FA10</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">81</span>*<span class="number">4</span>; i = i+<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%x &quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">	cnt = cnt + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(cnt % <span class="number">9</span> == <span class="number">0</span>)</span><br><span class="line">	   <span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8 5 2 4 9 1 6 7 3 </span></span><br><span class="line"><span class="comment">//1 9 6 7 3 8 2 5 4 </span></span><br><span class="line"><span class="comment">//4 3 7 5 6 2 9 1 8 </span></span><br><span class="line"><span class="comment">//5 2 8 1 4 6 3 9 7 </span></span><br><span class="line"><span class="comment">//3 7 4 9 2 5 8 6 1 </span></span><br><span class="line"><span class="comment">//9 6 1 3 8 7 4 2 5 </span></span><br><span class="line"><span class="comment">//2 1 9 8 5 4 7 3 6 </span></span><br><span class="line"><span class="comment">//7 4 3 6 1 9 5 8 2 </span></span><br><span class="line"><span class="comment">//6 8 5 2 7 3 1 4 9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>继续运行，输入提取的数独</p>
</li>
<li><p>运行到显示：</p>
<blockquote>
<p>UNCTF{chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)}</p>
</blockquote>
</li>
<li><p>python解一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;UNCTF&#123;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">15</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">24</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">39</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">25</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">32</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#125;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;OAOJYKOFR&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezast-浙江师范大学"><a href="#ezast-浙江师范大学" class="headerlink" title="ezast-浙江师范大学"></a>ezast-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`ast树`，`js`，`代码还原</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一口老血吐出来</p>
</li>
<li><p>第一次遇到这种题，研究了一下ast树，然后就开始手推源代码</p>
</li>
<li><p>一边构建代码看ast一边还原（得亏有个ast在线网站）</p>
</li>
<li><p>还原代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ezdecode</span>(<span class="params">flag,key</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> arr_data = flag.<span class="title function_">split</span>()</span><br><span class="line">  <span class="keyword">return</span> arr_data.<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i.<span class="title function_">charCodeAt</span>()^(key += <span class="number">1</span>))).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> $_a = <span class="title function_">test</span>()</span><br><span class="line">$_a -= <span class="number">1145</span>*<span class="number">100</span></span><br><span class="line">$_a += <span class="number">0xb</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ezdecode</span>(<span class="string">&quot;OTYN\\a[inE+iEl.hcEo)ivo+g&quot;</span>,$_a))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">114514</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>emmmm，每次只能解密一个字符，然后我就直接手删了半天加密串把flag构造出来了</p>
</li>
<li><p>对了，还有一个用来转义的\要删掉</p>
</li>
<li><p>UNCTF{Ast_1s_v4ry_u3slu1}</p>
</li>
</ul>
<h3 id="HelloRust"><a href="#HelloRust" class="headerlink" title="HelloRust"></a>HelloRust</h3><ul>
<li><p>这题，一切都在动调中</p>
</li>
<li><p>首先通过关键词检索识别为rc4加密</p>
</li>
<li><p>修改内存数据，将unctf等等一系列数据变为字符串</p>
</li>
<li><p>动调，在keyinit函数处找到密钥<code>Unctf2022</code></p>
</li>
<li><p>在cmp函数上方找到密文</p>
</li>
<li><p>提取密文</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x00005622B1A340A6</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; (<span class="number">0x00005622B1A340C1</span> - addr + <span class="number">1</span>); i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%02x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//876927216fc731261b6c3a749a626ea002811d85e0e2d071f4a3090e</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在线网站解密得到</p>
</li>
<li><p>unctf{Ru5t_Rc4_1s_2_e@zy!!!}</p>
</li>
</ul>
<h3 id="shelled-babyxor-重庆大学"><a href="#shelled-babyxor-重庆大学" class="headerlink" title="shelled_babyxor-重庆大学"></a>shelled_babyxor-重庆大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`手动脱壳`，`数据处理`，`逆写解密</span><br></pre></td></tr></table></figure>

<ul>
<li><p>提示脱壳+算法逆向，有点东西</p>
</li>
<li><p>脱壳只能手动，没发现常规的pushad之类的东西，但知道是运行自解密</p>
</li>
<li><p>x64dbg运行到解密位置，把程序dump出来拖进ida64</p>
</li>
<li><p>ctrl+f12搜索unctf，发现有，定位过去，x交叉引用，定位关键代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">FOOL:0000000000402E30 53                            push    rbx</span><br><span class="line">FOOL:0000000000402E31 48 83 EC 50                   sub     rsp, 50h</span><br><span class="line">FOOL:0000000000402E35 E8 06 EA FF FF                call    sub_401840</span><br><span class="line">FOOL:0000000000402E35</span><br><span class="line">FOOL:0000000000402E3A 48 8B 0D 1F 15 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E41 48 8D 5C 24 20                lea     rbx, [rsp+58h+var_38]</span><br><span class="line">FOOL:0000000000402E46 48 8D 15 B3 11 00 00          lea     rdx, aInputYourAnswe            ; &quot;input your answer\n&quot;</span><br><span class="line">FOOL:0000000000402E4D E8 26 E9 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E4D</span><br><span class="line">FOOL:0000000000402E52 48 8B 0D F7 14 00 00          mov     rcx, cs:off_404350</span><br><span class="line">FOOL:0000000000402E59 48 89 DA                      mov     rdx, rbx</span><br><span class="line">FOOL:0000000000402E5C E8 0F E9 FF FF                call    sub_401770</span><br><span class="line">FOOL:0000000000402E5C</span><br><span class="line">FOOL:0000000000402E61 48 89 D9                      mov     rcx, rbx</span><br><span class="line">FOOL:0000000000402E64 E8 07 E7 FF FF                call    sub_401570</span><br><span class="line">	;核心函数</span><br><span class="line">FOOL:0000000000402E64</span><br><span class="line">FOOL:0000000000402E69 85 C0                         test    eax, eax</span><br><span class="line">FOOL:0000000000402E6B 75 1B                         jnz     short loc_402E88</span><br><span class="line">FOOL:0000000000402E6B</span><br><span class="line">FOOL:0000000000402E6D 48 8B 0D EC 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E74 48 8D 15 B4 11 00 00          lea     rdx, aSorryYouAreWro            ; &quot;sorry you are wrong&quot;</span><br><span class="line">FOOL:0000000000402E7B E8 F8 E8 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E7B</span><br><span class="line">FOOL:0000000000402E80</span><br><span class="line">FOOL:0000000000402E80                               loc_402E80:                             ; CODE XREF: sub_402E30+6B↓j</span><br><span class="line">FOOL:0000000000402E80 31 C0                         xor     eax, eax</span><br><span class="line">FOOL:0000000000402E82 48 83 C4 50                   add     rsp, 50h</span><br><span class="line">FOOL:0000000000402E86 5B                            pop     rbx</span><br><span class="line">FOOL:0000000000402E87 C3                            retn</span><br><span class="line">FOOL:0000000000402E87</span><br><span class="line">FOOL:0000000000402E88                               ; ---------------------------------------------------------------------------</span><br><span class="line">FOOL:0000000000402E88</span><br><span class="line">FOOL:0000000000402E88                               loc_402E88:                             ; CODE XREF: sub_402E30+3B↑j</span><br><span class="line">FOOL:0000000000402E88 48 8B 0D D1 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E8F 48 8D 15 7D 11 00 00          lea     rdx, aYouAreRightWel            ; &quot;you are right!welcome to re&quot;</span><br><span class="line">FOOL:0000000000402E96 E8 DD E8 FF FF                call    sub_401778</span><br></pre></td></tr></table></figure>
</li>
<li><p>跟进函数发现只有sub_401570在大面积操作数据，F5跟进</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v2;</span><br><span class="line">    v1 += v3 % <span class="number">22</span>;			<span class="comment">//取余得到一个v1</span></span><br><span class="line">    <span class="keyword">if</span> ( v2 == &amp;v7[<span class="number">5</span>] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">115</span>; ; i = *&amp;v7[<span class="number">4</span> * v4 + <span class="number">5</span>] )	<span class="comment">//取数</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v1 ^ *(a1 + v4)) != i )	<span class="comment">//校对</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ++v4 == <span class="number">41</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>终于找到真正的核心了，直接逆写解密，先求v1</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1 = <span class="number">0</span>; </span><br><span class="line">  <span class="type">char</span> v7[] = <span class="string">&quot;unctfs&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">    v1 += (((<span class="type">int</span>)v7[i]) % <span class="number">22</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt;v1 &lt;&lt;endl;			<span class="comment">//38</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后拿38跟这函数给出的一堆数据异或了一下，能搞出UNCTF，那就是答案没跑了，整理数据（痛苦面具），直接写解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">num = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>):</span><br><span class="line">    num.append(<span class="number">4</span>*i+<span class="number">5</span>)</span><br><span class="line">v9 = [<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x60</span>,<span class="number">0x5D</span>,<span class="number">0x5F</span>,<span class="number">0x49</span>,<span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x4C</span>,<span class="number">0x53</span>,<span class="number">0x55</span>,<span class="number">0x52</span>, <span class="number">0x79</span>,<span class="number">0x53</span>, <span class="number">0x48</span>,<span class="number">0x56</span>,<span class="number">0x47</span>,<span class="number">0x45</span>, <span class="number">0x4D</span>,<span class="number">0x43</span>, <span class="number">0x42</span>,<span class="number">0x79</span>, <span class="number">0x5F</span>,<span class="number">0x49</span>, <span class="number">0x53</span>,<span class="number">0x54</span>, <span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x4F</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x52</span>,<span class="number">0x79</span>,<span class="number">0x56</span>, <span class="number">0x54</span>,<span class="number">0x49</span>, <span class="number">0x41</span>,<span class="number">0x54</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(v9))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v9:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">71</span>^<span class="number">38</span>))</span><br><span class="line"><span class="comment"># CTF&#123;you_just_unpacked_your_first_progra</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>然后，UN我之前验证了，没写，最后program}猜得出来，寄</p>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><code>Crypto</code></h2><h3 id="md5-1-西南科技大学"><a href="#md5-1-西南科技大学" class="headerlink" title="md5-1-西南科技大学"></a>md5-1-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5</span><br></pre></td></tr></table></figure>

<ul>
<li>像我这种大冤种直接造md5加密字典</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line">li = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,<span class="string">&#x27;8d9c307cb7f3c4a32822a51922d1ceaa&#x27;</span>,<span class="string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>,<span class="string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>,<span class="string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>,<span class="string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span> l.get(i):</span><br><span class="line">        <span class="built_in">print</span>(l[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="md5-2-西南科技大学"><a href="#md5-2-西南科技大学" class="headerlink" title="md5-2-西南科技大学"></a>md5-2-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5`，`异或</span><br></pre></td></tr></table></figure>

<ul>
<li>多了个异或罢了，注意长度不够补位就行^_^</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成表</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">x = [<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&quot;^&quot;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    str2 = i</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检验</span></span><br><span class="line">li = [<span class="number">0x4c614360da93c0a041b22e537de151eb</span>,<span class="number">0xc1fd731c6d60040369908b4a5f309f41</span>,<span class="number">0x80fdc84bbb5ed9e207a21d5436efdcfd</span>,<span class="number">0xb48d19bb99a7e6bb448f63b75bc92384</span>,<span class="number">0x39eaf918a52fcaa5ed9195e546b021c1</span>,<span class="number">0x795d6869f32db43ff5b414de3c235514</span>,<span class="number">0xf59a054403f933c842e9c3235c136367</span>,<span class="number">0xc80b37816048952a3c0fc9780602a2fa</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xcad06891e0c769c7b02c228c8c2c8865</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x4bdea6676e5335f857fa8e47249fa1d8</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xedbb7ab78cde98a07b9b5a2ab284bf0a</span>,<span class="number">0x44b43e07e9af05e3b9b129a287e5a8df</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xabed1f675819a2c0f65c9b7da8cab301</span>,<span class="number">0x738c486923803a1b59ef17329d70bbbd</span>,<span class="number">0x7e209780adf2cd1212e793ae8796ed7c</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0x636a84a33e1373324d64463eeb8e7614</span>,<span class="number">0x6ec65b4ab061843b066cc2a2f16820d5</span>,<span class="number">0xa4a39b59eb036a4a8922f7142f874114</span>,<span class="number">0x8c34745bd5b5d42cb3efe381eeb88e4b</span>,<span class="number">0x5b1ba76b1d36847d632203a75c4f74e2</span>,<span class="number">0xd861570e7b9998dbafb38c4f35ba08bc</span>,<span class="number">0x464b7d495dc6019fa4a709da29fc7952</span>,<span class="number">0x8eb69528cd84b73d858be0947f97b7cc</span>,<span class="number">0xdd6ac4c783a9059d11cb0910fc95d4a</span>,<span class="number">0x4b6b0ee5d5f6b24e6898997d765c487c</span>,<span class="number">0xb0762bc356c466d6b2b8f6396f2e041</span>,<span class="number">0x8547287408e2d2d8f3834fc1b90c3be9</span>,<span class="number">0x82947a7d007b9854fa62efb18c9fd91f</span>,<span class="number">0x8ddafe43b36150de851c83d80bd22b0a</span>,<span class="number">0xc7b36c5f23587e285e528527d1263c8b</span>,<span class="number">0x2a0816e8af86e68825c9df0d63a28381</span>,<span class="number">0x63ce72a42cf62e6d0fdc6c96df4687e3</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] ^= li[cnt - <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] = <span class="built_in">hex</span>(li[cnt])</span><br><span class="line">    li[cnt] = li[cnt][<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(i) != <span class="number">32</span>):</span><br><span class="line">        i1 = <span class="string">&#x27;0&#x27;</span> + i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i1 = i</span><br><span class="line">    <span class="keyword">if</span> l.get(i1):</span><br><span class="line">        <span class="built_in">print</span>(l[i1],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;false&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="dddd-西南科技大学"><a href="#dddd-西南科技大学" class="headerlink" title="dddd-西南科技大学"></a>dddd-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">摩斯密码</span><br></pre></td></tr></table></figure>

<ul>
<li>摩斯密码01解密，这不写了吧</li>
</ul>
<h3 id="caesar-西南科技大学"><a href="#caesar-西南科技大学" class="headerlink" title="caesar-西南科技大学"></a>caesar-西南科技大学</h3><ul>
<li><p>题目提示了base64表</p>
</li>
<li><p>UNCTF校验发现是+45替换，逆写即可</p>
</li>
<li><p>脚本(坑点是得去掉末尾空格)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s=  <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">w = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> w:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span>(s.index(i) &gt;= <span class="number">45</span>):</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i) - <span class="number">45</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i)+<span class="number">45</span>-<span class="number">64</span>-<span class="number">26</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezxor-浙江师范大学"><a href="#ezxor-浙江师范大学" class="headerlink" title="ezxor-浙江师范大学"></a>ezxor-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`多次一密`，`数据还原</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一个假题，劣质多次一密QAQ</p>
</li>
<li><p>decode密文，伪造flag与密文异或得到残缺明文，寻找英文单词特征比对求解，1小时的快乐没了</p>
<blockquote>
<p>UNCTF{Y0u_are_very_Clever!!!}</p>
</blockquote>
</li>
</ul>
<h3 id="Single-table-西南科技大学"><a href="#Single-table-西南科技大学" class="headerlink" title="Single table-西南科技大学"></a>Single table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`playfair</span><br></pre></td></tr></table></figure>

<ul>
<li><p>很明显变种Playfair加密</p>
</li>
<li><p>根据实例修改表</p>
</li>
<li><p>B C D E F<br>G H I K M<br>N O Q R S<br>T U V W X<br>Z P L A Y</p>
</li>
<li><p>还原即可</p>
<ul>
<li>不同行不同列优先取后一个字母对应行元素</li>
<li>同行取左</li>
<li>同列取上</li>
</ul>
</li>
<li><p>得到（注意下划线位置要换一下，哦对还有去掉x，我记得有人有群u吐槽这个下划线来着）</p>
<blockquote>
<p>UNCTF{GOD_YOU_KNOW_PLAYFAIR}</p>
</blockquote>
</li>
</ul>
<h3 id="Multi-table-西南科技大学"><a href="#Multi-table-西南科技大学" class="headerlink" title="Multi table-西南科技大学"></a>Multi table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`维吉尼亚密码（Vigenere）</span><br></pre></td></tr></table></figure>

<h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><ul>
<li>这个题就是构造了一个循环序的字母字典table</li>
<li>还有一个乱序的匹配字母表base_table</li>
<li>然后随机生成查询key</li>
<li>加密flag<ul>
<li>首先查询base_table中字母位置</li>
<li>替换为字典key键对应位置的值</li>
</ul>
</li>
</ul>
<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><ul>
<li><p>首先用UNCT还原出key是多少，再逆写加密就可</p>
</li>
<li><p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字典表</span></span><br><span class="line">table = &#123;<span class="number">0</span>: <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;BCDEFGHIJKLMNOPQRSTUVWXYZA&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;CDEFGHIJKLMNOPQRSTUVWXYZAB&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;DEFGHIJKLMNOPQRSTUVWXYZABC&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;EFGHIJKLMNOPQRSTUVWXYZABCD&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;FGHIJKLMNOPQRSTUVWXYZABCDE&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;GHIJKLMNOPQRSTUVWXYZABCDEF&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;HIJKLMNOPQRSTUVWXYZABCDEFG&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;IJKLMNOPQRSTUVWXYZABCDEFGH&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;JKLMNOPQRSTUVWXYZABCDEFGHI&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;KLMNOPQRSTUVWXYZABCDEFGHIJ&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;LMNOPQRSTUVWXYZABCDEFGHIJK&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;MNOPQRSTUVWXYZABCDEFGHIJKL&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;NOPQRSTUVWXYZABCDEFGHIJKLM&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;OPQRSTUVWXYZABCDEFGHIJKLMN&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;PQRSTUVWXYZABCDEFGHIJKLMNO&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;QRSTUVWXYZABCDEFGHIJKLMNOP&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;RSTUVWXYZABCDEFGHIJKLMNOPQ&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;STUVWXYZABCDEFGHIJKLMNOPQR&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;TUVWXYZABCDEFGHIJKLMNOPQRS&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;UVWXYZABCDEFGHIJKLMNOPQRST&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;VWXYZABCDEFGHIJKLMNOPQRSTU&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;WXYZABCDEFGHIJKLMNOPQRSTUV&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;XYZABCDEFGHIJKLMNOPQRSTUVW&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;YZABCDEFGHIJKLMNOPQRSTUVWX&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;ZABCDEFGHIJKLMNOPQRSTUVWXY&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># 乱序表</span></span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="comment"># 密文flag</span></span><br><span class="line">flag = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 还原key</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;U&#x27;</span>)) <span class="comment">#0  9</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;N&#x27;</span>)) <span class="comment">#1  14</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;C&#x27;</span>)) <span class="comment">#2  5</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;T&#x27;</span>)) <span class="comment">#3  16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">9</span>] == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key0=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">14</span>] == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key1=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">5</span>] == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key2=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">16</span>] == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key3=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line"><span class="comment"># 还原flag</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">key=[<span class="number">9</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">16</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] <span class="keyword">in</span> base_table:</span><br><span class="line">        <span class="built_in">print</span>(base_table[table[key[x%<span class="number">4</span>]].index(flag[i])],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="easy-RSA-中国人民公安大学"><a href="#easy-RSA-中国人民公安大学" class="headerlink" title="easy_RSA-中国人民公安大学"></a>easy_RSA-中国人民公安大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`:`rsa已知p高位攻击</span><br></pre></td></tr></table></figure>

<ul>
<li><p>看到&gt;&gt;200，是个RSA高位攻击，直接开搞</p>
</li>
<li><p>去网站<a target="_blank" rel="noopener" href="https://sagecell.sagemath.org/">Sage Cell Server (sagemath.org)</a> 先把roots爆出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857s</span><br><span class="line">p4 = p4 &lt;&lt; <span class="number">200</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>
</li>
<li><p>解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">roots = [<span class="number">358950849615278333731635244854025425463656033006805723630685</span>]</span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606623830215547787830024125178567428699965091733811241451081695232</span></span><br><span class="line">p= p2 + roots[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Today-is-Thursday-V-me-50-海南大学"><a href="#Today-is-Thursday-V-me-50-海南大学" class="headerlink" title="Today_is_Thursday_V_me_50-海南大学"></a>Today_is_Thursday_V_me_50-海南大学</h3><ul>
<li><p>这个题就是纯考察逆向解密能力，大喜，啊不，大悲</p>
</li>
<li><p>对flag先加密1，再加密2，得到结果。逆写，还是逆写</p>
</li>
<li><p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 题目信息</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = <span class="number">530007872419584476649862008487908643412379763189507583587632</span></span><br><span class="line">x = <span class="string">&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"><span class="comment">#生成25位随机数序列</span></span><br><span class="line">random.seed(key1_num)</span><br><span class="line">ran = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    ran.append(temp_num)</span><br><span class="line"><span class="comment"># 异或解密（encrypt2）</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    temp = bytes_to_long(<span class="built_in">bytes</span>(x[i], encoding=<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    flag.append(temp^ran[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仿写encrypt1，得出最后的异或串</span></span><br><span class="line">guess=[(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    what = guess.pop(<span class="number">50</span>)</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">    mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line"><span class="comment"># 虽然计算了四轮，但最终用于使用的串只有最后一轮</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line">n4 = <span class="string">&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag[i] ^= <span class="built_in">ord</span>(n4[i])</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;1_l0ve_Thurs4Ay!!!&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezRSA-广东海洋大学"><a href="#ezRSA-广东海洋大学" class="headerlink" title="ezRSA-广东海洋大学"></a>ezRSA-广东海洋大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`z3求解`，`rsa基础流程</span><br></pre></td></tr></table></figure>

<ul>
<li><p>非常规rsa公私钥制作，反而变简单了</p>
</li>
<li><p>第一眼 p^4 &#x3D; n，z3直接求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">p = Real(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(p**<span class="number">4</span> == <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>
</li>
<li><p>cdn正常解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p = <span class="number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span></span><br><span class="line">phi = p**<span class="number">4</span> - p**<span class="number">3</span></span><br><span class="line">d = libnum.invmod(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="babyRSA-广东海洋大学"><a href="#babyRSA-广东海洋大学" class="headerlink" title="babyRSA-广东海洋大学"></a>babyRSA-广东海洋大学</h3><ul>
<li><p>明文高位攻击，直接sage脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">high_m = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后把M转一下。。。。。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">x =<span class="number">0x554e4354467b32376130616163372d373663622d343237642d393132392d3134373633363064356431627d</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(x))</span><br><span class="line"><span class="comment"># UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="今晚吃什么-金陵科技学院"><a href="#今晚吃什么-金陵科技学院" class="headerlink" title="今晚吃什么-金陵科技学院"></a>今晚吃什么-金陵科技学院</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`培根密码</span><br></pre></td></tr></table></figure>

<ul>
<li><p>10000和00000串，5位，结合题目今晚吃什么，估计是培根密码</p>
</li>
<li><p>提取每个串的首位构成新串，写脚本替换为培根密码格式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lis = [<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;10000&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;B&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cnt % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;/&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># AAABA/BAAAA/BABBA/ABBBA/BAAAA/ABBAB/ABAAA/BAAAB/AABAB/BAABB/ABBAA</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>去网站解密得到flag</p>
<blockquote>
<p>UNCTF{CRYPROISFUN}</p>
</blockquote>
</li>
</ul>
<h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><ul>
<li><p>费马小定理： 如果p是一个质数，而整数a不是p的倍数，则有a(p-1)≡1（mod p）</p>
</li>
<li><p>推导</p>
<ul>
<li>gift+x &#x3D; xp</li>
<li>gift &#x3D; (p-1)*x</li>
<li>2x*(p-1) ≡ 1(mod p)</li>
<li>2x*(p-1) - 1 &#x3D; x * p</li>
<li>2gift -1 &#x3D; x*p</li>
<li>结合n &#x3D; p*q</li>
<li>p &#x3D; gcd(n, 2gift -1)</li>
<li>p &#x3D; gcd(n, powmod(2, gift, n))</li>
</ul>
</li>
<li><p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n =  <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">gift = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line"></span><br><span class="line">gift = <span class="built_in">pow</span>(<span class="number">2</span>,gift,n) - <span class="number">1</span></span><br><span class="line">p = libnum.gcd(gift,n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><code>Misc</code></h2><h3 id="magic-word-西南科技大学"><a href="#magic-word-西南科技大学" class="headerlink" title="magic_word-西南科技大学"></a>magic_word-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`零宽隐写</span><br></pre></td></tr></table></figure>

<ul>
<li>提示明显，零宽隐写，文档cv到<a target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></li>
<li>解密就完事了</li>
</ul>
<blockquote>
<p>unctf{We1come_new_ctfer}</p>
</blockquote>
<ul>
<li>一开始没改大写WA了一发，血亏</li>
</ul>
<h3 id="巨鱼-河南理工大学"><a href="#巨鱼-河南理工大学" class="headerlink" title="巨鱼-河南理工大学"></a>巨鱼-河南理工大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`图片大小隐写`，`zip伪加密`，`文件合成`，`ppt隐写</span><br></pre></td></tr></table></figure>

<ul>
<li><p>拿到图片先常规检查，改了改宽高，发现多出一行字“无所谓我会出手”，可能有用</p>
</li>
<li><p>然后kali试着foremost了一下，发现图片隐藏了zip，提取出来打开</p>
</li>
<li><p>010查看zip，真加密，拿刚才找出来的字试了一下，密码正确</p>
</li>
<li><p>提取出来又是一层zip，还是有加密，010打开一眼看到总标志位0000，伪加密</p>
</li>
<li><p>翻看标志位unshortdeflag，为1的全改回0，去伪加密</p>
</li>
<li><p>一个flag文件夹，一个化学式和一个加密的pptx，网上查了化学式名字都不对，发现叫六六粉，试了666，正确，出题人真6</p>
</li>
<li><p>打开pptx，提示flagnothere，最后一页pptx无内容，猜测同色隐藏到背景里了，全选更换字体颜色，得到flag</p>
<blockquote>
<p>UNCTF{y0u_F1nd_1t!}</p>
</blockquote>
</li>
<li><p>这题多写几个字以表敬意（</p>
</li>
</ul>
<h3 id="syslog-浙江师范大学"><a href="#syslog-浙江师范大学" class="headerlink" title="syslog-浙江师范大学"></a>syslog-浙江师范大学</h3><ul>
<li><p>提示看压缩包，结合题目的syslog</p>
</li>
<li><p>上kali，binwalk -e文件，打开日志查看</p>
</li>
<li><p>搜索password发现base64</p>
</li>
<li><pre><code>cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA==
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 解密得到密码</span><br><span class="line"></span><br><span class="line">- 输入得到flag</span><br><span class="line"></span><br><span class="line">  &gt; unctf&#123;N1_sH3_D0n9_L0g_dE!&#125;</span><br><span class="line"></span><br><span class="line">### 找得到我吗-闽南师范大学</span><br><span class="line"></span><br><span class="line">- 打开文档全选设定文字颜色，发现3k字大作文，但是好像没用，废话文学是玩明白了</span><br><span class="line"></span><br><span class="line">- 常规检测，binwalk分离转出xml</span><br><span class="line"></span><br><span class="line">- 一大堆东西挨个看</span><br><span class="line"></span><br><span class="line">- document.xml中搜索flag得到结果</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;You_find_me!&#125;</span><br><span class="line"></span><br><span class="line">### 社什么社-湖南警察学院</span><br><span class="line"></span><br><span class="line">- 凤凰古城不错，以后一定去看看</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;4F0198127A45F66C07A5B1A2DDA8223C&#125;</span><br><span class="line"></span><br><span class="line">### In_the_Morse_Garden-陆军工程大学</span><br><span class="line"></span><br></pre></td></tr></table></figure>
知识点`：`base64`，`word隐写`，`摩斯密码
</code></pre>
</li>
</ul>
<pre><code>
- pdf打开，ctrl+A发现图片下面有东西，提取出来

- UNCTF&#123;….=&#125;，base64解密

- 花园宝宝乱入

- 只有玛卡巴卡和依古比古，加上题目，morse解密（空格是摩斯断点，因为这个卡了半天，服了）

- &gt; UNCTF&#123;WAN_AN_MAKA_BAKAAAAA!&#125;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/UNCTF2022/" data-id="clfwpfz5r000kvws49qv3b2zy" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Ast" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Ast/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:56:49.490Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><h3 id="ast树-抽象语法树"><a href="#ast树-抽象语法树" class="headerlink" title="ast树(抽象语法树)"></a>ast树(抽象语法树)</h3><h3 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h3><ul>
<li>是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。</li>
</ul>
<h3 id="简单描述"><a href="#简单描述" class="headerlink" title="简单描述"></a>简单描述</h3><ul>
<li>其实很简单，ast树就跟一本书的目录一样，只不过这个目录更加详细。以一种提取关键词和功能的方式完美展现一段代码的层次关系</li>
</ul>
<h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><p>例如js代码<code>x = a + b</code>生成<code>ast</code>树：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&quot;type&quot;: &quot;AssignmentExpression&quot;,</span><br><span class="line">&quot;start&quot;: 0,</span><br><span class="line">&quot;end&quot;: 7,</span><br><span class="line">&quot;operator&quot;: &quot;=&quot;,</span><br><span class="line">&quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 0,</span><br><span class="line">    &quot;end&quot;: 1,</span><br><span class="line">    &quot;name&quot;: &quot;x&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;BinaryExpression&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 5,</span><br><span class="line">    &quot;name&quot;: &quot;a&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;operator&quot;: &quot;+&quot;,</span><br><span class="line">    &quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 6,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;name&quot;: &quot;b&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到其内容是十分详细的：</p>
<ul>
<li>name：目标元素，作用对象</li>
<li>start，end：name对象在程序代码中的起止位置</li>
<li>operator：执行操作</li>
<li>type：操作种类，比如说一个函数、一个返回值、一个运算、一个变量等等</li>
</ul>
<h3 id="在线生成ast树结构网站："><a href="#在线生成ast树结构网站：" class="headerlink" title="在线生成ast树结构网站："></a>在线生成ast树结构网站：</h3><ul>
<li><a target="_blank" rel="noopener" href="https://astexplorer.net/">https://astexplorer.net/</a></li>
</ul>
<h2 id="ast逆向"><a href="#ast逆向" class="headerlink" title="ast逆向"></a>ast逆向</h2><ul>
<li>目前我接触的这方面东西也很少，基本上要做的事情只有两种：<ol>
<li>给一个ast树，然后让你去除其中的混淆操作</li>
<li>给定ast还原代码，这个代码可以是js，也可以是其他任何语言</li>
</ol>
</li>
<li>对于代码还原，这种很难有现成工具使用，小代码手推，大代码自己写针对脚本</li>
<li>手推的话：<ul>
<li>定位operator先还原运算表达式</li>
<li>由内层向外，还原一部分删一部分树结构</li>
<li>独立度大的优先，按函数模块还原</li>
<li>自己写对应代码生成ast树比对</li>
</ul>
</li>
<li>大概就这样</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Ast/" data-id="clfwpfz5j0004vws40squdssl" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Bug" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Bug/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:54:32.997Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="漏洞相关"><a href="#漏洞相关" class="headerlink" title="漏洞相关"></a>漏洞相关</h1><h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要注意栈向低地址生长，栈中的变量向高地址生长，所以溢出后覆盖的是高地址区域，逆向中可用来隐藏信息以及关键函数入口等等</span><br></pre></td></tr></table></figure>

<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">testFunc</span><span class="params">(<span class="type">char</span> *Buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> testBuf[<span class="number">8</span>];</span><br><span class="line">	<span class="built_in">memcpy</span>(testBuf, Buf, <span class="number">64</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> Buf[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">memset</span>(Buf, <span class="number">0x41</span>, <span class="number">64</span>);</span><br><span class="line">	<span class="built_in">testFunc</span>(Buf);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ul>
<li><p>testfunc中给8字节的testbuf数组赋值了64字节数据溢出，从而导致函数返回地址错误</p>
</li>
<li><pre><code class="asm">0019FE90 41414141
0019FE94 00401057 返回到 test.00401057 自 test.00401430
0019FE98 41414141
0019FE9C 41414141
0019FEA0 41414141
0019FEA4 41414141
0019FEA8 41414141
0019FEAC 41414141
0019FEB0 41414141
0019FEB4 41414141
0019FEB8 41414141
0019FEBC 41414141
0019FEC0 41414141
0019FEC4 41414141
0019FEC8 41414141
0019FECC 41414141
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#### 防范</span><br><span class="line"></span><br><span class="line">  ```c++</span><br><span class="line">  //加入长度判断</span><br><span class="line">  int maxsize = 8;</span><br><span class="line">  if(maxsize &gt; sizeof(testBuf))</span><br><span class="line">  &#123;</span><br><span class="line">      //数据截断</span><br><span class="line">   	memcpy(testBuf, Buf, maxsize);   </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<h3 id="堆溢出"><a href="#堆溢出" class="headerlink" title="堆溢出"></a>堆溢出</h3><h3 id="整型溢出（赋值类型大小不匹配）"><a href="#整型溢出（赋值类型大小不匹配）" class="headerlink" title="整型溢出（赋值类型大小不匹配）"></a>整型溢出（赋值类型大小不匹配）</h3><ol>
<li><p>存储溢出</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line">	<span class="type">short</span> b = a;</span><br><span class="line">	cout &lt;&lt;<span class="string">&quot;0x&quot;</span> &lt;&lt;hex &lt;&lt;b &lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0x5678,丢失数据</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运算溢出（计算后超出原类型数据范围，导致溢出）</p>
</li>
<li><p>符号问题</p>
</li>
</ol>
<h3 id="UAF漏洞"><a href="#UAF漏洞" class="headerlink" title="UAF漏洞"></a>UAF漏洞</h3><ul>
<li><p>use-after-free</p>
</li>
<li><p>大致过程</p>
<ul>
<li>函数A顺序调用B、C、D三个子函数</li>
<li>函数B释放了函数中的一部分资源，让函数中的某些指针变为空指针</li>
<li>函数C又申请使用刚才释放的资源空间（干坏事）</li>
<li>D函数判断不严密，导致刚才释放的空指针被继续使用</li>
</ul>
</li>
<li><p>相当于就是：在一个空间资源被释放后，将恶意信息注入该空间，然后又在不知情的情况下继续使用了该空间，引发漏洞</p>
</li>
<li><p>星盟公开课的一段代码（不知道哪出了问题，暂时没有预期输出）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> target[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *p = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">	<span class="built_in">free</span>(p);</span><br><span class="line">	p[<span class="number">0</span>] = target; <span class="comment">// p_chunk-&gt;fd is modified</span></span><br><span class="line">	target[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// prev size</span></span><br><span class="line">	target[<span class="number">1</span>] = <span class="number">0x21</span>; <span class="comment">// size</span></span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as p</span></span><br><span class="line">	<span class="type">char</span> *q = <span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as target</span></span><br><span class="line">	<span class="built_in">memcpy</span>(q, <span class="string">&quot;hello&quot;</span>,<span class="number">6</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,&amp;target[<span class="number">2</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="加脱壳相关"><a href="#加脱壳相关" class="headerlink" title="加脱壳相关"></a>加脱壳相关</h1><ul>
<li>通俗地讲，不管是压缩壳还是加密壳，都是附着于原程序，对其进行各种处理。然后在程序加载到内存中时，先运行壳的解压引擎还原程序，再执行程序。二者的界限也越来越模糊</li>
<li>为了保证效率，对于一个压缩引擎，我们要保证他有足够快的解压速度，以确保程序在运行时的速度。至于压缩速度就略显不重要</li>
</ul>
<h4 id="压缩壳"><a href="#压缩壳" class="headerlink" title="压缩壳"></a>压缩壳</h4><ul>
<li>upx</li>
<li>ASpack</li>
</ul>
<h4 id="加密壳"><a href="#加密壳" class="headerlink" title="加密壳"></a>加密壳</h4><ul>
<li>ASProtect</li>
<li>Armadillo：双进程运行，cc保护</li>
<li>EXECryptor</li>
<li>Themida</li>
</ul>
<h4 id="虚拟机保护"><a href="#虚拟机保护" class="headerlink" title="虚拟机保护"></a>虚拟机保护</h4><ul>
<li>VMProtect</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Bug/" data-id="clfwpfz5l0007vws45g553i1g" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Android" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Android/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:51:42.351Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="安卓系统架构"><a href="#安卓系统架构" class="headerlink" title="安卓系统架构"></a>安卓系统架构</h2><ul>
<li>应用层</li>
<li>应用框架<ul>
<li>应用开发组件、开发包</li>
</ul>
</li>
<li>dalvik虚拟机<ul>
<li>Google自己设计用于Android平台的虚拟机，可支持.dex格式的java应用程序运行</li>
</ul>
</li>
<li>linux内核<ul>
<li>包括一些系统驱动等</li>
</ul>
</li>
</ul>
<h2 id="apk目录结构"><a href="#apk目录结构" class="headerlink" title="apk目录结构"></a>apk目录结构</h2><ol>
<li>assets<ul>
<li>静态文件，apk所使用的各种资源，比如图片、视频等等，通过API获取</li>
</ul>
</li>
<li>res<ul>
<li>编译后的资源文件</li>
</ul>
</li>
<li>lib<ul>
<li>so动态链接库，用于底层的一些调用</li>
</ul>
</li>
<li>dex<ul>
<li>虚拟机可执行文件，主要逆向目标</li>
</ul>
</li>
<li>META-INF<ul>
<li>数字签名，用于校验apk是否被篡改</li>
</ul>
</li>
<li>AndroidManifest.xml<ul>
<li>一个应用程序的配置清单，声明权限、组件等的基本信息</li>
</ul>
</li>
<li>resources.arsc<ul>
<li>编译后资源的位置与id之间的映射关系</li>
</ul>
</li>
</ol>
<h2 id="Android四大组件"><a href="#Android四大组件" class="headerlink" title="Android四大组件"></a>Android四大组件</h2><ol>
<li>activity<ul>
<li>用户可视化界面</li>
<li>safe：1.点击劫持 2.拒绝服务 3.组件导出</li>
</ul>
</li>
<li>service<ul>
<li>用于后台实现操作，如后台接受微信消息</li>
<li>safe：1.串谋攻击 2.拒绝服务</li>
</ul>
</li>
<li>content provider<ul>
<li>为应用提供数据，统一接口</li>
<li>safe：1.数据库注入</li>
</ul>
</li>
<li>broadcast receiver<ul>
<li>信息传输机制</li>
<li>safe：恶意广播</li>
</ul>
</li>
</ol>
<p>注：所有组件均需在AndroidManifest中注册声明</p>
<p>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/ican87/article/details/21874321">(1条消息) android四大组件(详细总结)_87now的博客-CSDN博客_android的四大组件</a></p>
<h2 id="Android打包流程"><a href="#Android打包流程" class="headerlink" title="Android打包流程"></a>Android打包流程</h2><h2 id="Android安装流程"><a href="#Android安装流程" class="headerlink" title="Android安装流程"></a>Android安装流程</h2><ul>
<li>复制APk安装包到data&#x2F;app目录下，解压扫描安装包，把dex文件保存到dalvik-cache目录，并在data&#x2F;data目录创建对应的应用数据。（AndroidManifest.xml）</li>
</ul>
<h2 id="arm流水线"><a href="#arm流水线" class="headerlink" title="arm流水线"></a>arm流水线</h2><ul>
<li>PC：程序计数器。永远指向取指地址</li>
<li>IF：取指。同时确定下一条指令地址（指针指向下一条指令）</li>
<li>ID：译码。同时给出即将使用的寄存器，或者让立即数进行拓展，亦或者是给出转移目的寄存器与转移条件（转移指令）</li>
<li>EX：执行。</li>
<li>MEM：访存。若为load&#x2F;store指令，这个阶段就要访问存储器。另外，在这个阶段还要判定是否有异常要处理，如果有，那么就清除流水线，然后转移到异常处理例程入口地址处继续执行</li>
<li>WB：回写。将运算结果保存到目标寄存器</li>
</ul>
<h4 id="三级流水线"><a href="#三级流水线" class="headerlink" title="三级流水线"></a>三级流水线</h4><ul>
<li>取指–&gt;译码–&gt;执行</li>
<li>pc–&gt;pc-4–&gt;pc-8 (arm7)</li>
</ul>
<h4 id="五级流水线"><a href="#五级流水线" class="headerlink" title="五级流水线"></a>五级流水线</h4><ul>
<li>取指–&gt;译码–&gt;执行–&gt;访存–&gt;回写 (arm9)</li>
</ul>
<h4 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h4><ul>
<li>我觉得需要强调的一个点是理论和实践是不一样的。不一定所有指令都要经历流水线的每个过程</li>
<li>具体参考文章：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/438259856">CPU设计—五级流水线 - 知乎 (zhihu.com)</a></li>
</ul>
<h2 id="ADB"><a href="#ADB" class="headerlink" title="ADB"></a>ADB</h2><ul>
<li>adb devices 列出当前安卓设备</li>
<li>adb shell 进入安卓linux命令行</li>
<li>adb push 上传</li>
<li>adb pull 下载</li>
<li>adb connect ip连接设备</li>
<li>adb kill-server 断开连接</li>
<li>adb forward tcp:23946 tcp:23946 端口转移到本地</li>
<li>adb shell dumpsys activity top 查看顶层页面信息</li>
<li>adb shell dbinfo 查看app使用的数据库信息</li>
<li>adb shell screencap -p [path] 截屏</li>
<li>adb shell input text [text] 文本框输入</li>
<li>adb shell pm install &#x2F; pm uninstall &#x2F; pm list packages</li>
<li>adb shell am start-activity -D -N [包名] debug</li>
</ul>
<h2 id="termux使用"><a href="#termux使用" class="headerlink" title="termux使用"></a>termux使用</h2><ul>
<li>下载地址：<a target="_blank" rel="noopener" href="https://f-droid.org/packages/com.termux/">Termux | F-Droid - Free and Open Source Android App Repository</a></li>
</ul>
<h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><ul>
<li><p>termux-setup-storage 获取存储权限</p>
</li>
<li><p>pkg install &lt;软件名&gt; 安装软件</p>
</li>
<li><p>pkg upgrade 更新软件</p>
<p>termux-change-repo 切换源</p>
</li>
</ul>
<h2 id="静态插桩"><a href="#静态插桩" class="headerlink" title="静态插桩"></a>静态插桩</h2><ul>
<li>找到函数入口点</li>
</ul>
<h2 id="敏感信息"><a href="#敏感信息" class="headerlink" title="敏感信息"></a>敏感信息</h2><h4 id="动态注册"><a href="#动态注册" class="headerlink" title="动态注册"></a>动态注册</h4><ul>
<li>Jni_OnLoad</li>
</ul>
<h4 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h4><ul>
<li>getPackageManager</li>
<li>getPackageInfo</li>
<li>signatures</li>
</ul>
<h4 id="模拟器检测"><a href="#模拟器检测" class="headerlink" title="模拟器检测"></a>模拟器检测</h4><ul>
<li>checkcpuinfo</li>
</ul>
<h4 id="反调试"><a href="#反调试" class="headerlink" title="反调试"></a>反调试</h4><ul>
<li>android-server</li>
</ul>
<h2 id="apktool反编译命令"><a href="#apktool反编译命令" class="headerlink" title="apktool反编译命令"></a>apktool反编译命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apktool目录进入命令行</span><br><span class="line">apktool.bat d 反编译文件</span><br></pre></td></tr></table></figure>

<h2 id="dex2-jdgui反编译"><a href="#dex2-jdgui反编译" class="headerlink" title="dex2+jdgui反编译"></a>dex2+jdgui反编译</h2><ol>
<li>修改apk文件后缀为zip，解压</li>
<li>将反编的dex文件复制到dex2jar工具目录下</li>
<li>使用命令生成jar文件</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar.bat document_name.dex</span><br></pre></td></tr></table></figure>

<p>如果出现下列报错(版本号不匹配):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">com.googlecode.d2j.DexException: not support version.</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:151)</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:211)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:104)</span><br><span class="line">     at com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:288)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:32)</span><br></pre></td></tr></table></figure>


<p>用文本编辑软件打开dex文件，将文件头改为035或者036</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dex</span><br><span class="line">037 9!Q&lt;€颧€?滣^氶wl?  p   x</span><br></pre></td></tr></table></figure>


<p>正常情况应该是这样的(没有任何多余)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\SoftWarePackage\Jd-GUI+dex2\dex2jar-2.0&gt;d2j-dex2jar.bat classes3.dex</span><br><span class="line">    dex2jar classes3.dex -&gt; .\classes3-dex2jar.jar</span><br></pre></td></tr></table></figure>



<ol>
<li><p>用jd-guijar反编译jar文件，命令是这个：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jd-gui-1.5.0.jar</span><br></pre></td></tr></table></figure>

<ul>
<li>其实就是执行jar文件而已，可以直接写bat桌面一键打开</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Android/" data-id="clfwpfz5i0002vws4bff4cy86" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-GFSJ-Android" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/GFSJ-Android/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:50:10.810Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="app1"><a href="#app1" class="headerlink" title="app1"></a>app1</h3><ul>
<li>jad直接反编译，MainActivity发现版本号与版本名的异或</li>
<li><code>水题</code>，<code>简单使用工具</code></li>
</ul>
<h3 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy-apk"></a>easy-apk</h3><ul>
<li>变表base64</li>
<li><code>水题</code></li>
</ul>
<h3 id="app2"><a href="#app2" class="headerlink" title="app2"></a>app2</h3><ul>
<li>逻辑分析SecondActivity，从而找到加密so文件，确定AES加密，解密</li>
<li><code>so分析</code>，<code>AES</code></li>
</ul>
<h3 id="easy-so"><a href="#easy-so" class="headerlink" title="easy-so"></a>easy-so</h3><ul>
<li>同样从java代码找到so文件关键代码分析，两个简单换位加密</li>
<li><code>so分析</code>，<code>简单加密</code></li>
</ul>
<h3 id="easy-jni"><a href="#easy-jni" class="headerlink" title="easy-jni"></a>easy-jni</h3><ul>
<li>毫无新意，同样so分析，变表base64加换位</li>
</ul>
<h3 id="RememberOther"><a href="#RememberOther" class="headerlink" title="RememberOther"></a>RememberOther</h3><ul>
<li>评价就是有病</li>
<li>直接jadx查看逻辑发现啥都不填return true，MD5解密+安卓就是flag</li>
</ul>
<h3 id="基础android"><a href="#基础android" class="headerlink" title="基础android"></a>基础android</h3><ul>
<li>好题，java层简单加密，以及对广播的一个考察</li>
<li><code>简单逆向</code>，<code>Broadcast</code>，<code>页面跳转</code>，<code>文件流</code></li>
</ul>
<h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><ul>
<li>ab文件–&gt;安卓备份文件</li>
<li>先用<a target="_blank" rel="noopener" href="https://github.com/nelenkov/android-backup-extractor">abe</a>提取一下apk</li>
<li>java -jar abe.jar unpack app3.ab app3.tar</li>
<li>破解数据库密码</li>
<li><a target="_blank" rel="noopener" href="https://github.com/sqlitebrowser/sqlitebrowser">sqlitebrowser</a> 打开携带的数据库找到flag</li>
<li><code>sqlite</code>、<code>安卓备份</code></li>
</ul>
<h3 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h3><ul>
<li>同样是native层对flag的一个加密，解法很多</li>
<li>本质就是一个getflag函数外套了一个getSecret函数，IDA分析getSecret发现就是一个rot1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(this.getSecret(this.getFlag()).equals(this.getSecret(this.encrypt(sInput)))) &#123;</span><br><span class="line">          Toast.makeText(this, <span class="string">&quot;Success&quot;</span>, <span class="number">1</span>).show();</span><br></pre></td></tr></table></figure>

<ul>
<li>1：直接androidkiller篡改代码，打印出执行完getSecret(getflag())函数的返回值，然后进行回转得到flag</li>
<li>2：jeb下断点，动调获得返回值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;ek`fz@q2^x/t^fn0mF^6/^rb`qanqntfg^E`hq|&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>native</code>,<code>hook</code></li>
</ul>
<h3 id="APK逆向"><a href="#APK逆向" class="headerlink" title="APK逆向"></a>APK逆向</h3><ul>
<li>java层仿写加密即可，但是md5加密时候给我报错了：<ul>
<li>Unhandled exception: java.security.NoSuchAlgorithmException</li>
</ul>
</li>
<li>所以我直接jeb动调把加密后的串提取出来了</li>
<li>逻辑分析也可以，不难</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        checkSN(<span class="string">&quot;Tenshine&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">toHexString</span><span class="params">(<span class="type">byte</span>[] bytes, String separator)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(b &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hexString.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            hexString.append(hex).append(separator);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hexString.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkSN</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hexstr</span> <span class="operator">=</span> <span class="string">&quot;b9c77224ff234f27ac6badf83b855c76&quot;</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hexstr.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">            sb.append(hexstr.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userSN</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">        System.out.println(userSN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>难度一般</li>
</ul>
<h3 id="人民的名义-抓捕赵德汉1-200"><a href="#人民的名义-抓捕赵德汉1-200" class="headerlink" title="人民的名义-抓捕赵德汉1-200"></a>人民的名义-抓捕赵德汉1-200</h3><ul>
<li>🤡题，生成flag的md5结果裸奔，直接拿去解密即可</li>
<li>原意应该是利用hexkey对&#x2F;ClassEnc文件进行aes解密，得到已经存在的CheckPass代码，然后生成passCheckObject对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">filename=<span class="string">&quot;ClassEnc&quot;</span></span><br><span class="line">key = <span class="string">&quot;bb27630cf264f8567d185008c10c3f96&quot;</span></span><br><span class="line">key_bytes = <span class="built_in">bytes</span>.fromhex(key)</span><br><span class="line">aes = AES.new((key_bytes), AES.MODE_ECB)</span><br><span class="line">data = <span class="built_in">bytearray</span>(os.path.getsize(filename))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.readinto(data)</span><br><span class="line">	f.close()</span><br><span class="line">decryption_data = aes.decrypt(data)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+<span class="string">&quot;_decryption.classs&quot;</span>, <span class="string">&#x27;ba&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decryption_data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h3 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h3><ul>
<li>native层的一个题，加密类似于栅栏密码之后三组异或，分别解开就行</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分组init</span></span><br><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">Init</span><span class="params">(<span class="type">char</span> *a2, <span class="type">char</span> *a3, <span class="type">const</span> <span class="type">char</span> *a4, <span class="type">int</span> a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r6</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = v5 % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (v7== <span class="number">2</span>)&#123;</span><br><span class="line">      a3[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">1</span>)&#123;</span><br><span class="line">      a2[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">0</span>)&#123;</span><br><span class="line">      *(v5/<span class="number">3</span>) = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(a5 != v5);</span><br><span class="line">&#125;</span><br><span class="line">s1 = <span class="string">&quot;fgorl&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;l&#123;sra&quot;</span></span><br><span class="line">s3 = <span class="string">&quot;asoy&#125;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">	<span class="built_in">print</span>(s1[i]+s2[i]+s3[i],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="easy-dex"><a href="#easy-dex" class="headerlink" title="easy-dex"></a>easy-dex</h3><h4 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h4><ul>
<li>这个题蛮有意思，把dex文件放进了native层</li>
<li>so文件拖进IDA找到android-main函数定位关键代码</li>
<li>之后分析解密dump出dex文件，放进原apk中重新识别</li>
<li>jadx分析发现twofish加密，在线网站解密</li>
</ul>
<h4 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h4><ul>
<li>dex段的数据，可以看到从0x7004开始，长度为0x34c10。</li>
<li>至于dex的加密，他是设定了10秒摇手机90次，然后用dex文件段的数据分10组去和摇晃次数做一个异或，最后释放解密的dex文件，进行正常的程序运行，这里放一个网上的代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取数据</span></span><br><span class="line">fLib = <span class="built_in">open</span>(<span class="string">&quot;libnative.so&quot;</span>,<span class="string">&quot;rb&quot;</span>);</span><br><span class="line">fLib.seek(<span class="number">0x6004</span>, <span class="number">0</span>);</span><br><span class="line">read_buf = fLib.read(<span class="number">0x3CA10</span>)</span><br><span class="line">fDump = <span class="built_in">open</span>(<span class="string">&quot;out.dump&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">fDump.write(read_buf);</span><br><span class="line">fDump.close();</span><br><span class="line">fLib.close();</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/out.dump&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    data_len = <span class="built_in">len</span>(data)</span><br><span class="line">    decode_bytes = [<span class="number">0</span>] * data_len</span><br><span class="line"><span class="comment"># 分组异或</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">        per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">        start = i * per_seg_len</span><br><span class="line">        <span class="keyword">while</span> start &lt; (i + <span class="number">1</span>) * per_seg_len:</span><br><span class="line">            decode_bytes[start] = data[start] ^ (i * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 末端</span></span><br><span class="line">    per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">    start = <span class="number">9</span> * per_seg_len</span><br><span class="line">    <span class="keyword">while</span> start &lt; data_len:</span><br><span class="line">        decode_bytes[start] = data[start] ^ <span class="number">89</span></span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 解压写文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/decode.dex&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(zlib.decompress(<span class="built_in">bytes</span>(decode_bytes)))</span><br><span class="line">java--&gt;native`，`twofish加密`，`dumpdex</span><br></pre></td></tr></table></figure>

<h3 id="boomshakalaka-3"><a href="#boomshakalaka-3" class="headerlink" title="boomshakalaka-3"></a>boomshakalaka-3</h3><ul>
<li>这个题本身不难，但跟鬼打了一样</li>
<li>一个老版飞机大战游戏，jadx打开发现两个包plane和lib，lib明显是原本的游戏，plane是出题人加的</li>
<li>核心在于<code>SharedPreferences接口</code>的数据传输，查资料后了解到这玩意会在&#x2F;data&#x2F;data&#x2F;package name&#x2F;shared_prefs目录以xml格式接受数据</li>
<li>查看Cocos2dxPrefsFile.xml，结合游戏，发现是一个不断追加字符的过程，没在java层找到对应代码，那就去so</li>
<li>so加载了老半天，发现一个score函数，里面就是不断加字符，然后结合题目要求最高分，所以按分数顺序把字符添上得到终极字符串</li>
<li>最后根据题目给出的传参提示串<code>YmF6aW5nYWFhYQ==</code>猜测base64，解码得到flag</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">native`,`cocos2d`,``SharedPreferences</span><br></pre></td></tr></table></figure>

<h3 id="Illusion"><a href="#Illusion" class="headerlink" title="Illusion"></a>Illusion</h3><ul>
<li>发现关键调用checkflag，同时encflag已知，进入so分析</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">encflag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(MainActivity.<span class="built_in">this</span>.getAssets().open(<span class="string">&quot;Flag&quot;</span>))).readLine();</span><br><span class="line"></span><br><span class="line">CheckFlag(flag, encflag))</span><br></pre></td></tr></table></figure>

<ul>
<li>直接搜索checkflag函数，是个假函数，未经调用</li>
<li>搜索onload函数，找到动态加载的真正checkflag函数进行分析</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_DC8</span><span class="params">(_JNIEnv *a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [sp+28h] [bp-34h]</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// [sp+30h] [bp-2Ch]</span></span><br><span class="line">  <span class="type">char</span> *v9; <span class="comment">// [sp+34h] [bp-28h]</span></span><br><span class="line">  <span class="type">char</span> *v10; <span class="comment">// [sp+38h] [bp-24h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a3);	<span class="comment">//input flag</span></span><br><span class="line">  v4 = <span class="built_in">j_strlen</span>(v10);</span><br><span class="line">  v9 = <span class="built_in">j_calloc</span>(<span class="number">1u</span>, v4 + <span class="number">1</span>);</span><br><span class="line">  v8 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a4);	<span class="comment">//encflag</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(v10); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_10C0</span>(v10[i] + aLjavaLangStrin_0[i] - <span class="number">64</span>, <span class="number">93</span>);</span><br><span class="line">    v9[i] = v5 + <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">j_strcmp</span>(v9, v8) )</span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Try Again!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>分析sub_10C0函数，第一层的if判断必为真，只执行第一个函数，函数目的为<code>a1%a2</code>，思路明了，写脚本</li>
<li>网友这个脚本还是有东西的</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">enc_flag = <span class="string">&quot;Ku@&#x27;G_V9v(yGS&quot;</span></span><br><span class="line">data = <span class="string">&quot;(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;&quot;</span></span><br><span class="line">data = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    enc = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> enc_flag]</span><br><span class="line">    flag = [<span class="number">0</span>]*<span class="built_in">len</span>(enc)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        flag[i] = (enc[i]-<span class="number">32</span>)+<span class="number">64</span>-data[i]</span><br><span class="line">        <span class="keyword">while</span> flag[i] &lt; <span class="number">0x32</span>:</span><br><span class="line">            flag[i] += <span class="number">93</span></span><br><span class="line">        <span class="keyword">while</span> flag[i] &gt; <span class="number">125</span>:</span><br><span class="line">            flag[i] -= <span class="number">93</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># CISCN&#123;GJ5728&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/GFSJ-Android/" data-id="clfwpfz5m0009vws4gb0w8rrv" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Android-RE" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Android-RE/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:47:54.171Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Smail"><a href="#Smail" class="headerlink" title="Smail"></a>Smail</h1><h3 id="寄存器命名"><a href="#寄存器命名" class="headerlink" title="寄存器命名"></a>寄存器命名</h3><ul>
<li>均为32位，64位用2个寄存器</li>
<li>p：p0、p1 函数参数</li>
<li>v：v0、v1 函数内部变量</li>
</ul>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><table>
<thead>
<tr>
<th>数据类型——Smail</th>
<th>数据类型——Java</th>
</tr>
</thead>
<tbody><tr>
<td>V</td>
<td>void</td>
</tr>
<tr>
<td>Z</td>
<td>boolean</td>
</tr>
<tr>
<td>B</td>
<td>byte</td>
</tr>
<tr>
<td>S</td>
<td>string</td>
</tr>
<tr>
<td>C</td>
<td>char</td>
</tr>
<tr>
<td>I</td>
<td>int</td>
</tr>
<tr>
<td>J</td>
<td>long</td>
</tr>
<tr>
<td>F</td>
<td>float</td>
</tr>
<tr>
<td>D</td>
<td>double</td>
</tr>
</tbody></table>
<ul>
<li>数组：[+数据类型 eg：[I &lt;&#x3D;&#x3D;&gt; int[]</li>
</ul>
<h3 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h3><ul>
<li>.class&lt;访问权限&gt;&lt;关键修饰字&gt;&lt;类名&gt;</li>
<li>.super&lt;父类名&gt;</li>
<li>.source&lt;源文件名&gt;</li>
</ul>
<h3 id="函数声明"><a href="#函数声明" class="headerlink" title="函数声明"></a>函数声明</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.method&lt;访问权限&gt;&lt;关键修饰字&gt;&lt;方法原型（返回值类型）&gt;</span><br><span class="line">&lt;.locals/.registers&gt;		    		# 非参数变量数目</span><br><span class="line">[.param]								# 声明方法中的参数名</span><br><span class="line">[.line]									# 源码中的行号</span><br><span class="line">.end method</span><br></pre></td></tr></table></figure>

<h3 id="常量操作指令"><a href="#常量操作指令" class="headerlink" title="常量操作指令"></a>常量操作指令</h3><ul>
<li>const</li>
<li>const-string v1,”re” 将string类型常量re放进寄存器v1</li>
</ul>
<h3 id="方法调用指令"><a href="#方法调用指令" class="headerlink" title="方法调用指令"></a>方法调用指令</h3><ul>
<li>invoke-kind {vA、vB}, method@DDDD</li>
<li>invoke-(virtual、super、static | 正常函数、父类函数、静态函数) { 传入参数 }，方法名</li>
</ul>
<h3 id="移位指令"><a href="#移位指令" class="headerlink" title="移位指令"></a>移位指令</h3><ul>
<li>move</li>
<li>move-result-object v0 将上一步的函数返回值存进v0</li>
</ul>
<h3 id="分支判断指令"><a href="#分支判断指令" class="headerlink" title="分支判断指令"></a>分支判断指令</h3><ul>
<li>if-eq：如果vA等于vB则跳转。Java语法表示为“if(vA &#x3D;&#x3D; vB)”</li>
<li>if-ne：如果vA不等于vB则跳转。Java语法表示为“if(vA !&#x3D; vB)”</li>
<li>if-lt：如果vA小于vB则跳转。Java语法表示为“if(vA &lt; vB)”</li>
<li>if-ge：如果vA大于等于vB则跳转。Java语法表示为“if(vA &gt;&#x3D; vB)”</li>
<li>if-gt：如果vA大于vB则跳转。Java语法表示为“if(vA &gt; vB)”</li>
<li>if-le：如果vA小于等于vB则跳转。Java语法表示为“if(vA &lt;&#x3D; vB)”</li>
<li>if-testz vAA, +BBBB：条件跳转指令。拿vAA寄存器与0比较，如果比较结果满足或值为0时就跳转到BBBB指定的偏移处。偏移量BBBB不能为0。 if-testz类型的指令有以下几条：</li>
<li>if-eqz：如果vAA为0则跳转。Java语法表示为“if(vAA &#x3D;&#x3D; 0)”</li>
<li>if-nez：如果vAA不为0则跳转。Java语法表示为“if(vAA !&#x3D; 0)”</li>
<li>if-ltz：如果vAA小于0则跳转。Java语法表示为“if(vAA &lt; 0)”</li>
<li>if-gez：如果vAA大于等于0则跳转。Java语法表示为“if(vAA &gt;&#x3D; 0)”</li>
<li>if-gtz：如果vAA大于0则跳转。Java语法表示为“if(vAA &gt; 0)”</li>
<li>if-lez：如果vAA小于等于0则跳转。Java语法表示为“if(vAA &lt;&#x3D; 0)”</li>
</ul>
<h1 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h1><h2 id="frida（hook框架）安装配置及基本使用"><a href="#frida（hook框架）安装配置及基本使用" class="headerlink" title="frida（hook框架）安装配置及基本使用"></a>frida（hook框架）安装配置及基本使用</h2><h4 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h4><ul>
<li>pip install frida &gt; 核心</li>
<li>pip install frida-tools &gt; 工具包</li>
<li>frida –version &gt; 版本检测</li>
<li><a target="_blank" rel="noopener" href="https://github.com/frida/frida/releases">Releases · frida&#x2F;frida (github.com)</a>安装对应版本的server，如server-android-x86</li>
<li>将刚才下载的server文件上传到安卓手机中</li>
</ul>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><ul>
<li><p>在手机中给server文件可执行权限并运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x 文件</span><br><span class="line">./文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>在cmd中执行命令</p>
<ul>
<li>frida-ps -Ua 列出当前正在运行的程序</li>
<li>frida -U -f 包名 hook对应程序</li>
</ul>
</li>
</ul>
<h3 id="Objection配置使用"><a href="#Objection配置使用" class="headerlink" title="Objection配置使用"></a>Objection配置使用</h3><ul>
<li>基于frida框架的一个自动化脚本集成</li>
<li>安装：pip3 install objection</li>
</ul>
<h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><ul>
<li>Objection -g 包名&#x2F;PID explore 注入app进程</li>
<li>android root disable 绕过root检测</li>
<li>android proxy set 设置代理</li>
<li>android sslpinning disable 绕过证书固定</li>
</ul>
<h2 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.retest.MainActivity&#x27;</span>)</span><br><span class="line">        <span class="comment">//overload重载</span></span><br><span class="line">        <span class="title class_">MainActivity</span>.<span class="property">fun</span>.<span class="title function_">overload</span>(<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            ...</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure>

<h2 id="类函数和实例方法主动调用"><a href="#类函数和实例方法主动调用" class="headerlink" title="类函数和实例方法主动调用"></a>类函数和实例方法主动调用</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.retest.MainActivity&#x27;</span>)</span><br><span class="line">        <span class="comment">//静态函数，直接调用</span></span><br><span class="line">        <span class="title class_">MainActivity</span>.<span class="title function_">staticsecret</span>()</span><br><span class="line">        </span><br><span class="line">		<span class="comment">//动态函数主动调用</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&#x27;com.example.retest.MainActicity&#x27;</span>,&#123;</span><br><span class="line">            <span class="comment">//实例化对象</span></span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="comment">//调用</span></span><br><span class="line">                instance.<span class="title function_">secret</span>()</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;search Complete&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Android-RE/" data-id="clfwpfz5h0001vws43br98i5f" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-GFSJ-Re" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/GFSJ-Re/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:45:22.583Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><ul>
<li>在初始化函数中隐藏关键代码</li>
<li>找到关键代码动调就行</li>
</ul>
<h3 id="rev300"><a href="#rev300" class="headerlink" title="rev300"></a>rev300</h3><ul>
<li>水题，恢复switch递归（模拟递归求解序号应该最快）得到a1，然后异或</li>
</ul>
<h3 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h3><ul>
<li><p>乱序循环-&gt;异或加密</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a[<span class="number">100</span>] = &#123;<span class="number">0x5f</span>,<span class="number">0xf2</span>,<span class="number">0x5e</span>,<span class="number">0x8b</span>,<span class="number">0x4e</span>,<span class="number">0xe</span>,<span class="number">0xa3</span>,<span class="number">0xaa</span>,<span class="number">0xc7</span>,<span class="number">0x93</span>,<span class="number">0x81</span>,<span class="number">0x3d</span>,<span class="number">0x5f</span>,<span class="number">0x74</span>,<span class="number">0xa3</span>,<span class="number">0x9</span>,<span class="number">0x91</span>,<span class="number">0x2b</span>,<span class="number">0x49</span>,<span class="number">0x28</span>,<span class="number">0x93</span>,<span class="number">0x67</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">22</span>; i++)&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>  j = <span class="number">0</span>, v24 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(j &lt; i)&#123;</span><br><span class="line">			v24 = <span class="number">1828812941</span> * v24 + <span class="number">12345</span>;</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt;(<span class="type">char</span>)(v24^a[i<span class="number">-1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="re4-unvm-me"><a href="#re4-unvm-me" class="headerlink" title="re4-unvm-me"></a>re4-unvm-me</h3><ul>
<li>纯水题，pyc反编md5直接解密</li>
</ul>
<h3 id="tt3441810"><a href="#tt3441810" class="headerlink" title="tt3441810"></a>tt3441810</h3><ul>
<li>抽象十六进制数据文件，过滤得到flag</li>
</ul>
<h3 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h3><ul>
<li><p>这个题我觉得不错</p>
</li>
<li><p><code>if ( v5 == 14 &amp;&amp; (*(unsigned int (__fastcall **)(char *))judge)(s) )</code></p>
</li>
<li><p>这里的judge明显是个函数，但是看反编又是个数组，说明是个花指令，通过前面的执行修改机器码实现函数</p>
</li>
<li><p>所以想PatchByte、CP恢复函数，再写脚本如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	string  s = <span class="string">&quot;fmcd&quot;</span>;</span><br><span class="line"> 	<span class="type">int</span> v2 = <span class="number">127</span>;</span><br><span class="line">  	string s1 = <span class="string">&quot;k7d;V`;np&quot;</span>;</span><br><span class="line">  	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; i++)&#123;</span><br><span class="line">  		cout &lt;&lt;(<span class="type">char</span>)(s[i] ^ i);</span><br><span class="line">  	&#125;</span><br><span class="line">  	cout &lt;&lt;(<span class="type">char</span>)(v2^<span class="number">4</span>);</span><br><span class="line">  	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">5</span>; i &lt;= <span class="number">13</span>; i++)&#123;</span><br><span class="line">  		cout &lt;&lt;(<span class="type">char</span>)(s1[i<span class="number">-5</span>] ^ i);	</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><ul>
<li>一个nspack壳，利用pushad，popad手动脱掉就行，然后就是个简单异或</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	string s = <span class="string">&quot;this_is_not_flag&quot;</span>;</span><br><span class="line">	<span class="type">int</span> a[<span class="number">100</span>] = &#123;<span class="number">0x12</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0x4a</span>,<span class="number">0x3d</span>,<span class="number">0x56</span>,<span class="number">0x0a</span>,<span class="number">0x10</span>,<span class="number">0x67</span>,<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x46</span>,<span class="number">0x5a</span>,<span class="number">0x44</span>,<span class="number">0x42</span>,<span class="number">0x6e</span>,<span class="number">0x0c</span>,<span class="number">0x44</span>,<span class="number">0x72</span>,<span class="number">0x0c</span>,<span class="number">0x0d</span>,<span class="number">0x40</span>,<span class="number">0x3e</span>,<span class="number">0x4b</span>,<span class="number">0x5f</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x4c</span>,<span class="number">0x5e</span>,<span class="number">0x5b</span>,<span class="number">0x17</span>,<span class="number">0x6e</span>,<span class="number">0x0c</span>,<span class="number">0x16</span>,<span class="number">0x68</span>,<span class="number">0x5b</span>,<span class="number">0x12</span>,<span class="number">0x00</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)&#123;</span><br><span class="line">		cout &lt;&lt;(<span class="type">char</span>)(s[i%<span class="number">16</span>]^a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><ul>
<li>.net题目，dnspy打开，通过调试到入口点找到关键代码</li>
</ul>
<h3 id="EASYHOOK"><a href="#EASYHOOK" class="headerlink" title="EASYHOOK"></a>EASYHOOK</h3><ul>
<li>hook函数修改值跳转到真正加密函数</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> lis[<span class="number">100</span>] = &#123;<span class="number">0x61</span>,<span class="number">0x6a</span>,<span class="number">0x79</span>,<span class="number">0x67</span>,<span class="number">0x6b</span>,<span class="number">0x46</span>,<span class="number">0x6d</span>,<span class="number">0x2e</span>,<span class="number">0x7f</span>,<span class="number">0x5f</span>,<span class="number">0x7e</span>,<span class="number">0x2d</span>,<span class="number">0x53</span>,<span class="number">0x56</span>,<span class="number">0x7b</span>,<span class="number">0x38</span>,<span class="number">0x6d</span>,<span class="number">0x4c</span>,<span class="number">0x6e</span>,<span class="number">0x00</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">18</span>)&#123;</span><br><span class="line">			lis[i] ^= <span class="number">0x13</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(i % <span class="number">2</span>)&#123;</span><br><span class="line">				lis[i] ^= i;</span><br><span class="line">				lis[i] += i;</span><br><span class="line">			&#125;<span class="keyword">else</span></span><br><span class="line">				lis[i] ^= i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">2</span>; i-=<span class="number">2</span>)&#123;</span><br><span class="line">		lis[i] = lis[i<span class="number">-2</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)&#123;</span><br><span class="line">		cout &lt;&lt;(<span class="type">char</span>)lis[i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ReverseMe-120"><a href="#ReverseMe-120" class="headerlink" title="ReverseMe-120"></a>ReverseMe-120</h3><ul>
<li>输入–&gt;base64解码–&gt;异或</li>
</ul>
<h2 id="key"><a href="#key" class="headerlink" title="key"></a>key</h2><ul>
<li>这题有点别调，字符串检索找到关键代码，然后根据加密逆写就行，建议7.0版本以下ida</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	string s = <span class="string">&quot;themidathemidathemida&quot;</span>;</span><br><span class="line">	string t = <span class="string">&quot;&gt;----++++....&lt;&lt;&lt;&lt;.&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">		s[i] = (s[i]^t[i]) + <span class="number">22</span> + <span class="number">9</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">		cout &lt;&lt;(<span class="type">char</span>)s[i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h2><ul>
<li>pipe、fork双进程</li>
<li>利用必然跳转让ida反汇编错误</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     [ebp+var_D], al</span><br><span class="line">mov     [ebp+var_C], 0</span><br><span class="line">cmp     [ebp+var_C], 1</span><br><span class="line">jnz     short loc_80486D3</span><br></pre></td></tr></table></figure>

<ul>
<li>去掉必然跳转以后重新反汇编仿写逻辑即可</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> v2[<span class="number">100</span>];</span><br><span class="line">	string a1 = <span class="string">&quot;69800876143568214356928753&quot;</span>;</span><br><span class="line"></span><br><span class="line">	  v2[<span class="number">0</span>] = <span class="number">2</span> * a1[<span class="number">1</span>];</span><br><span class="line">	  v2[<span class="number">1</span>] = a1[<span class="number">4</span>] + a1[<span class="number">5</span>];</span><br><span class="line">	  v2[<span class="number">2</span>] = a1[<span class="number">8</span>] + a1[<span class="number">9</span>];</span><br><span class="line">	  v2[<span class="number">3</span>] = <span class="number">2</span> * a1[<span class="number">12</span>];</span><br><span class="line">	  v2[<span class="number">4</span>] = a1[<span class="number">18</span>] + a1[<span class="number">17</span>];</span><br><span class="line">	  v2[<span class="number">5</span>] = a1[<span class="number">10</span>] + a1[<span class="number">21</span>];</span><br><span class="line">	  v2[<span class="number">6</span>] = a1[<span class="number">9</span>] + a1[<span class="number">25</span>];</span><br><span class="line">	 <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; v2[i]; i++)&#123;</span><br><span class="line">	 	std::cout &lt;&lt;(<span class="type">char</span>)v2[i];</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations"></a>Newbie_calculations</h3><ul>
<li>三个函数组成的一长串，就是简单的加减乘混淆</li>
</ul>
<h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><ul>
<li>杨辉三角题目，贴个简单分析代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  //不断输入数字flag</span><br><span class="line">  do&#123;</span><br><span class="line">    v0 = v3++;</span><br><span class="line">    scanf(<span class="string">&quot;%d&quot;</span>, v0);</span><br><span class="line">  &#125;<span class="keyword">while</span> (*(v3 - <span class="number">1</span>));</span><br><span class="line">  //验证杨辉三角每一层之和为<span class="number">2</span>^&lt;sub&gt;n-<span class="number">1</span>&lt;/sub&gt;</span><br><span class="line">  v2 = sub_80486CD(&amp;unk_8049BE0);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == -<span class="number">1</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  //验证杨辉三角第n层的第i个元素等于前n-<span class="number">1</span>层第i-<span class="number">1</span>个元素的和</span><br><span class="line">  <span class="keyword">if</span> ( sub_8048783(&amp;unk_8049BE0, v2) != <span class="number">1</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(v2 == <span class="number">20</span>)&#123;   //确定一共<span class="number">20</span>层</span><br><span class="line">    puts(<span class="string">&quot;Congratulations! fl4g is :\nRCTF&#123;md5(/*what you input without space or \\n~*/)&#125;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>所以将杨辉三角前20层的数字顺序拼接即可，网友脚本：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">triangles</span>():</span><br><span class="line">	s=[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">yield</span> s</span><br><span class="line">		s.append(<span class="number">0</span>)</span><br><span class="line">		s=[s[i-<span class="number">1</span>]+s[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line">n=<span class="number">0</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> triangles():</span><br><span class="line">	flag+=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,i))</span><br><span class="line">	n+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> n==<span class="number">20</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag=hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;RCTF&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h3><ul>
<li>迷宫题，首先根据传参确定7*7迷宫以及迷宫存储位置</li>
<li>动调到输入之前，即step_2函数之前，获取迷宫，得到flag</li>
</ul>
<h3 id="serial-150"><a href="#serial-150" class="headerlink" title="serial-150"></a>serial-150</h3><ul>
<li>有花指令，动调恢复代码推断即可</li>
</ul>
<h3 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h3><ul>
<li>c++逆向，关键函数stringmod分析如下</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">stringMod</span><span class="params">(__int64 *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// r9</span></span><br><span class="line">  __int64 v2; <span class="comment">// r10</span></span><br><span class="line">  __int64 cnt; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> *v5; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> *v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// er9</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// er10</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> mod3; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v14[<span class="number">18</span>]; <span class="comment">// [rsp+0h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+48h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v14, <span class="number">0</span>, <span class="built_in">sizeof</span>(v14));</span><br><span class="line">  v2 = *flag;</span><br><span class="line">  cnt = v4 = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//第三位判断逻辑</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123; </span><br><span class="line">    v14[cnt] = v2[cnt]; </span><br><span class="line">    <span class="keyword">if</span>(cnt % <span class="number">3</span> == <span class="number">0</span>)&#123; v14[cnt] == firstchar[cnt / <span class="number">3</span>]; &#125;</span><br><span class="line">    ++cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( cnt != <span class="built_in">len</span>(flag));</span><br><span class="line"></span><br><span class="line"><span class="comment">//flag进行异或</span></span><br><span class="line">  v5 = v14;</span><br><span class="line">  v6 = v14;</span><br><span class="line">  v7 = <span class="number">666</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *v6 ^= v7;</span><br><span class="line">    v7 += v7 % <span class="number">5</span>;</span><br><span class="line">    ++v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="built_in">len</span>(flag) != v6 );</span><br><span class="line"><span class="comment">//第一三位的验证逻辑</span></span><br><span class="line">  v8 = <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">1</span>;</span><br><span class="line">  mod3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( mod3 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *v5 != thirdchar[v9] ) wrong;			<span class="comment">//mod2 == third</span></span><br><span class="line">      <span class="keyword">if</span> ( v10 % *v5 != masterArray[v9] ) wrong;	<span class="comment">//mod1*mod2%mod3 == master</span></span><br><span class="line">      ++v9;</span><br><span class="line">      v10 = <span class="number">1</span>;</span><br><span class="line">      mod3 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      v10 *= *v5;</span><br><span class="line">      <span class="keyword">if</span> ( ++mod3 == <span class="number">3</span> ) mod3 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v8,++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v8 != <span class="number">19</span> );</span><br></pre></td></tr></table></figure>

<ul>
<li>解题脚本</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">f3 = [<span class="number">0x41</span>,<span class="number">0x69</span>,<span class="number">0x6e</span>,<span class="number">0x45</span>,<span class="number">0x6f</span>,<span class="number">0x61</span>]</span><br><span class="line">f2 = [<span class="number">0x2ef</span>,<span class="number">0x2c4</span>,<span class="number">0x2dc</span>,<span class="number">0x2c7</span>,<span class="number">0x2de</span>,<span class="number">0x2fc</span>]</span><br><span class="line">f1 = [<span class="number">0x1d7</span>,<span class="number">0xc</span>,<span class="number">0x244</span>,<span class="number">0x25e</span>,<span class="number">0x93</span>,<span class="number">0x6c</span>]</span><br><span class="line">flag = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line"><span class="comment">#mod3=0填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">	flag[i] = f3[i//<span class="number">3</span>]</span><br><span class="line"><span class="comment"># 生成异或序列</span></span><br><span class="line">x = <span class="number">666</span></span><br><span class="line">xor = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">	xor.append(x)</span><br><span class="line">	x += x % <span class="number">5</span></span><br><span class="line"><span class="comment"># mod3=2填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">	flag[i] = f2[i//<span class="number">3</span>] ^ xor[i]</span><br><span class="line"><span class="comment"># 剩余位填充</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>,<span class="number">125</span>):</span><br><span class="line">		<span class="keyword">if</span> ((j^xor[i]) * (flag[i-<span class="number">1</span>]^xor[i-<span class="number">1</span>]) % f2[i//<span class="number">3</span>] == f1[i//<span class="number">3</span>]):</span><br><span class="line">			flag[i] = j</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;tuctf&#123;&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="babymips"><a href="#babymips" class="headerlink" title="babymips"></a>babymips</h3><ul>
<li>数字高低位置换问题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//cmp2</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">5</span>; i &lt; strlen(a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v1 = (a1[i] &gt;&gt; <span class="number">2</span>) | (a1[i] &lt;&lt; <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v1 = (a1[i] &lt;&lt; <span class="number">2</span>) | (a1[i] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">    a1[i] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !strncmp(a1 + <span class="number">5</span>, (const char *)off_410D04, 0x1Bu) )</span><br><span class="line">//cmp1为异或</span><br></pre></td></tr></table></figure>

<ul>
<li>Solve</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="string">&quot;Q|j&#123;g&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(x[i]) ^ (<span class="number">32</span>-i)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">lis = [<span class="number">0x52</span>,<span class="number">0xfd</span>,<span class="number">0x16</span>,<span class="number">0xa4</span>,<span class="number">0x89</span>,<span class="number">0xbd</span>,<span class="number">0x92</span>,<span class="number">0x80</span>,<span class="number">0x13</span>,<span class="number">0x41</span>,<span class="number">0x54</span>,<span class="number">0xa0</span>,<span class="number">0x8d</span>,<span class="number">0x45</span>,<span class="number">0x18</span>,<span class="number">0x81</span>,<span class="number">0xde</span>,<span class="number">0xfc</span>,<span class="number">0x95</span>,<span class="number">0xf0</span>,<span class="number">0x16</span>,<span class="number">0x79</span>,<span class="number">0x1a</span>,<span class="number">0x15</span>,<span class="number">0x5b</span>,<span class="number">0x75</span>,<span class="number">0x1f</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span>(i &amp; <span class="number">1</span> != <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(((lis[i-<span class="number">5</span>]&lt;&lt;<span class="number">2</span>)&amp;<span class="number">0xff</span> | (lis[i-<span class="number">5</span>]&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0xff</span>)^(<span class="number">32</span>-i)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(((lis[i-<span class="number">5</span>]&gt;&gt;<span class="number">2</span>)&amp;<span class="number">0xff</span> | (lis[i-<span class="number">5</span>]&lt;&lt;<span class="number">6</span>)&amp;<span class="number">0xff</span>) ^ (<span class="number">32</span>-i)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="APK-逆向2"><a href="#APK-逆向2" class="headerlink" title="APK-逆向2"></a>APK-逆向2</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="type">static</span> <span class="type">void</span> <span class="title">Main</span><span class="params">(string[] args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//监听端口</span></span><br><span class="line">    string hostname = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="type">int</span> port = <span class="number">31337</span>;</span><br><span class="line">    tcpClient.<span class="built_in">Connect</span>(hostname, port);</span><br><span class="line">    <span class="comment">//自我查找输出flag</span></span><br><span class="line">    string text = <span class="string">&quot;Super Secret Key&quot;</span>;</span><br><span class="line">    string text2 = Program.<span class="built_in">read</span>();</span><br><span class="line">    client.<span class="built_in">Send</span>(Encoding.ASCII.<span class="built_in">GetBytes</span>(<span class="string">&quot;CTF&#123;&quot;</span>));</span><br><span class="line">    foreach (<span class="type">char</span> x in text)</span><br><span class="line">	&#123;</span><br><span class="line">		client.<span class="built_in">Send</span>(Encoding.ASCII.<span class="built_in">GetBytes</span>(Program.<span class="built_in">search</span>(x, text2)));</span><br><span class="line">	&#125;</span><br><span class="line">	Console.<span class="built_in">WriteLine</span>(<span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//find &amp; cmp</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="type">static</span> string <span class="title">search</span><span class="params">(<span class="type">char</span> x, string text)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> length = text.Length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == text[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> value = i * <span class="number">1337</span> % <span class="number">256</span>;</span><br><span class="line">            <span class="keyword">return</span> Convert.<span class="built_in">ToString</span>(value, <span class="number">16</span>).<span class="built_in">PadLeft</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;??&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>监听本机端口运行得到flag</li>
<li>nc -l -p 31773</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import http.server</span><br><span class="line"></span><br><span class="line">server_address = (&#x27;127.0.0.1&#x27;, 31337)</span><br><span class="line">handler_class = http.server.BaseHTTPRequestHandler</span><br><span class="line">httpd = http.server.HTTPServer(server_address, handler_class)</span><br><span class="line">httpd.serve_forever()</span><br></pre></td></tr></table></figure>

<ul>
<li>代码仿写得到flag<ul>
<li>本质上就是在源程序上取和key字符相同的字节下标，然后做一个计算</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">key1=<span class="string">&quot;Super Secret Key&quot;</span></span><br><span class="line">key2=<span class="built_in">open</span>(<span class="string">&#x27;1.exe&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding = <span class="string">&#x27;unicode-escape&#x27;</span>).read()	</span><br><span class="line">num=<span class="built_in">len</span>(key2)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;CTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">x,key2,num</span>):</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">		<span class="keyword">if</span> x==key2[i]:</span><br><span class="line">			value=i*<span class="number">1337</span>%<span class="number">256</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;%02x&#x27;</span> %value						</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> key1:</span><br><span class="line">	flag+=search(j,key2,num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag+=<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="secret-string-400"><a href="#secret-string-400" class="headerlink" title="secret-string-400"></a>secret-string-400</h3><ul>
<li>虚拟机题目</li>
<li>loadcode内是真正的cmp代码，将其转换为字节码逆写即可，简单异或</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/GFSJ-Re/" data-id="clfwpfz5n000bvws49ajja231" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Linux/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:44:57.844Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="linux指令"><a href="#linux指令" class="headerlink" title="linux指令"></a>linux指令</h3><ul>
<li>uname，查看系统信息<ul>
<li>-s：System name</li>
<li>-n：Network (domain) name</li>
<li>-r ：Kernel Release number</li>
<li>-v ：Kernel Version</li>
<li>-m：Machine (hardware) name</li>
<li>-a：All of the above</li>
</ul>
</li>
<li>file，查看文件类型</li>
<li>head，查看文件内容</li>
<li>ldd，查看文件依赖</li>
<li>xxd，十六进制转储工具<ul>
<li>xxd -c 32：每行显示32字节</li>
<li>xxb -b：二进制显示</li>
<li>-l：指定转储长度</li>
</ul>
</li>
<li>dd，同转储工具，容易造成文件覆盖</li>
<li>readelf，elf查看解析<ul>
<li>readelf -h：查看elf头</li>
<li>readelf -s：查看符号表</li>
</ul>
</li>
<li>nm，文件符号解析<ul>
<li>nm -D：解析动态·符号表</li>
</ul>
</li>
<li>c++filt，符号解析（传入参数为要解析的函数）</li>
<li>strings，查看字符串<ul>
<li>-n：指定最小字符长度</li>
<li>-d：只输出data段字符串</li>
</ul>
</li>
<li>strace，显示文件执行时的系统调用<ul>
<li>strace -p pid：附加到pid进程</li>
</ul>
</li>
<li>ltrace，显示文件执行时的库文件调用</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Linux/" data-id="clfwpfz5o000dvws47dzfebx4" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Android-Secuity" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/31/Android-Secuity/" class="article-date">
  <time class="dt-published" datetime="2023-03-31T10:44:18.928Z" itemprop="datePublished">2023-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Android反调试"><a href="#Android反调试" class="headerlink" title="Android反调试"></a>Android反调试</h2><h3 id="文件检测"><a href="#文件检测" class="headerlink" title="文件检测"></a>文件检测</h3><ul>
<li>检测某一路径下是否存在调试文件</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dir = <span class="built_in">opendir</span>(<span class="string">&quot;/data/local/tmp&quot;</span>);		<span class="comment">//check dir</span></span><br><span class="line">pid = <span class="built_in">getpid</span>();	<span class="comment">//获取pid</span></span><br><span class="line">v2 = pid;</span><br><span class="line"><span class="keyword">if</span> ( dir )&#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )&#123;</span><br><span class="line">        v3 = <span class="built_in">readdir</span>(dir);</span><br><span class="line">        v4 = v3 == <span class="number">0</span>;</span><br><span class="line">        filename = (<span class="type">const</span> <span class="type">char</span> *)(v3 + <span class="number">19</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v4 ) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(filename, <span class="string">&quot;android_server&quot;</span>, <span class="number">0xE</span>u) )</span><br><span class="line">            <span class="built_in">kill</span>(v2, <span class="number">9</span>);	<span class="comment">//kill debug process</span></span><br><span class="line">    &#125;</span><br><span class="line">    pid = <span class="built_in">closedir</span>(dir, <span class="string">&quot;android_server&quot;</span>, <span class="number">14</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="端口检测"><a href="#端口检测" class="headerlink" title="端口检测"></a>端口检测</h3><ul>
<li>检测app运行时是否有常用调试端口被使用</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">FILE* pfile=<span class="literal">NULL</span>;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">0x1000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span>* strCatTcp= <span class="string">&quot;cat /proc/net/tcp |grep :5D8A&quot;</span>;	<span class="comment">//check tcp</span></span><br><span class="line"><span class="type">char</span>* strNetstat=<span class="string">&quot;netstat |grep :23946&quot;</span>;	<span class="comment">//check the state of port </span></span><br><span class="line"><span class="comment">//calls popen(), executes a shell and runs commands </span></span><br><span class="line">pfile=<span class="built_in">popen</span>(strCatTcp,<span class="string">&quot;r&quot;</span>);		</span><br><span class="line"><span class="type">int</span> pid=<span class="built_in">getpid</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">NULL</span>==pfile)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fail\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//kill debug process</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">fgets</span>(buf,<span class="built_in">sizeof</span>(buf),pfile))&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="built_in">kill</span>(pid,SIGKILL);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">pclose</span>(pfile);</span><br></pre></td></tr></table></figure>

<h3 id="进程名称检测"><a href="#进程名称检测" class="headerlink" title="进程名称检测"></a>进程名称检测</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> bufsize = <span class="number">1024</span>;</span><br><span class="line"><span class="type">char</span> filename[bufsize];</span><br><span class="line"><span class="type">char</span> line[bufsize];</span><br><span class="line"><span class="type">char</span> name[bufsize];</span><br><span class="line"><span class="type">char</span> nameline[bufsize];</span><br><span class="line"><span class="type">int</span> pid = <span class="built_in">getpid</span>();</span><br><span class="line"><span class="comment">//先读取Tracepid的值</span></span><br><span class="line"><span class="built_in">sprintf</span>(filename, <span class="string">&quot;/proc/%d/status&quot;</span>, pid);</span><br><span class="line">FILE *fd=<span class="built_in">fopen</span>(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(fd!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fgets</span>(line,bufsize,fd))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(line,<span class="string">&quot;TracerPid&quot;</span>)!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="type">int</span> statue =<span class="built_in">atoi</span>(&amp;line[<span class="number">10</span>]);</span><br><span class="line">            <span class="keyword">if</span>(statue!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">sprintf</span>(name,<span class="string">&quot;/proc/%d/cmdline&quot;</span>,statue);</span><br><span class="line">                FILE *fdname=<span class="built_in">fopen</span>(name,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(fdname!= <span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="keyword">while</span>(<span class="built_in">fgets</span>(nameline,bufsize,fdname))</span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">strstr</span>(nameline,<span class="string">&quot;android_server&quot;</span>)!=<span class="literal">NULL</span>)</span><br><span class="line">                            <span class="type">int</span> ret=<span class="built_in">kill</span>(pid,SIGKILL);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">fclose</span>(fdname);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">fclose</span>(fd);</span><br></pre></td></tr></table></figure>

<h2 id="Android安全机制"><a href="#Android安全机制" class="headerlink" title="Android安全机制"></a>Android安全机制</h2><h3 id="区域隔离"><a href="#区域隔离" class="headerlink" title="区域隔离"></a>区域隔离</h3><ul>
<li>系统区和用户区分离，系统区只有读取权限</li>
</ul>
<h3 id="进程保护"><a href="#进程保护" class="headerlink" title="进程保护"></a>进程保护</h3><ul>
<li>独立进程空间，沙箱隔离</li>
</ul>
<h3 id="权限模型"><a href="#权限模型" class="headerlink" title="权限模型"></a>权限模型</h3><ul>
<li>权限声明 —AndroidManifest.xml<ul>
<li>READ_CONTACTS：读取用户通讯录数据</li>
<li>RECEIVE_SMS：监测短信通知</li>
<li>ACCESS_COARSE_LOCATION：通过基站和wifi获取位置信息</li>
<li>ACCESS_FINE_LOCATION：通过GPS获取位置信息</li>
</ul>
</li>
<li>权限保护划级<ul>
<li>normal：申请即可用</li>
<li>dangerous：需要用户确认</li>
<li>signature：只会赋予与声明权限使用相同证书</li>
<li>signatureosystem：需要系统或者平台签名</li>
</ul>
</li>
</ul>
<h3 id="文件访问"><a href="#文件访问" class="headerlink" title="文件访问"></a>文件访问</h3><ul>
<li>Android apk的安装目录<ul>
<li>&#x2F;data&#x2F;data 下会有每个应用程序的私有目录</li>
<li>&#x2F;data&#x2F;app 会保存所有安装文件的APK</li>
<li>&#x2F;data&#x2F;da1vik-cache 会有每个应用程序的核心文件DEX的缓存文件，主要是为了提高效率。</li>
<li>&#x2F;System&#x2F;app 通常是系统自带的应用程序目录</li>
</ul>
</li>
<li>每个Android应用程序会在安装时分配一个独有的Linux用户ID，建立一个沙盒，这个用户ID会在安装时分配给它，并在该设备上一直保持同一个数值</li>
<li>Android 文件存储的4种方式<ul>
<li>Context. MODE_ PRIVATE: 默认操作模式，代表该文件是私有数据，只能被应用本身访问，在该模式下，写入的内容会覆盖原文件的内容。</li>
<li>Context. MODE_ APPEND: 内容追加</li>
<li>Context. MODE_ WORLD_ READABLE：读取权限</li>
<li>Context. MODE_ WORLD_ WRITEABLE：写入权限</li>
</ul>
</li>
</ul>
<h3 id="apk签名"><a href="#apk签名" class="headerlink" title="apk签名"></a>apk签名</h3><ul>
<li>jks、keystore等</li>
</ul>
<h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><ul>
<li>对称算法，包括AES、 DES、3DES、 RC5、RC2、PBE</li>
<li>非对称算法，包括RSA、 DSA、ECC</li>
<li>杂凑算法，包括SHA1、MD5、MD2</li>
<li>传输加密<ul>
<li>Android系统的传输加密支持L2TP&#x2F;IPSEC、 L2TP、 PPTPVPN， 支持SSLV 2. 0\3.0\3.1。</li>
</ul>
</li>
</ul>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><ul>
<li>传统扫描<ul>
<li>通过因特网包探索器判断主机是否存在</li>
<li>ICMP-Echo、Broadcast ICMP、Non-Echo ICMP</li>
</ul>
</li>
<li>TCP（传输控制协议）连接扫描<ul>
<li>三次握手</li>
</ul>
</li>
<li>TCP同步扫描<ul>
<li>两次握手</li>
</ul>
</li>
<li>TCPFIN扫描<ul>
<li>发送FIN控制报文<ul>
<li>CLOSED端口发送RST控制报文</li>
<li>LISTEN端口无应答</li>
</ul>
</li>
</ul>
</li>
<li>FTP（文件传输协议）反弹攻击</li>
<li>UDP（用户数据报协议）扫描</li>
</ul>
<h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3><h3 id="特征匹配"><a href="#特征匹配" class="headerlink" title="特征匹配"></a>特征匹配</h3><h3 id="模拟攻击"><a href="#模拟攻击" class="headerlink" title="模拟攻击"></a>模拟攻击</h3><h3 id="沙箱执行"><a href="#沙箱执行" class="headerlink" title="沙箱执行"></a>沙箱执行</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/31/Android-Secuity/" data-id="clfwpfz5j0003vws483o6hko1" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/03/31/Affine/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/03/31/Crypto/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/03/31/Flat/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/03/31/Buuctf-RE/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/03/31/Note3/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>