<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="已经魔化的CTF逆向手">
<meta property="og:type" content="website">
<meta property="og:title" content="逆向光点">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="逆向光点">
<meta property="og:description" content="已经魔化的CTF逆向手">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="UmVfX1BvaW50">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>逆向光点</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">逆向光点</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Pyc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Pyc/" class="post-title-link" itemprop="url">Pyc decomplier</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 19:02:04" itemprop="dateCreated datePublished" datetime="2023-03-31T19:02:04+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:03:19" itemprop="dateModified" datetime="2023-04-01T10:03:19+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="2022-x2F-10-x2F-25-重写"><a href="#2022-x2F-10-x2F-25-重写" class="headerlink" title="2022&#x2F;10&#x2F;25 重写"></a>2022&#x2F;10&#x2F;25 重写</h2><ul>
<li><p>加一个内容：exe到pyc的转化</p>
<ul>
<li>可操作exe的识别（用python编译生成的exe文件一般来讲会比较大）</li>
<li>具体处理（利用脚本完成）</li>
</ul>
</li>
<li><p>py脚本（pyinstxtractor）</p>
<p>（<a target="_blank" rel="noopener" href="https://gitcode.net/mirrors/extremecoders-re/pyinstxtractor?utm_source=csdn_github_accelerator">mirrors &#x2F; extremecoders-re &#x2F; pyinstxtractor · GitCode</a>）</p>
</li>
<li><p>使用</p>
<ul>
<li><p>建议官方文档readme.md</p>
</li>
<li><p>比较常见的操作就是将要转化的exe程序复制到脚本文件目录下，执行命令</p>
<blockquote>
<p>python pyinstxtractor.py test.exe</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="pyc文件反编"><a href="#pyc文件反编" class="headerlink" title="pyc文件反编"></a>pyc文件反编</h3><p>py生成的中间文件</p>
<blockquote>
<p>先省略无数字，需要深入了解底层再说</p>
</blockquote>
<h3 id="处理"><a href="#处理" class="headerlink" title="处理"></a>处理</h3><ul>
<li><p>借用外部资源，安装uncompyle6</p>
<blockquote>
<p>pip install uncompyle</p>
</blockquote>
</li>
<li><p>使用</p>
<blockquote>
<p>uncompyle6 name.pyc &gt; name.py</p>
</blockquote>
</li>
<li><p>或者直接用网上的在线反编译：<br>(<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">https://tool.lu/pyc/</a>)</p>
</li>
</ul>
<blockquote>
<p>因为比较bug的一件事情是：<br>我遇到了某pyc文件用uncompyle6无法反编的情况，目前推测应该是版本不对的问题<br>后续再研究研究</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/IDA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/IDA/" class="post-title-link" itemprop="url">IDA</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 19:01:24" itemprop="dateCreated datePublished" datetime="2023-03-31T19:01:24+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:03:44" itemprop="dateModified" datetime="2023-04-01T10:03:44+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="快捷操作"><a href="#快捷操作" class="headerlink" title="快捷操作"></a>快捷操作</h2><table>
<thead>
<tr>
<th>操作</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>F5</td>
<td>反汇编</td>
</tr>
<tr>
<td>函数列表Ctrl+F</td>
<td>搜索函数</td>
</tr>
<tr>
<td>X</td>
<td>交叉引用</td>
</tr>
<tr>
<td>G</td>
<td>跳转到指定地址</td>
</tr>
<tr>
<td>Shift+F12</td>
<td>字符串列表</td>
</tr>
<tr>
<td>Alt+T</td>
<td>按指令查找</td>
</tr>
<tr>
<td>N</td>
<td>重命名(函数名等)</td>
</tr>
<tr>
<td>Ctrl+Z</td>
<td>操作撤销</td>
</tr>
<tr>
<td>D</td>
<td>将字符串等元素转为数据</td>
</tr>
<tr>
<td>A</td>
<td>将数据转变为字符串</td>
</tr>
<tr>
<td>C</td>
<td>将数据转变为汇编代码</td>
</tr>
<tr>
<td>U</td>
<td>将字符串转变为原始数据</td>
</tr>
<tr>
<td>Shift+E</td>
<td>导出数据</td>
</tr>
<tr>
<td>Shift+F2</td>
<td>脚本嵌入</td>
</tr>
<tr>
<td>;</td>
<td>添加注释(所有交叉参考处均显示)</td>
</tr>
<tr>
<td>:</td>
<td>添加注释(仅在此处显示)</td>
</tr>
<tr>
<td>Esc</td>
<td>后退一步</td>
</tr>
<tr>
<td>Ctrl+Enter</td>
<td>前进一步</td>
</tr>
<tr>
<td>Alt+M</td>
<td>标记当前位置</td>
</tr>
<tr>
<td>Ctrl+M</td>
<td>跳转到标记位置</td>
</tr>
<tr>
<td>P</td>
<td>创建函数</td>
</tr>
</tbody></table>
<h2 id="elf调试"><a href="#elf调试" class="headerlink" title="elf调试"></a>elf调试</h2><ul>
<li>将linux_server&#x2F;64复制到kali运行</li>
<li>ida设置调试</li>
</ul>
<h2 id="so调试"><a href="#so调试" class="headerlink" title="so调试"></a>so调试</h2><ul>
<li>将android_server复制到安卓环境中（模拟器 or 测试机）</li>
<li>chmod 777 android_server并运行</li>
<li>adb forward将调试端口转移到本机</li>
<li>将so文件所在apk以debug模式启动</li>
<li>IDA打开要调试的文件，附加apk进程</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Tea/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Tea/" class="post-title-link" itemprop="url">Tea</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 19:00:12" itemprop="dateCreated datePublished" datetime="2023-03-31T19:00:12+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 09:56:01" itemprop="dateModified" datetime="2023-04-01T09:56:01+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>一写题就是变种xxtea，我已经无语了</li>
<li>茶类算法一般来讲顺序逆写加密代码即可</li>
<li>代码基于网络开源代码修改，侵删</li>
</ul>
<h2 id="Tea"><a href="#Tea" class="headerlink" title="Tea"></a>Tea</h2><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul>
<li>delta常数：0x9e3779b9</li>
<li>key：4个32位无符号整数</li>
<li>v：2个32位无符号整数</li>
</ul>
<h4 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h4><ul>
<li>利用key和delta对数据进行32轮简单和加密</li>
<li>特征：<ul>
<li>三异或</li>
<li>4、5移位</li>
</ul>
</li>
</ul>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>;               </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                      </span><br><span class="line">        sum += delta;  </span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">    &#125;                                                </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;  </span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>; </span><br><span class="line">	<span class="type">uint32_t</span> sum = <span class="number">0xc6ef3720</span>     <span class="comment">//sum = delta*32 = 0x13c6ef3720，取32位，高位数据溢出 </span></span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>]; </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         </span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        sum -= delta;  </span><br><span class="line">    &#125;                                            </span><br><span class="line">    v[<span class="number">0</span>] = v0; </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<h2 id="xxTea"><a href="#xxTea" class="headerlink" title="xxTea"></a>xxTea</h2><ul>
<li>key和delta如上，加密轮数由数据长度n决定</li>
<li>改魔数的就另当别论，一般解tea都是用c++写</li>
</ul>
<h4 id="c"><a href="#c" class="headerlink" title="c++"></a>c++</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//常见变化点</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))  </span></span><br><span class="line"><span class="comment">//key定义，4个32位无符号整数</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;&#125;;</span><br><span class="line"><span class="comment">//delta</span></span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  z = flag[n - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sum += delta;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      y = flag[i+<span class="number">1</span>];</span><br><span class="line">      z = flag[i] += MX;</span><br><span class="line">    &#125;</span><br><span class="line">    y = flag[<span class="number">0</span>];</span><br><span class="line">    z = flag[n<span class="number">-1</span>] += MX;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> y, z, sum;  </span><br><span class="line">  rounds = <span class="number">52</span> / n + <span class="number">6</span>;</span><br><span class="line">  sum = rounds*delta;</span><br><span class="line">  y = flag[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    e = (sum&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = n<span class="number">-1</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">      z = flag[i<span class="number">-1</span>];</span><br><span class="line">      y = flag[i] -= MX;</span><br><span class="line">    &#125;</span><br><span class="line">    z = flag[n<span class="number">-1</span>];</span><br><span class="line">    y = flag[<span class="number">0</span>] -= MX;</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">参数描述:</span></span><br><span class="line"><span class="string">  DELTA: 神秘常数δ，它来源于黄金比率，以保证每一轮加密都不相同。但δ的精确值似乎并不重要，这里 TEA 把它定义为 δ=「(√5 - 1)231」</span></span><br><span class="line"><span class="string">      v: 需要加解密的数据，格式为32位的无符号整数组成的数组</span></span><br><span class="line"><span class="string">      n: n表示需要加密的32位无符号整数的个数（例：n为1时，只有v数组中的第一个元素被加密了），n不能大于v的长度</span></span><br><span class="line"><span class="string">      k: 密钥，格式为4个32位无符号整数组成的数组，即密钥长度为128位</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"> </span><br><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(<span class="number">0</span>)</span><br><span class="line">    z = v[n - <span class="number">1</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">sum</span>.value += DELTA</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> p &lt; n - <span class="number">1</span>:</span><br><span class="line">            y = v[p + <span class="number">1</span>].value</span><br><span class="line">            v[p].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            z = v[p].value</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        v[n - <span class="number">1</span>].value += (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, n, k</span>):</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="built_in">int</span>(<span class="number">52</span> / n)</span><br><span class="line">    <span class="built_in">sum</span> = c_uint32(rounds * DELTA)</span><br><span class="line">    y = v[<span class="number">0</span>].value</span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        e = (<span class="built_in">sum</span>.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        p = n - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> p &gt; <span class="number">0</span>:</span><br><span class="line">            z = v[p - <span class="number">1</span>].value</span><br><span class="line">            v[p].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">            y = v[p].value</span><br><span class="line">            p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>].value</span><br><span class="line">        v[<span class="number">0</span>].value -= (((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span>.value ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line">        y = v[<span class="number">0</span>].value</span><br><span class="line">        <span class="built_in">sum</span>.value -= DELTA</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>():</span><br><span class="line">    k = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    v = [c_uint32(<span class="number">1</span>), c_uint32(<span class="number">2</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;plain: 1 2&#x27;</span>)</span><br><span class="line">    encrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;encrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line">    decrypt(v, <span class="built_in">len</span>(v), k)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;decrypted: %X %X&#x27;</span> % (v[<span class="number">0</span>].value, v[<span class="number">1</span>].value))</span><br><span class="line"></span><br><span class="line">————————————————</span><br><span class="line">此段代码为转载，原文链接：https://blog.csdn.net/koxb/article/details/<span class="number">120088234</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/BuuCTF-Misc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/BuuCTF-Misc/" class="post-title-link" itemprop="url">Buuctf-Misc</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:59:37" itemprop="dateCreated datePublished" datetime="2023-03-31T18:59:37+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:04:06" itemprop="dateModified" datetime="2023-04-01T10:04:06+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Misc/" itemprop="url" rel="index"><span itemprop="name">Misc</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><ul>
<li>gifframe捕捉帧</li>
</ul>
<h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><ul>
<li>binwalk检测出隐藏zip</li>
<li>foremost分离zip</li>
<li>azpr破解zip密码得到flag</li>
</ul>
<h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><ul>
<li>winhex查看，末尾存flag</li>
</ul>
<h2 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h2><ul>
<li>同上</li>
</ul>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><ul>
<li>图片高度隐藏，winhex修改图片高度即可</li>
</ul>
<h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><ul>
<li><p>假的exe文件，010打开发现是个base64，网站在线解码输出为png，是个二维码，扫码得flag</p>
</li>
<li><p>直接将原字符作为url获得二维码</p>
</li>
<li><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;png&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;img src=&quot;data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h2 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h2><ul>
<li>azpr破解zip密码</li>
</ul>
<h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><ul>
<li><p>wireshark捕获post请求即可</p>
<blockquote>
<p>http.request.method&#x3D;&#x3D;POST</p>
</blockquote>
</li>
</ul>
<h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><ul>
<li>右键属性即可</li>
</ul>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><ul>
<li>Stegsolve发现最上方隐写</li>
<li>输出为png二维码</li>
</ul>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><ul>
<li>修改deflags为0即可</li>
</ul>
<h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><ul>
<li>直接爆破四位数字</li>
</ul>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><ul>
<li>wireshark打开搜索flag</li>
</ul>
<h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><ul>
<li>qr直接识别</li>
</ul>
<h2 id="镜子中的世界"><a href="#镜子中的世界" class="headerlink" title="镜子中的世界"></a>镜子中的世界</h2><ul>
<li>LSB，RGB三个0</li>
</ul>
<h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><ul>
<li>提示加密，是个图片</li>
<li>binwalk分离zip，然后爆破zip密码</li>
</ul>
<h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><ul>
<li>同上</li>
</ul>
<h2 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h2><ul>
<li>同上，但是密码放在了图片属性里</li>
</ul>
<h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><ul>
<li>wireshark搜索追踪</li>
</ul>
<h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><ul>
<li>010搜索flag</li>
<li>base64</li>
<li>翻找没有意义，永远相信ctrlf</li>
</ul>
<h2 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h2><ul>
<li>010打开发现01串，转为acsii</li>
</ul>
<h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><ul>
<li>LSB rgb勾选保存为zip</li>
<li>linux运行elf文件</li>
</ul>
<h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><ul>
<li>爆破，brainfuck</li>
</ul>
<h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><ul>
<li>盲文解密压缩包，摩斯密码音频</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/UNCTF2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/UNCTF2022/" class="post-title-link" itemprop="url">UNCTF2022-WP</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:57:25" itemprop="dateCreated datePublished" datetime="2023-03-31T18:57:25+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 09:55:36" itemprop="dateModified" datetime="2023-04-01T09:55:36+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="总述"><a href="#总述" class="headerlink" title="总述"></a>总述</h1><ul>
<li>这场比赛算是我第一场长时间全程投入的比赛，每天从早上打到晚上12点，不得不说，还挺享受整个过程。全程rank最好的时候是第3，前期分数拉满，中期乏力，最后两天直接冥想坐牢，比赛结束前半小时才A掉培根密码题，守住了rank19。后10名的分差是真的小，再加上最后垂直上分的佬，节目效果拉满，刺激。</li>
<li>赛题方面，从我的角度看的话：<ul>
<li>reverse方面的题可能不是很友好，重复+部分偏门。2个upx壳、1个手动壳，2个rust逆向，以及ast普及和小改xxtea。</li>
<li>crypto和misc方向的题目基本知识点覆盖还是比较全面的。很多东西之前都没有见过，纯google现场学习。尤其是隐写文章看了一大堆，虽然misc没写出几道…….太菜了</li>
</ul>
</li>
<li>整个比赛打下来确实学到不少东西，挺好</li>
</ul>
<h1 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h1><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><code>Reverse</code></h2><h3 id="whereisyourkey-广东海洋大学"><a href="#whereisyourkey-广东海洋大学" class="headerlink" title="whereisyourkey-广东海洋大学"></a>whereisyourkey-广东海洋大学</h3><ul>
<li>直接模拟加密过程就行了，不多说</li>
<li>远程linux调试elf执行到加密结束提取数据也行</li>
</ul>
<h3 id="halo-绍兴元培"><a href="#halo-绍兴元培" class="headerlink" title="halo-绍兴元培"></a>halo-绍兴元培</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`upx脱壳`，`逻辑运算`，`异或解密</span><br></pre></td></tr></table></figure>

<ul>
<li><p>这个题多少有点绕</p>
</li>
<li><p>最后用来校对的那一堆异或和或，只有每个异或结果为0条件才为真，也就是说单个异或的结果都是相等的，通过这里就可以得到操作过后的flag</p>
</li>
<li><p>中间的加密，通过分析代码可以发现规律</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f0 = f0^0  </span><br><span class="line">ff1 = f0^0^f1^1</span><br><span class="line">f2 = f2^2^f0^0^f1^1</span><br><span class="line"></span><br><span class="line">相当于，顺序加密：fn = fn-1 ^ n</span><br><span class="line"></span><br><span class="line">所以反过来异或回去就完了</span><br></pre></td></tr></table></figure>
</li>
<li><p>最上面还有个array^0x33，就是array数组第一位异或，弄一下就行</p>
</li>
<li><p>解密脚本</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">102</span>, <span class="number">0xb</span>,<span class="number">0x68</span>,<span class="number">0xc</span>,<span class="number">0x73</span>,<span class="number">0x3e</span>,<span class="number">0xc</span>,<span class="number">0x3a</span>,<span class="number">0x5d</span>,<span class="number">0x1b</span>,<span class="number">0x21</span>,<span class="number">0x75</span>,<span class="number">0x4f</span>,<span class="number">0x20</span>,<span class="number">0x4c</span>,<span class="number">0x71</span>,<span class="number">0x58</span>,<span class="number">0x7b</span>,<span class="number">0x59</span>,<span class="number">0x2c</span>,<span class="number">0x0</span>,<span class="number">0x77</span>,<span class="number">0x58</span>,<span class="number">0x77</span>,<span class="number">0xe</span>,<span class="number">0x72</span>,<span class="number">0x5b</span>,<span class="number">0x26</span>,<span class="number">0xb</span>,<span class="number">0x70</span>,<span class="number">0xa</span>,<span class="number">0x77</span>,<span class="number">0x66</span>,<span class="number">0x77</span>,<span class="number">0x36</span>,<span class="number">0x76</span>,<span class="number">0x37</span>,<span class="number">0x76</span>,<span class="number">0x62</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x27</span>,<span class="number">0x3f</span>,<span class="number">0x77</span>,<span class="number">0x26</span>]</span><br><span class="line">x = <span class="number">44</span></span><br><span class="line"><span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    list[x] = list[x]^list[x<span class="number">-1</span>]^x</span><br><span class="line">    x -= <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i in list:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;)</span></span><br><span class="line"><span class="string"># flag&#123;H41oO0_6bb2920f8b98ae3f1fdb10cced277c2c&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对了，还有个upx脱壳，直接工具搞一下</p>
</li>
</ul>
<h3 id="ezzzzre-广东海洋大学"><a href="#ezzzzre-广东海洋大学" class="headerlink" title="ezzzzre-广东海洋大学"></a>ezzzzre-广东海洋大学</h3><ul>
<li><p>有个upx壳，工具脱掉</p>
</li>
<li><p>F5主函数</p>
</li>
<li><p>核心代码就这一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if ( Str[i] != 2 * aHelloctf[i] - 69 )</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取Helloctf[i]直接计算即可</p>
</li>
</ul>
<h3 id="Sudoku-陆军工程大学"><a href="#Sudoku-陆军工程大学" class="headerlink" title="Sudoku-陆军工程大学"></a>Sudoku-陆军工程大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`动态调试`，`数据提取`，`python</span><br></pre></td></tr></table></figure>

<ul>
<li><p>IDA反编F5+cmd运行测试</p>
</li>
<li><p>好像是个数独，分析一下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  </span><br><span class="line">  ......  </span><br><span class="line"><span class="comment">//生成检测数独</span></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">Prepare</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12) )		  </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !v12[<span class="number">9</span> * i + j] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">            v4[k] = <span class="number">0</span>;									<span class="comment">//生成函数</span></span><br><span class="line">          <span class="built_in">line</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i);</span><br><span class="line">          <span class="built_in">row</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, j);</span><br><span class="line">          <span class="built_in">SquireNine</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">          <span class="built_in">FillBlank</span>((<span class="built_in">int</span> (*)[<span class="number">9</span>])v12, v4, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//提示信息输出</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This is a game called Sudoku,just enjoy it!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Pls input your answer in the following format:&quot;</span>);</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v14, &amp;unk_4051C0, <span class="number">0x144</span>ui64);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)v14[<span class="number">9</span> * i + j]);		</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//输入数独</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Then you will get your flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v11[<span class="number">9</span> * i + j]);			              </span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//校验</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">8</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt;= <span class="number">8</span>; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v11[<span class="number">9</span> * k + m] != v12[<span class="number">9</span> * k + m] )			 </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Y0u_Ar3_Wr0ng!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Y0u_Ar3_R1ght!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第一眼就看到v11和v12比较，所以我们要想办法把v12搞出来，首先跟踪上面的生成函数，很复杂，那就动态调试，让机器生成v12我们去提取数据</p>
</li>
<li><p>v12生成函数结束后位置设断点，运行，然后f5反编找到v12对应栈位置，写脚本提取数据</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x000000000062FA10</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">81</span>*<span class="number">4</span>; i = i+<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%x &quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">	cnt = cnt + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(cnt % <span class="number">9</span> == <span class="number">0</span>)</span><br><span class="line">	   <span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8 5 2 4 9 1 6 7 3 </span></span><br><span class="line"><span class="comment">//1 9 6 7 3 8 2 5 4 </span></span><br><span class="line"><span class="comment">//4 3 7 5 6 2 9 1 8 </span></span><br><span class="line"><span class="comment">//5 2 8 1 4 6 3 9 7 </span></span><br><span class="line"><span class="comment">//3 7 4 9 2 5 8 6 1 </span></span><br><span class="line"><span class="comment">//9 6 1 3 8 7 4 2 5 </span></span><br><span class="line"><span class="comment">//2 1 9 8 5 4 7 3 6 </span></span><br><span class="line"><span class="comment">//7 4 3 6 1 9 5 8 2 </span></span><br><span class="line"><span class="comment">//6 8 5 2 7 3 1 4 9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>继续运行，输入提取的数独</p>
</li>
<li><p>运行到显示：</p>
<blockquote>
<p>UNCTF{chr(29+vme)chr(15+vme)chr(29+vme)chr(24+vme)chr(39+vme)chr(25+vme)chr(29+vme)chr(20+vme)chr(32+vme)}</p>
</blockquote>
</li>
<li><p>python解一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;UNCTF&#123;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">15</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">24</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">39</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">25</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">29</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">32</span>+<span class="number">50</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#125;&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;OAOJYKOFR&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezast-浙江师范大学"><a href="#ezast-浙江师范大学" class="headerlink" title="ezast-浙江师范大学"></a>ezast-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`ast树`，`js`，`代码还原</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一口老血吐出来</p>
</li>
<li><p>第一次遇到这种题，研究了一下ast树，然后就开始手推源代码</p>
</li>
<li><p>一边构建代码看ast一边还原（得亏有个ast在线网站）</p>
</li>
<li><p>还原代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ezdecode</span>(<span class="params">flag,key</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> arr_data = flag.<span class="title function_">split</span>()</span><br><span class="line">  <span class="keyword">return</span> arr_data.<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i.<span class="title function_">charCodeAt</span>()^(key += <span class="number">1</span>))).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> $_a = <span class="title function_">test</span>()</span><br><span class="line">$_a -= <span class="number">1145</span>*<span class="number">100</span></span><br><span class="line">$_a += <span class="number">0xb</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ezdecode</span>(<span class="string">&quot;OTYN\\a[inE+iEl.hcEo)ivo+g&quot;</span>,$_a))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">114514</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>emmmm，每次只能解密一个字符，然后我就直接手删了半天加密串把flag构造出来了</p>
</li>
<li><p>对了，还有一个用来转义的\要删掉</p>
</li>
<li><p>UNCTF{Ast_1s_v4ry_u3slu1}</p>
</li>
</ul>
<h3 id="HelloRust"><a href="#HelloRust" class="headerlink" title="HelloRust"></a>HelloRust</h3><ul>
<li><p>这题，一切都在动调中</p>
</li>
<li><p>首先通过关键词检索识别为rc4加密</p>
</li>
<li><p>修改内存数据，将unctf等等一系列数据变为字符串</p>
</li>
<li><p>动调，在keyinit函数处找到密钥<code>Unctf2022</code></p>
</li>
<li><p>在cmp函数上方找到密文</p>
</li>
<li><p>提取密文</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x00005622B1A340A6</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">Message</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; (<span class="number">0x00005622B1A340C1</span> - addr + <span class="number">1</span>); i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%02x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//876927216fc731261b6c3a749a626ea002811d85e0e2d071f4a3090e</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在线网站解密得到</p>
</li>
<li><p>unctf{Ru5t_Rc4_1s_2_e@zy!!!}</p>
</li>
</ul>
<h3 id="shelled-babyxor-重庆大学"><a href="#shelled-babyxor-重庆大学" class="headerlink" title="shelled_babyxor-重庆大学"></a>shelled_babyxor-重庆大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点`：`手动脱壳`，`数据处理`，`逆写解密</span><br></pre></td></tr></table></figure>

<ul>
<li><p>提示脱壳+算法逆向，有点东西</p>
</li>
<li><p>脱壳只能手动，没发现常规的pushad之类的东西，但知道是运行自解密</p>
</li>
<li><p>x64dbg运行到解密位置，把程序dump出来拖进ida64</p>
</li>
<li><p>ctrl+f12搜索unctf，发现有，定位过去，x交叉引用，定位关键代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">FOOL:0000000000402E30 53                            push    rbx</span><br><span class="line">FOOL:0000000000402E31 48 83 EC 50                   sub     rsp, 50h</span><br><span class="line">FOOL:0000000000402E35 E8 06 EA FF FF                call    sub_401840</span><br><span class="line">FOOL:0000000000402E35</span><br><span class="line">FOOL:0000000000402E3A 48 8B 0D 1F 15 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E41 48 8D 5C 24 20                lea     rbx, [rsp+58h+var_38]</span><br><span class="line">FOOL:0000000000402E46 48 8D 15 B3 11 00 00          lea     rdx, aInputYourAnswe            ; &quot;input your answer\n&quot;</span><br><span class="line">FOOL:0000000000402E4D E8 26 E9 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E4D</span><br><span class="line">FOOL:0000000000402E52 48 8B 0D F7 14 00 00          mov     rcx, cs:off_404350</span><br><span class="line">FOOL:0000000000402E59 48 89 DA                      mov     rdx, rbx</span><br><span class="line">FOOL:0000000000402E5C E8 0F E9 FF FF                call    sub_401770</span><br><span class="line">FOOL:0000000000402E5C</span><br><span class="line">FOOL:0000000000402E61 48 89 D9                      mov     rcx, rbx</span><br><span class="line">FOOL:0000000000402E64 E8 07 E7 FF FF                call    sub_401570</span><br><span class="line">	;核心函数</span><br><span class="line">FOOL:0000000000402E64</span><br><span class="line">FOOL:0000000000402E69 85 C0                         test    eax, eax</span><br><span class="line">FOOL:0000000000402E6B 75 1B                         jnz     short loc_402E88</span><br><span class="line">FOOL:0000000000402E6B</span><br><span class="line">FOOL:0000000000402E6D 48 8B 0D EC 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E74 48 8D 15 B4 11 00 00          lea     rdx, aSorryYouAreWro            ; &quot;sorry you are wrong&quot;</span><br><span class="line">FOOL:0000000000402E7B E8 F8 E8 FF FF                call    sub_401778</span><br><span class="line">FOOL:0000000000402E7B</span><br><span class="line">FOOL:0000000000402E80</span><br><span class="line">FOOL:0000000000402E80                               loc_402E80:                             ; CODE XREF: sub_402E30+6B↓j</span><br><span class="line">FOOL:0000000000402E80 31 C0                         xor     eax, eax</span><br><span class="line">FOOL:0000000000402E82 48 83 C4 50                   add     rsp, 50h</span><br><span class="line">FOOL:0000000000402E86 5B                            pop     rbx</span><br><span class="line">FOOL:0000000000402E87 C3                            retn</span><br><span class="line">FOOL:0000000000402E87</span><br><span class="line">FOOL:0000000000402E88                               ; ---------------------------------------------------------------------------</span><br><span class="line">FOOL:0000000000402E88</span><br><span class="line">FOOL:0000000000402E88                               loc_402E88:                             ; CODE XREF: sub_402E30+3B↑j</span><br><span class="line">FOOL:0000000000402E88 48 8B 0D D1 14 00 00          mov     rcx, cs:off_404360</span><br><span class="line">FOOL:0000000000402E8F 48 8D 15 7D 11 00 00          lea     rdx, aYouAreRightWel            ; &quot;you are right!welcome to re&quot;</span><br><span class="line">FOOL:0000000000402E96 E8 DD E8 FF FF                call    sub_401778</span><br></pre></td></tr></table></figure>
</li>
<li><p>跟进函数发现只有sub_401570在大面积操作数据，F5跟进</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v2;</span><br><span class="line">    v1 += v3 % <span class="number">22</span>;			<span class="comment">//取余得到一个v1</span></span><br><span class="line">    <span class="keyword">if</span> ( v2 == &amp;v7[<span class="number">5</span>] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = *v2;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">115</span>; ; i = *&amp;v7[<span class="number">4</span> * v4 + <span class="number">5</span>] )	<span class="comment">//取数</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v1 ^ *(a1 + v4)) != i )	<span class="comment">//校对</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ++v4 == <span class="number">41</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>终于找到真正的核心了，直接逆写解密，先求v1</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1 = <span class="number">0</span>; </span><br><span class="line">  <span class="type">char</span> v7[] = <span class="string">&quot;unctfs&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">    v1 += (((<span class="type">int</span>)v7[i]) % <span class="number">22</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt;v1 &lt;&lt;endl;			<span class="comment">//38</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后拿38跟这函数给出的一堆数据异或了一下，能搞出UNCTF，那就是答案没跑了，整理数据（痛苦面具），直接写解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">num = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>):</span><br><span class="line">    num.append(<span class="number">4</span>*i+<span class="number">5</span>)</span><br><span class="line">v9 = [<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x60</span>,<span class="number">0x5D</span>,<span class="number">0x5F</span>,<span class="number">0x49</span>,<span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x4C</span>,<span class="number">0x53</span>,<span class="number">0x55</span>,<span class="number">0x52</span>, <span class="number">0x79</span>,<span class="number">0x53</span>, <span class="number">0x48</span>,<span class="number">0x56</span>,<span class="number">0x47</span>,<span class="number">0x45</span>, <span class="number">0x4D</span>,<span class="number">0x43</span>, <span class="number">0x42</span>,<span class="number">0x79</span>, <span class="number">0x5F</span>,<span class="number">0x49</span>, <span class="number">0x53</span>,<span class="number">0x54</span>, <span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x4F</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x52</span>,<span class="number">0x79</span>,<span class="number">0x56</span>, <span class="number">0x54</span>,<span class="number">0x49</span>, <span class="number">0x41</span>,<span class="number">0x54</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(v9))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v9:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">71</span>^<span class="number">38</span>))</span><br><span class="line"><span class="comment"># CTF&#123;you_just_unpacked_your_first_progra</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>然后，UN我之前验证了，没写，最后program}猜得出来，寄</p>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><code>Crypto</code></h2><h3 id="md5-1-西南科技大学"><a href="#md5-1-西南科技大学" class="headerlink" title="md5-1-西南科技大学"></a>md5-1-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5</span><br></pre></td></tr></table></figure>

<ul>
<li>像我这种大冤种直接造md5加密字典</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line">li = [<span class="string">&#x27;4c614360da93c0a041b22e537de151eb&#x27;</span>,<span class="string">&#x27;8d9c307cb7f3c4a32822a51922d1ceaa&#x27;</span>,<span class="string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>,<span class="string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>,<span class="string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>,<span class="string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>,<span class="string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>,<span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,<span class="string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>,<span class="string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>,<span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span>,<span class="string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>,<span class="string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>,<span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span> l.get(i):</span><br><span class="line">        <span class="built_in">print</span>(l[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="md5-2-西南科技大学"><a href="#md5-2-西南科技大学" class="headerlink" title="md5-2-西南科技大学"></a>md5-2-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`md5`，`异或</span><br></pre></td></tr></table></figure>

<ul>
<li>多了个异或罢了，注意长度不够补位就行^_^</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成表</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">list</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">    <span class="comment"># 待加密信息</span></span><br><span class="line">    str2 = <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    str1 = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str1.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str1] = hl.hexdigest()</span><br><span class="line">x = [<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&quot;^&quot;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    str2 = i</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    hl = hashlib.md5()</span><br><span class="line">    hl.update(str2.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">list</span>[str2] = hl.hexdigest()</span><br><span class="line">l = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">list</span>.values(),<span class="built_in">list</span>.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检验</span></span><br><span class="line">li = [<span class="number">0x4c614360da93c0a041b22e537de151eb</span>,<span class="number">0xc1fd731c6d60040369908b4a5f309f41</span>,<span class="number">0x80fdc84bbb5ed9e207a21d5436efdcfd</span>,<span class="number">0xb48d19bb99a7e6bb448f63b75bc92384</span>,<span class="number">0x39eaf918a52fcaa5ed9195e546b021c1</span>,<span class="number">0x795d6869f32db43ff5b414de3c235514</span>,<span class="number">0xf59a054403f933c842e9c3235c136367</span>,<span class="number">0xc80b37816048952a3c0fc9780602a2fa</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xcad06891e0c769c7b02c228c8c2c8865</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x470a96d253a639193530a15487fea36f</span>,<span class="number">0x4bdea6676e5335f857fa8e47249fa1d8</span>,<span class="number">0x810ecef68e945c3fe7d6accba8b329bd</span>,<span class="number">0xedbb7ab78cde98a07b9b5a2ab284bf0a</span>,<span class="number">0x44b43e07e9af05e3b9b129a287e5a8df</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xabed1f675819a2c0f65c9b7da8cab301</span>,<span class="number">0x738c486923803a1b59ef17329d70bbbd</span>,<span class="number">0x7e209780adf2cd1212e793ae8796ed7c</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0xa641c08ed66b55c9bd541fe1b22ce5c0</span>,<span class="number">0x636a84a33e1373324d64463eeb8e7614</span>,<span class="number">0x6ec65b4ab061843b066cc2a2f16820d5</span>,<span class="number">0xa4a39b59eb036a4a8922f7142f874114</span>,<span class="number">0x8c34745bd5b5d42cb3efe381eeb88e4b</span>,<span class="number">0x5b1ba76b1d36847d632203a75c4f74e2</span>,<span class="number">0xd861570e7b9998dbafb38c4f35ba08bc</span>,<span class="number">0x464b7d495dc6019fa4a709da29fc7952</span>,<span class="number">0x8eb69528cd84b73d858be0947f97b7cc</span>,<span class="number">0xdd6ac4c783a9059d11cb0910fc95d4a</span>,<span class="number">0x4b6b0ee5d5f6b24e6898997d765c487c</span>,<span class="number">0xb0762bc356c466d6b2b8f6396f2e041</span>,<span class="number">0x8547287408e2d2d8f3834fc1b90c3be9</span>,<span class="number">0x82947a7d007b9854fa62efb18c9fd91f</span>,<span class="number">0x8ddafe43b36150de851c83d80bd22b0a</span>,<span class="number">0xc7b36c5f23587e285e528527d1263c8b</span>,<span class="number">0x2a0816e8af86e68825c9df0d63a28381</span>,<span class="number">0x63ce72a42cf62e6d0fdc6c96df4687e3</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] ^= li[cnt - <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(li)):</span><br><span class="line">    li[cnt] = <span class="built_in">hex</span>(li[cnt])</span><br><span class="line">    li[cnt] = li[cnt][<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(i) != <span class="number">32</span>):</span><br><span class="line">        i1 = <span class="string">&#x27;0&#x27;</span> + i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i1 = i</span><br><span class="line">    <span class="keyword">if</span> l.get(i1):</span><br><span class="line">        <span class="built_in">print</span>(l[i1],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;false&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="dddd-西南科技大学"><a href="#dddd-西南科技大学" class="headerlink" title="dddd-西南科技大学"></a>dddd-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">摩斯密码</span><br></pre></td></tr></table></figure>

<ul>
<li>摩斯密码01解密，这不写了吧</li>
</ul>
<h3 id="caesar-西南科技大学"><a href="#caesar-西南科技大学" class="headerlink" title="caesar-西南科技大学"></a>caesar-西南科技大学</h3><ul>
<li><p>题目提示了base64表</p>
</li>
<li><p>UNCTF校验发现是+45替换，逆写即可</p>
</li>
<li><p>脚本(坑点是得去掉末尾空格)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s=  <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">w = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> w:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span>(s.index(i) &gt;= <span class="number">45</span>):</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i) - <span class="number">45</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(s[s.index(i)+<span class="number">45</span>-<span class="number">64</span>-<span class="number">26</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezxor-浙江师范大学"><a href="#ezxor-浙江师范大学" class="headerlink" title="ezxor-浙江师范大学"></a>ezxor-浙江师范大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`多次一密`，`数据还原</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一个假题，劣质多次一密QAQ</p>
</li>
<li><p>decode密文，伪造flag与密文异或得到残缺明文，寻找英文单词特征比对求解，1小时的快乐没了</p>
<blockquote>
<p>UNCTF{Y0u_are_very_Clever!!!}</p>
</blockquote>
</li>
</ul>
<h3 id="Single-table-西南科技大学"><a href="#Single-table-西南科技大学" class="headerlink" title="Single table-西南科技大学"></a>Single table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`playfair</span><br></pre></td></tr></table></figure>

<ul>
<li><p>很明显变种Playfair加密</p>
</li>
<li><p>根据实例修改表</p>
</li>
<li><p>B C D E F<br>G H I K M<br>N O Q R S<br>T U V W X<br>Z P L A Y</p>
</li>
<li><p>还原即可</p>
<ul>
<li>不同行不同列优先取后一个字母对应行元素</li>
<li>同行取左</li>
<li>同列取上</li>
</ul>
</li>
<li><p>得到（注意下划线位置要换一下，哦对还有去掉x，我记得有人有群u吐槽这个下划线来着）</p>
<blockquote>
<p>UNCTF{GOD_YOU_KNOW_PLAYFAIR}</p>
</blockquote>
</li>
</ul>
<h3 id="Multi-table-西南科技大学"><a href="#Multi-table-西南科技大学" class="headerlink" title="Multi table-西南科技大学"></a>Multi table-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`维吉尼亚密码（Vigenere）</span><br></pre></td></tr></table></figure>

<h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><ul>
<li>这个题就是构造了一个循环序的字母字典table</li>
<li>还有一个乱序的匹配字母表base_table</li>
<li>然后随机生成查询key</li>
<li>加密flag<ul>
<li>首先查询base_table中字母位置</li>
<li>替换为字典key键对应位置的值</li>
</ul>
</li>
</ul>
<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><ul>
<li><p>首先用UNCT还原出key是多少，再逆写加密就可</p>
</li>
<li><p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字典表</span></span><br><span class="line">table = &#123;<span class="number">0</span>: <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;BCDEFGHIJKLMNOPQRSTUVWXYZA&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;CDEFGHIJKLMNOPQRSTUVWXYZAB&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;DEFGHIJKLMNOPQRSTUVWXYZABC&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;EFGHIJKLMNOPQRSTUVWXYZABCD&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;FGHIJKLMNOPQRSTUVWXYZABCDE&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;GHIJKLMNOPQRSTUVWXYZABCDEF&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;HIJKLMNOPQRSTUVWXYZABCDEFG&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;IJKLMNOPQRSTUVWXYZABCDEFGH&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;JKLMNOPQRSTUVWXYZABCDEFGHI&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;KLMNOPQRSTUVWXYZABCDEFGHIJ&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;LMNOPQRSTUVWXYZABCDEFGHIJK&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;MNOPQRSTUVWXYZABCDEFGHIJKL&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;NOPQRSTUVWXYZABCDEFGHIJKLM&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;OPQRSTUVWXYZABCDEFGHIJKLMN&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;PQRSTUVWXYZABCDEFGHIJKLMNO&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;QRSTUVWXYZABCDEFGHIJKLMNOP&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;RSTUVWXYZABCDEFGHIJKLMNOPQ&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;STUVWXYZABCDEFGHIJKLMNOPQR&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;TUVWXYZABCDEFGHIJKLMNOPQRS&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;UVWXYZABCDEFGHIJKLMNOPQRST&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;VWXYZABCDEFGHIJKLMNOPQRSTU&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;WXYZABCDEFGHIJKLMNOPQRSTUV&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;XYZABCDEFGHIJKLMNOPQRSTUVW&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;YZABCDEFGHIJKLMNOPQRSTUVWX&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;ZABCDEFGHIJKLMNOPQRSTUVWXY&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># 乱序表</span></span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line"><span class="comment"># 密文flag</span></span><br><span class="line">flag = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 还原key</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;U&#x27;</span>)) <span class="comment">#0  9</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;N&#x27;</span>)) <span class="comment">#1  14</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;C&#x27;</span>)) <span class="comment">#2  5</span></span><br><span class="line"><span class="built_in">print</span>(base_table.index(<span class="string">&#x27;T&#x27;</span>)) <span class="comment">#3  16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">9</span>] == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key0=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">14</span>] == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key1=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">5</span>] == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key2=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> table[i][<span class="number">16</span>] == <span class="string">&#x27;G&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;key3=&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line"><span class="comment"># 还原flag</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">key=[<span class="number">9</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">16</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] <span class="keyword">in</span> base_table:</span><br><span class="line">        <span class="built_in">print</span>(base_table[table[key[x%<span class="number">4</span>]].index(flag[i])],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="easy-RSA-中国人民公安大学"><a href="#easy-RSA-中国人民公安大学" class="headerlink" title="easy_RSA-中国人民公安大学"></a>easy_RSA-中国人民公安大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`:`rsa已知p高位攻击</span><br></pre></td></tr></table></figure>

<ul>
<li><p>看到&gt;&gt;200，是个RSA高位攻击，直接开搞</p>
</li>
<li><p>去网站<a target="_blank" rel="noopener" href="https://sagecell.sagemath.org/">Sage Cell Server (sagemath.org)</a> 先把roots爆出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = 8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857s</span><br><span class="line">p4 = p4 &lt;&lt; <span class="number">200</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>
</li>
<li><p>解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">roots = [<span class="number">358950849615278333731635244854025425463656033006805723630685</span>]</span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p2 = <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606623830215547787830024125178567428699965091733811241451081695232</span></span><br><span class="line">p= p2 + roots[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Today-is-Thursday-V-me-50-海南大学"><a href="#Today-is-Thursday-V-me-50-海南大学" class="headerlink" title="Today_is_Thursday_V_me_50-海南大学"></a>Today_is_Thursday_V_me_50-海南大学</h3><ul>
<li><p>这个题就是纯考察逆向解密能力，大喜，啊不，大悲</p>
</li>
<li><p>对flag先加密1，再加密2，得到结果。逆写，还是逆写</p>
</li>
<li><p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 题目信息</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = <span class="number">530007872419584476649862008487908643412379763189507583587632</span></span><br><span class="line">x = <span class="string">&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"><span class="comment">#生成25位随机数序列</span></span><br><span class="line">random.seed(key1_num)</span><br><span class="line">ran = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    ran.append(temp_num)</span><br><span class="line"><span class="comment"># 异或解密（encrypt2）</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    temp = bytes_to_long(<span class="built_in">bytes</span>(x[i], encoding=<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    flag.append(temp^ran[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仿写encrypt1，得出最后的异或串</span></span><br><span class="line">guess=[(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;f&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;n&#x27;</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    what = guess.pop(<span class="number">50</span>)</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">    mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line"><span class="comment"># 虽然计算了四轮，但最终用于使用的串只有最后一轮</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br><span class="line">n4 = <span class="string">&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag[i] ^= <span class="built_in">ord</span>(n4[i])</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;1_l0ve_Thurs4Ay!!!&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ezRSA-广东海洋大学"><a href="#ezRSA-广东海洋大学" class="headerlink" title="ezRSA-广东海洋大学"></a>ezRSA-广东海洋大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`z3求解`，`rsa基础流程</span><br></pre></td></tr></table></figure>

<ul>
<li><p>非常规rsa公私钥制作，反而变简单了</p>
</li>
<li><p>第一眼 p^4 &#x3D; n，z3直接求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">p = Real(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(p**<span class="number">4</span> == <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span>)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>
</li>
<li><p>cdn正常解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">p = <span class="number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span></span><br><span class="line">phi = p**<span class="number">4</span> - p**<span class="number">3</span></span><br><span class="line">d = libnum.invmod(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="babyRSA-广东海洋大学"><a href="#babyRSA-广东海洋大学" class="headerlink" title="babyRSA-广东海洋大学"></a>babyRSA-广东海洋大学</h3><ul>
<li><p>明文高位攻击，直接sage脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">high_m = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后把M转一下。。。。。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">x =<span class="number">0x554e4354467b32376130616163372d373663622d343237642d393132392d3134373633363064356431627d</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(x))</span><br><span class="line"><span class="comment"># UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="今晚吃什么-金陵科技学院"><a href="#今晚吃什么-金陵科技学院" class="headerlink" title="今晚吃什么-金陵科技学院"></a>今晚吃什么-金陵科技学院</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`培根密码</span><br></pre></td></tr></table></figure>

<ul>
<li><p>10000和00000串，5位，结合题目今晚吃什么，估计是培根密码</p>
</li>
<li><p>提取每个串的首位构成新串，写脚本替换为培根密码格式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lis = [<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;00000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;10000&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;B&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> cnt % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;/&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># AAABA/BAAAA/BABBA/ABBBA/BAAAA/ABBAB/ABAAA/BAAAB/AABAB/BAABB/ABBAA</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>去网站解密得到flag</p>
<blockquote>
<p>UNCTF{CRYPROISFUN}</p>
</blockquote>
</li>
</ul>
<h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><ul>
<li><p>费马小定理： 如果p是一个质数，而整数a不是p的倍数，则有a(p-1)≡1（mod p）</p>
</li>
<li><p>推导</p>
<ul>
<li>gift+x &#x3D; xp</li>
<li>gift &#x3D; (p-1)*x</li>
<li>2x*(p-1) ≡ 1(mod p)</li>
<li>2x*(p-1) - 1 &#x3D; x * p</li>
<li>2gift -1 &#x3D; x*p</li>
<li>结合n &#x3D; p*q</li>
<li>p &#x3D; gcd(n, 2gift -1)</li>
<li>p &#x3D; gcd(n, powmod(2, gift, n))</li>
</ul>
</li>
<li><p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n =  <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">gift = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line"></span><br><span class="line">gift = <span class="built_in">pow</span>(<span class="number">2</span>,gift,n) - <span class="number">1</span></span><br><span class="line">p = libnum.gcd(gift,n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><code>Misc</code></h2><h3 id="magic-word-西南科技大学"><a href="#magic-word-西南科技大学" class="headerlink" title="magic_word-西南科技大学"></a>magic_word-西南科技大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`零宽隐写</span><br></pre></td></tr></table></figure>

<ul>
<li>提示明显，零宽隐写，文档cv到<a target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></li>
<li>解密就完事了</li>
</ul>
<blockquote>
<p>unctf{We1come_new_ctfer}</p>
</blockquote>
<ul>
<li>一开始没改大写WA了一发，血亏</li>
</ul>
<h3 id="巨鱼-河南理工大学"><a href="#巨鱼-河南理工大学" class="headerlink" title="巨鱼-河南理工大学"></a>巨鱼-河南理工大学</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知识点`：`图片大小隐写`，`zip伪加密`，`文件合成`，`ppt隐写</span><br></pre></td></tr></table></figure>

<ul>
<li><p>拿到图片先常规检查，改了改宽高，发现多出一行字“无所谓我会出手”，可能有用</p>
</li>
<li><p>然后kali试着foremost了一下，发现图片隐藏了zip，提取出来打开</p>
</li>
<li><p>010查看zip，真加密，拿刚才找出来的字试了一下，密码正确</p>
</li>
<li><p>提取出来又是一层zip，还是有加密，010打开一眼看到总标志位0000，伪加密</p>
</li>
<li><p>翻看标志位unshortdeflag，为1的全改回0，去伪加密</p>
</li>
<li><p>一个flag文件夹，一个化学式和一个加密的pptx，网上查了化学式名字都不对，发现叫六六粉，试了666，正确，出题人真6</p>
</li>
<li><p>打开pptx，提示flagnothere，最后一页pptx无内容，猜测同色隐藏到背景里了，全选更换字体颜色，得到flag</p>
<blockquote>
<p>UNCTF{y0u_F1nd_1t!}</p>
</blockquote>
</li>
<li><p>这题多写几个字以表敬意（</p>
</li>
</ul>
<h3 id="syslog-浙江师范大学"><a href="#syslog-浙江师范大学" class="headerlink" title="syslog-浙江师范大学"></a>syslog-浙江师范大学</h3><ul>
<li><p>提示看压缩包，结合题目的syslog</p>
</li>
<li><p>上kali，binwalk -e文件，打开日志查看</p>
</li>
<li><p>搜索password发现base64</p>
</li>
<li><pre><code>cGFzc3dvcmQgaXMgVTZudTJfaTNfYjNTdA==
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 解密得到密码</span><br><span class="line"></span><br><span class="line">- 输入得到flag</span><br><span class="line"></span><br><span class="line">  &gt; unctf&#123;N1_sH3_D0n9_L0g_dE!&#125;</span><br><span class="line"></span><br><span class="line">### 找得到我吗-闽南师范大学</span><br><span class="line"></span><br><span class="line">- 打开文档全选设定文字颜色，发现3k字大作文，但是好像没用，废话文学是玩明白了</span><br><span class="line"></span><br><span class="line">- 常规检测，binwalk分离转出xml</span><br><span class="line"></span><br><span class="line">- 一大堆东西挨个看</span><br><span class="line"></span><br><span class="line">- document.xml中搜索flag得到结果</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;You_find_me!&#125;</span><br><span class="line"></span><br><span class="line">### 社什么社-湖南警察学院</span><br><span class="line"></span><br><span class="line">- 凤凰古城不错，以后一定去看看</span><br><span class="line"></span><br><span class="line">- &gt; UNCTF&#123;4F0198127A45F66C07A5B1A2DDA8223C&#125;</span><br><span class="line"></span><br><span class="line">### In_the_Morse_Garden-陆军工程大学</span><br><span class="line"></span><br></pre></td></tr></table></figure>
知识点`：`base64`，`word隐写`，`摩斯密码
</code></pre>
</li>
</ul>
<pre><code>
- pdf打开，ctrl+A发现图片下面有东西，提取出来

- UNCTF&#123;….=&#125;，base64解密

- 花园宝宝乱入

- 只有玛卡巴卡和依古比古，加上题目，morse解密（空格是摩斯断点，因为这个卡了半天，服了）

- &gt; UNCTF&#123;WAN_AN_MAKA_BAKAAAAA!&#125;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Ast/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Ast/" class="post-title-link" itemprop="url">Android-Create</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:56:49" itemprop="dateCreated datePublished" datetime="2023-03-31T18:56:49+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 00:52:10" itemprop="dateModified" datetime="2023-04-01T00:52:10+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><h3 id="ast树-抽象语法树"><a href="#ast树-抽象语法树" class="headerlink" title="ast树(抽象语法树)"></a>ast树(抽象语法树)</h3><h3 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h3><ul>
<li>是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。</li>
</ul>
<h3 id="简单描述"><a href="#简单描述" class="headerlink" title="简单描述"></a>简单描述</h3><ul>
<li>其实很简单，ast树就跟一本书的目录一样，只不过这个目录更加详细。以一种提取关键词和功能的方式完美展现一段代码的层次关系</li>
</ul>
<h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><p>例如js代码<code>x = a + b</code>生成<code>ast</code>树：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&quot;type&quot;: &quot;AssignmentExpression&quot;,</span><br><span class="line">&quot;start&quot;: 0,</span><br><span class="line">&quot;end&quot;: 7,</span><br><span class="line">&quot;operator&quot;: &quot;=&quot;,</span><br><span class="line">&quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 0,</span><br><span class="line">    &quot;end&quot;: 1,</span><br><span class="line">    &quot;name&quot;: &quot;x&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;BinaryExpression&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;left&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 4,</span><br><span class="line">    &quot;end&quot;: 5,</span><br><span class="line">    &quot;name&quot;: &quot;a&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;operator&quot;: &quot;+&quot;,</span><br><span class="line">    &quot;right&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;Identifier&quot;,</span><br><span class="line">    &quot;start&quot;: 6,</span><br><span class="line">    &quot;end&quot;: 7,</span><br><span class="line">    &quot;name&quot;: &quot;b&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到其内容是十分详细的：</p>
<ul>
<li>name：目标元素，作用对象</li>
<li>start，end：name对象在程序代码中的起止位置</li>
<li>operator：执行操作</li>
<li>type：操作种类，比如说一个函数、一个返回值、一个运算、一个变量等等</li>
</ul>
<h3 id="在线生成ast树结构网站："><a href="#在线生成ast树结构网站：" class="headerlink" title="在线生成ast树结构网站："></a>在线生成ast树结构网站：</h3><ul>
<li><a target="_blank" rel="noopener" href="https://astexplorer.net/">https://astexplorer.net/</a></li>
</ul>
<h2 id="ast逆向"><a href="#ast逆向" class="headerlink" title="ast逆向"></a>ast逆向</h2><ul>
<li>目前我接触的这方面东西也很少，基本上要做的事情只有两种：<ol>
<li>给一个ast树，然后让你去除其中的混淆操作</li>
<li>给定ast还原代码，这个代码可以是js，也可以是其他任何语言</li>
</ol>
</li>
<li>对于代码还原，这种很难有现成工具使用，小代码手推，大代码自己写针对脚本</li>
<li>手推的话：<ul>
<li>定位operator先还原运算表达式</li>
<li>由内层向外，还原一部分删一部分树结构</li>
<li>独立度大的优先，按函数模块还原</li>
<li>自己写对应代码生成ast树比对</li>
</ul>
</li>
<li>大概就这样</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Bug/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Bug/" class="post-title-link" itemprop="url">Loophole</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:54:32" itemprop="dateCreated datePublished" datetime="2023-03-31T18:54:32+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:05:15" itemprop="dateModified" datetime="2023-04-01T10:05:15+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="漏洞相关"><a href="#漏洞相关" class="headerlink" title="漏洞相关"></a>漏洞相关</h1><h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要注意栈向低地址生长，栈中的变量向高地址生长，所以溢出后覆盖的是高地址区域，逆向中可用来隐藏信息以及关键函数入口等等</span><br></pre></td></tr></table></figure>

<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">testFunc</span><span class="params">(<span class="type">char</span> *Buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> testBuf[<span class="number">8</span>];</span><br><span class="line">	<span class="built_in">memcpy</span>(testBuf, Buf, <span class="number">64</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> Buf[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">memset</span>(Buf, <span class="number">0x41</span>, <span class="number">64</span>);</span><br><span class="line">	<span class="built_in">testFunc</span>(Buf);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ul>
<li><p>testfunc中给8字节的testbuf数组赋值了64字节数据溢出，从而导致函数返回地址错误</p>
</li>
<li><pre><code class="asm">0019FE90 41414141
0019FE94 00401057 返回到 test.00401057 自 test.00401430
0019FE98 41414141
0019FE9C 41414141
0019FEA0 41414141
0019FEA4 41414141
0019FEA8 41414141
0019FEAC 41414141
0019FEB0 41414141
0019FEB4 41414141
0019FEB8 41414141
0019FEBC 41414141
0019FEC0 41414141
0019FEC4 41414141
0019FEC8 41414141
0019FECC 41414141
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#### 防范</span><br><span class="line"></span><br><span class="line">  ```c++</span><br><span class="line">  //加入长度判断</span><br><span class="line">  int maxsize = 8;</span><br><span class="line">  if(maxsize &gt; sizeof(testBuf))</span><br><span class="line">  &#123;</span><br><span class="line">      //数据截断</span><br><span class="line">   	memcpy(testBuf, Buf, maxsize);   </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<h3 id="堆溢出"><a href="#堆溢出" class="headerlink" title="堆溢出"></a>堆溢出</h3><h3 id="整型溢出（赋值类型大小不匹配）"><a href="#整型溢出（赋值类型大小不匹配）" class="headerlink" title="整型溢出（赋值类型大小不匹配）"></a>整型溢出（赋值类型大小不匹配）</h3><ol>
<li><p>存储溢出</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line">	<span class="type">short</span> b = a;</span><br><span class="line">	cout &lt;&lt;<span class="string">&quot;0x&quot;</span> &lt;&lt;hex &lt;&lt;b &lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0x5678,丢失数据</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运算溢出（计算后超出原类型数据范围，导致溢出）</p>
</li>
<li><p>符号问题</p>
</li>
</ol>
<h3 id="UAF漏洞"><a href="#UAF漏洞" class="headerlink" title="UAF漏洞"></a>UAF漏洞</h3><ul>
<li><p>use-after-free</p>
</li>
<li><p>大致过程</p>
<ul>
<li>函数A顺序调用B、C、D三个子函数</li>
<li>函数B释放了函数中的一部分资源，让函数中的某些指针变为空指针</li>
<li>函数C又申请使用刚才释放的资源空间（干坏事）</li>
<li>D函数判断不严密，导致刚才释放的空指针被继续使用</li>
</ul>
</li>
<li><p>相当于就是：在一个空间资源被释放后，将恶意信息注入该空间，然后又在不知情的情况下继续使用了该空间，引发漏洞</p>
</li>
<li><p>星盟公开课的一段代码（不知道哪出了问题，暂时没有预期输出）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> target[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *p = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">	<span class="built_in">free</span>(p);</span><br><span class="line">	p[<span class="number">0</span>] = target; <span class="comment">// p_chunk-&gt;fd is modified</span></span><br><span class="line">	target[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// prev size</span></span><br><span class="line">	target[<span class="number">1</span>] = <span class="number">0x21</span>; <span class="comment">// size</span></span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as p</span></span><br><span class="line">	<span class="type">char</span> *q = <span class="built_in">malloc</span>(<span class="number">0x10</span>); <span class="comment">// must be same as target</span></span><br><span class="line">	<span class="built_in">memcpy</span>(q, <span class="string">&quot;hello&quot;</span>,<span class="number">6</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,&amp;target[<span class="number">2</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="加脱壳相关"><a href="#加脱壳相关" class="headerlink" title="加脱壳相关"></a>加脱壳相关</h1><ul>
<li>通俗地讲，不管是压缩壳还是加密壳，都是附着于原程序，对其进行各种处理。然后在程序加载到内存中时，先运行壳的解压引擎还原程序，再执行程序。二者的界限也越来越模糊</li>
<li>为了保证效率，对于一个压缩引擎，我们要保证他有足够快的解压速度，以确保程序在运行时的速度。至于压缩速度就略显不重要</li>
</ul>
<h4 id="压缩壳"><a href="#压缩壳" class="headerlink" title="压缩壳"></a>压缩壳</h4><ul>
<li>upx</li>
<li>ASpack</li>
</ul>
<h4 id="加密壳"><a href="#加密壳" class="headerlink" title="加密壳"></a>加密壳</h4><ul>
<li>ASProtect</li>
<li>Armadillo：双进程运行，cc保护</li>
<li>EXECryptor</li>
<li>Themida</li>
</ul>
<h4 id="虚拟机保护"><a href="#虚拟机保护" class="headerlink" title="虚拟机保护"></a>虚拟机保护</h4><ul>
<li>VMProtect</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/DataStruction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/DataStruction/" class="post-title-link" itemprop="url">Data Structure</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:52:46" itemprop="dateCreated datePublished" datetime="2023-03-31T18:52:46+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:11:49" itemprop="dateModified" datetime="2023-04-01T10:11:49+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer/" itemprop="url" rel="index"><span itemprop="name">Computer</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>用低劣的水平描述数据结构的东西，后续考研还要细学</li>
<li>目前主要是要考试，大体过一遍，如果你质疑我的文章，那一定是我错了，我会忽略一些专业术语，更偏向于自己的理解思考</li>
<li>&lt;对于学过数据结构的人可能有一定用处吧&gt;</li>
</ul>
<hr>
<h1 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h1><ul>
<li>一堆概念<ul>
<li>数据：客观事物的符号描述</li>
<li>数据元素：数据的基本单位</li>
<li>数据项：组成数据元素的、有独立含义的、不可分割的最小单位</li>
<li>数据对象：性质相同的数据元素的集合</li>
</ul>
</li>
<li>逻辑结构<ul>
<li>线性与非线性</li>
<li>线性、树、图、集合</li>
</ul>
</li>
<li>存储结构</li>
<li>时间复杂度、空间复杂度</li>
</ul>
<h1 id="线性表"><a href="#线性表" class="headerlink" title="线性表"></a>线性表</h1><h4 id="普通"><a href="#普通" class="headerlink" title="普通"></a>普通</h4><h4 id="单链表"><a href="#单链表" class="headerlink" title="单链表"></a>单链表</h4><h4 id="循环链表"><a href="#循环链表" class="headerlink" title="循环链表"></a>循环链表</h4><h4 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h4><h1 id="栈和队列"><a href="#栈和队列" class="headerlink" title="栈和队列"></a>栈和队列</h1><h4 id="栈（先进后出）"><a href="#栈（先进后出）" class="headerlink" title="栈（先进后出）"></a>栈（先进后出）</h4><ul>
<li>不想说了，没完没了</li>
</ul>
<h4 id="队列（先进先出）"><a href="#队列（先进先出）" class="headerlink" title="队列（先进先出）"></a>队列（先进先出）</h4><ul>
<li>普通队列</li>
<li>循环队列</li>
<li>双向队列（两个端点都能入队、出队）</li>
<li>优先队列（队列元素维持有序，算竞常用）</li>
</ul>
<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><h3 id="KMP算法-字符串匹配，t向s匹配"><a href="#KMP算法-字符串匹配，t向s匹配" class="headerlink" title="KMP算法(字符串匹配，t向s匹配)"></a>KMP算法(字符串匹配，t向s匹配)</h3><ul>
<li>书上的代码便于理解，但是不能跑，下标有问题</li>
<li>这个难点就在一个求next数组吧。所谓next，就是每个字符的最长相同前后缀。至于代码上注意把握是在递归求解即可</li>
</ul>
<h4 id="结构体声明"><a href="#结构体声明" class="headerlink" title="结构体声明"></a>结构体声明</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 1024</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span>&#123;</span><br><span class="line">    <span class="type">char</span> ch[MAXSIZE+<span class="number">1</span>];		<span class="comment">//字符串</span></span><br><span class="line">    <span class="type">int</span> length;				<span class="comment">//长度</span></span><br><span class="line">&#125;String;</span><br></pre></td></tr></table></figure>

<h4 id="求解next数组"><a href="#求解next数组" class="headerlink" title="求解next数组"></a>求解next数组</h4><ul>
<li>优化前</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> ne[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ne[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;</span><br><span class="line">            ne[i] = j;		<span class="comment">//相等，直接在之前的基础上加一</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            j = ne[j];      <span class="comment">//不相等，向前递归</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>优化后（优化是优化掉了 t 串 ne[j] 位置的元素与 t[j] 相同的情况，这种情况的匹配一否全否。所以会让ne[j]递归到 t[ne[j]] !&#x3D; t[j]）</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Get_Next</span><span class="params">(String t, <span class="type">int</span> nextval[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    nextval[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; t.length)&#123;</span><br><span class="line">        <span class="comment">//相同前后缀，进入判断</span></span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || t.ch[i] == t.ch[j])&#123;</span><br><span class="line">            i++, j++;						<span class="comment">//修改位置</span></span><br><span class="line">            <span class="keyword">if</span>(t.ch[i] != t.ch[j])</span><br><span class="line">                nextval[i] = j;				<span class="comment">//不相等，直接取值             </span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                nextval[i] = nextval[j];    <span class="comment">//相等，无意义，再次向前求解</span></span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            j = nextval[j];      <span class="comment">//非相同前后缀，向前递归</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">KMP</span><span class="params">(String s, String t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> nextval[MAXSIZE+<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">Get_Next</span>(t, nextval);		             <span class="comment">//求解nextval</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; s.length &amp;&amp; j &lt; t.length)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j == - <span class="number">1</span> || s.ch[i] == t.ch[j])&#123;  <span class="comment">//相同，可匹配</span></span><br><span class="line">            i++, j++;</span><br><span class="line">        &#125;<span class="keyword">else</span>							     <span class="comment">//不可匹配，向前追溯</span></span><br><span class="line">            j = nextval[j];        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出匹配位置</span></span><br><span class="line">    <span class="keyword">if</span>(j &gt;= t.length)</span><br><span class="line">        <span class="keyword">return</span> i - t.length + <span class="number">1</span>;	<span class="comment">//输出实际位置长度，非数组下标</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="树"><a href="#树" class="headerlink" title="树"></a>树</h1><h3 id="一堆概念"><a href="#一堆概念" class="headerlink" title="一堆概念"></a>一堆概念</h3><ul>
<li>写写有些什么吧<ul>
<li>结点<ul>
<li>父母结点、祖先结点、左右孩子结点、兄弟结点、子孙结点、前后辈结点</li>
</ul>
</li>
<li>结点的度、结点的层次、树的高度</li>
<li>有序树、无序树</li>
<li>二叉树、满二叉树、完全二叉树、线索二叉树</li>
<li>森林</li>
</ul>
</li>
</ul>
<h3 id="二叉树的存储"><a href="#二叉树的存储" class="headerlink" title="二叉树的存储"></a>二叉树的存储</h3><h4 id="顺序存储"><a href="#顺序存储" class="headerlink" title="顺序存储"></a>顺序存储</h4><ul>
<li>将二叉树按照完全二叉树层序依次编号，自上而下，自左向右。按这个编号顺序放进一维容器就可</li>
<li>二叉树中的没有的结点，编号后按值为0放进容器</li>
<li>这样存储，若结点下标为k，则其左儿子下标为2k，右儿子为2k+1</li>
</ul>
<h4 id="链式存储"><a href="#链式存储" class="headerlink" title="链式存储"></a>链式存储</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    Data data;	            <span class="comment">//数据</span></span><br><span class="line">	<span class="type">int</span> *lchild, *rchild;	<span class="comment">//指向左儿子和右儿子</span></span><br><span class="line">    <span class="type">int</span> *parent				<span class="comment">//指向父节点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二叉树的遍历"><a href="#二叉树的遍历" class="headerlink" title="二叉树的遍历"></a>二叉树的遍历</h3><h4 id="先序遍历"><a href="#先序遍历" class="headerlink" title="先序遍历"></a>先序遍历</h4><ul>
<li>根左右，就是从根结点开始跑图^_^</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//递归是万能的</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">front</span><span class="params">(Node x)</span></span>&#123;</span><br><span class="line">    cout &lt;&lt;x-&gt;data &lt;&lt;<span class="string">&quot; &quot;</span>;	<span class="comment">//输出根</span></span><br><span class="line">	<span class="built_in">front</span>(x-&gt;lchild);		<span class="comment">//递归左儿子</span></span><br><span class="line">    <span class="built_in">front</span>(x-&gt;rchild);		<span class="comment">//递归右儿子</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//下面那俩写成递归代码和这个差不多</span></span><br></pre></td></tr></table></figure>

<h4 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h4><ul>
<li>左根右，看成果树自然脱落，然后顺序捡果子</li>
</ul>
<h4 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h4><ul>
<li>左右根，好像没什么可描述的思路。</li>
</ul>
<h4 id="层序遍历"><a href="#层序遍历" class="headerlink" title="层序遍历"></a>层序遍历</h4><ul>
<li>顾名思义，从根结点开始，一层一层输出就完事</li>
</ul>
<h4 id="树的遍历"><a href="#树的遍历" class="headerlink" title="树的遍历"></a>树的遍历</h4><ul>
<li>这个就直接合并了，没有中序遍历，其他三种都是有的</li>
</ul>
<h3 id="森林"><a href="#森林" class="headerlink" title="森林"></a>森林</h3><ul>
<li>把一堆树放一起</li>
</ul>
<h4 id="森林遍历"><a href="#森林遍历" class="headerlink" title="森林遍历"></a>森林遍历</h4><ul>
<li>先序遍历<ul>
<li>先找森林中第一棵树的根结点</li>
<li>先序遍历第一棵树，把剩余的树看成新的森林</li>
<li>重复上面的操作</li>
</ul>
</li>
<li>中序遍历<ul>
<li>先找森林中第一棵树的<code>子树森林</code>（也就是第一棵树中除根结点以外的部分）</li>
<li>后序遍历第一棵树，把剩余的树看成新的森林</li>
<li>重复上面的操作</li>
</ul>
</li>
</ul>
<h3 id="二叉树、树、森林的转换"><a href="#二叉树、树、森林的转换" class="headerlink" title="二叉树、树、森林的转换"></a>二叉树、树、森林的转换</h3><ul>
<li>树变二叉树<ol>
<li>在所有的兄弟之间连线</li>
<li>只保留父节点与第一个儿子结点的连线，去掉其他父子结点之间的连线</li>
</ol>
</li>
<li>森林变二叉树<ol>
<li>对每一棵树执行树变二叉树的操作</li>
<li>将森林中所有的树的根结点连起来</li>
</ol>
</li>
<li>二叉树变森林<ol>
<li>对于一个结点x，他是父结点的左孩子，在父节点和结点x的右孩子、以及其右孩子的右孩子…之间连线</li>
<li>去掉所有结点与右孩子的连线</li>
</ol>
</li>
</ul>
<h3 id="哈夫曼树"><a href="#哈夫曼树" class="headerlink" title="哈夫曼树"></a>哈夫曼树</h3><ul>
<li>最优树，带权路径最短，也就是所有结点的深度与权值积之和最小</li>
</ul>
<h3 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h3><ul>
<li>在哈夫曼树上按照<code>左0右1</code>的规则从根节点走到目标节点形成的数字串</li>
</ul>
<h1 id="图"><a href="#图" class="headerlink" title="图"></a>图</h1><h3 id="一堆概念-1"><a href="#一堆概念-1" class="headerlink" title="一堆概念"></a>一堆概念</h3><ul>
<li>有向图、无向图、混合图</li>
<li>点、权值</li>
<li>出度、入度</li>
<li>边、弧</li>
<li>强连通（有向图）<ul>
<li>两个顶点强连通：两个顶点至少存在一条互相可达路径</li>
<li>强连通图：任意两个顶点强连通</li>
<li>强连通分量：非强连通图中的最大强连通子图</li>
</ul>
</li>
<li>连通、回路（环）、稀疏图、稠密图</li>
<li>零图：仅有孤立结点</li>
<li>平凡图：只有一个孤立结点</li>
<li>多重图：有多重边的图。非多重图为线图</li>
<li>简单图：无多重边和自回环的图</li>
<li>完全图：任意两个不同结点之间都有边的简单图<ul>
<li>记为Kn</li>
<li>无向完全图的边数为n(n-1)&#x2F;2</li>
</ul>
</li>
<li>k度正则图：在无向图G&#x3D;&lt;V，E&gt;中，每个结点的度都是k</li>
<li>点割集：有一个连通图和点的集合，如果在图上把所有集合中的点删去，这个图就不是连通图，而这个集合中的点少一个，它还是连通图，这个集合就叫点割集</li>
<li>割点：存在两个点u、w，使得uw之间的每一条通路都必须经过点v，那么v就是割点。意思也就是没了v他就不是个连通图</li>
<li>结点连通度：在一个非完全图的连通图里，变为不连通图所需删去结点的最小数目</li>
<li>边割集、割边、边连通度</li>
<li>结点连通度𝜅(G) ≤ 边连通度𝜆(G) ≤ 最小度δ(G)</li>
</ul>
<h3 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有些东西，凭直觉走就行了</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th></th>
<th>邻接表</th>
<th>邻接矩阵</th>
<th>十字链表</th>
<th>邻接多重表</th>
</tr>
</thead>
<tbody><tr>
<td>空间复杂度</td>
<td>有向图o(V+E2)，无向图o(V+E)</td>
<td>o(V2)</td>
<td>o(V+E)</td>
<td>o(V+E)</td>
</tr>
<tr>
<td>适用范围</td>
<td>稀疏图</td>
<td>稠密图</td>
<td>有向图</td>
<td>无向图</td>
</tr>
<tr>
<td>缺点</td>
<td>点和边难删除，一找就需要遍历</td>
<td>删点需要删除整行整列</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h4><ul>
<li>就像一个二维向量？</li>
<li>先把每个点都摘出来是第一维。然后对于每个点，又把所有跟它有关的边都存一遍是第二维</li>
</ul>
<h4 id="逆邻接表（有向图）"><a href="#逆邻接表（有向图）" class="headerlink" title="逆邻接表（有向图）"></a>逆邻接表（有向图）</h4><ul>
<li>针对于有向图，邻接表的第二维放的是由某个点指向的所有边（其实应该叫弧）</li>
<li>逆邻接表，就是把第二维给倒一下，存所有指向某个点的边</li>
<li>比如点v，就存a-&gt;v，b-&gt;v，c-&gt;v…</li>
</ul>
<h4 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h4><ul>
<li>正常理解就行了</li>
<li>第n行第m列等于1表示：n-&gt;m &#x3D; 1</li>
<li>具体数字，那就看什么图了，可以表示权值，也可以表示是否有边</li>
</ul>
<h4 id="十字链表（有向图）"><a href="#十字链表（有向图）" class="headerlink" title="十字链表（有向图）"></a>十字链表（有向图）</h4><ul>
<li>基于邻接表做改进，每个结构里多了两个指针，一个指向弧头相同的结构，另一个指向弧尾相同的结构</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这玩意只是为了更加形象，不代表就这么简单</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> u;		<span class="comment">//弧尾</span></span><br><span class="line">    <span class="type">int</span> v;		<span class="comment">//弧头</span></span><br><span class="line">    <span class="type">int</span> value;	<span class="comment">//权值</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *hlink;    <span class="comment">//指向下一个弧头相同的Node结构</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *tlink;    <span class="comment">//指向下一个弧尾相同的Node结构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="邻接多重表（无向图）"><a href="#邻接多重表（无向图）" class="headerlink" title="邻接多重表（无向图）"></a>邻接多重表（无向图）</h4><ul>
<li>跟十字链表大同小异，无非是没有了指向（弧变成了边）</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> u;		<span class="comment">//边的一个结点</span></span><br><span class="line">    <span class="type">int</span> v;		<span class="comment">//边的另一个结点</span></span><br><span class="line">    <span class="type">int</span> value;	<span class="comment">//权值</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *hlink;    <span class="comment">//指向下一个含u的Node结构</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> *tlink;    <span class="comment">//指向下一个含v的Node结构</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这俩表示方式也就相当于是：</p>
<p>一条边两个点，分别把跟两个点有关的东西全部串在了一起</p>
<h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><h4 id="深度优先搜索（DFS）"><a href="#深度优先搜索（DFS）" class="headerlink" title="深度优先搜索（DFS）"></a>深度优先搜索（DFS）</h4><ul>
<li>一条道走到黑，走完回去再走另一条</li>
</ul>
<h4 id="广度优先搜索（BFS）"><a href="#广度优先搜索（BFS）" class="headerlink" title="广度优先搜索（BFS）"></a>广度优先搜索（BFS）</h4><ul>
<li>同深度的路同时试探，多点开花</li>
</ul>
<h3 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h3><h4 id="作用对象"><a href="#作用对象" class="headerlink" title="作用对象"></a>作用对象</h4><ul>
<li>无环有向图</li>
</ul>
<h4 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h4><ol>
<li>找一个无前驱(入度为0)的点存入拓扑序，或者找到后直接输出</li>
<li>将该点以及所有以该点作为起点的边删掉</li>
<li>重复1、2操作，直到所有的点都存入拓扑序中或者找不到入度为0的点</li>
</ol>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><ol>
<li>根据操作就可以分析出带环的图无法进行拓扑排序，因为一个环中不存在入度为0的点</li>
<li>因为一个图在拓扑排序前，或者拓扑排序开始后，都有可能存在许多个入度为0的点，此时就可以选择不同的点继续进行拓扑排序，所以拓扑排序的解不是唯一的</li>
</ol>
<h4 id="应用范围"><a href="#应用范围" class="headerlink" title="应用范围"></a>应用范围</h4><ol>
<li>检测一个图是否含有环</li>
<li>求解AOE图的关键路径</li>
<li>在有承接关系的工程中计算最优的项目处理顺序</li>
</ol>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 1000</span></span><br><span class="line"><span class="comment">//邻接矩阵定义</span></span><br><span class="line"><span class="type">int</span> egde[MAXN+<span class="number">1</span>][MAXN+<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> n, res[MAXN+<span class="number">1</span>];</span><br><span class="line"><span class="comment">//记录每个点的入度</span></span><br><span class="line"><span class="type">int</span> in_cnt[MAXN+<span class="number">1</span>];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Topo_sort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//初始化入度</span></span><br><span class="line">    <span class="built_in">memset</span>(in_cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(in_cnt));</span><br><span class="line">    <span class="comment">//存度</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">	    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">	        <span class="comment">//指向边不存在或者指向自己</span></span><br><span class="line">	        <span class="keyword">if</span>(i == j || edge[i][j] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            in_cnt[j]++;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> cnt = <span class="number">0</span>; <span class="comment">//记录拓扑序</span></span><br><span class="line">	<span class="comment">//拓扑排序</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">	    <span class="comment">//将入度为0的点放入队列</span></span><br><span class="line">	    <span class="keyword">if</span>(in_cnt[i] == <span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="type">int</span> temp = q.<span class="built_in">front</span>();  q.<span class="built_in">pop</span>();</span><br><span class="line">	    res[++cnt] = temp;</span><br><span class="line">	    <span class="comment">//删除以其为起点的边</span></span><br><span class="line">	    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">	        <span class="comment">//边不存在</span></span><br><span class="line">	        <span class="keyword">if</span>(edge[temp][i] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">	        <span class="comment">//指向的点的入度减一</span></span><br><span class="line">	        in_cnt[i]--;</span><br><span class="line">	        <span class="keyword">if</span>(in_cnt == <span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//得到的拓扑序中的点的个数小于图中点的个数</span></span><br><span class="line">	<span class="comment">//说明拓扑排序无法完成，可能存在自环</span></span><br><span class="line">    <span class="keyword">if</span>(cnt != n) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最小生成树-prim"><a href="#最小生成树-prim" class="headerlink" title="最小生成树-prim"></a>最小生成树-prim</h3><ol>
<li>将图分成两个部分，在树里的部分和不在树里的部分</li>
<li>选择一条权值最小的边，且该边所连的两个点一个在树内，一个在树外</li>
<li>将选定的边加入树内，并将该边的权值记录</li>
<li>重复上述操作直到所有的点都被加入树中</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100000</span></span><br><span class="line"><span class="type">int</span> n, m, res = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//链式前向星建图</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, v, next;</span><br><span class="line">&#125;edge[M*<span class="number">2</span>+<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> head[N+<span class="number">1</span>], cnt = <span class="number">0</span>, dis[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span></span>&#123;</span><br><span class="line">    edge[++cnt].x = y;</span><br><span class="line">    edge[cnt].v = z;</span><br><span class="line">    edge[cnt].next = head[x];</span><br><span class="line">    head[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//边权优先队列</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ty</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, len;  </span><br><span class="line">    <span class="comment">//比大小重载</span></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ty &amp;a) <span class="type">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> len &gt; a.len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;temp;</span><br><span class="line">priority_queue&lt;ty&gt;q;</span><br><span class="line"><span class="type">bool</span> vis[N+<span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prim</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//以初始点1更新队列</span></span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[<span class="number">1</span>]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">        temp.x = edge[i].x;</span><br><span class="line">        dis[edge[i].x] = edge[i].v;</span><br><span class="line">        temp.len = edge[i].v;</span><br><span class="line">        q.<span class="built_in">push</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="comment">//将当前边权最小的可连接点加入树中</span></span><br><span class="line">        <span class="comment">//并更新最小生成树代价</span></span><br><span class="line">        ty tmp = q.<span class="built_in">top</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(vis[tmp.x]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[tmp.x] = <span class="literal">true</span>;</span><br><span class="line">        res += tmp.len;</span><br><span class="line">        <span class="comment">//将新加入点所连接的边放进队列</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = head[tmp.x]; i != <span class="number">-1</span>; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vis[edge[i].x]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">//大于等于之前所选边权的新边权无需放入</span></span><br><span class="line">            <span class="keyword">if</span>(dis[edge[i].x] &lt;= edge[i].v) <span class="keyword">continue</span>; </span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            tmp.x = edge[i].x;</span><br><span class="line">            dis[edge[i].x] = edge[i].v;</span><br><span class="line">            tmp.len = edge[i].v;</span><br><span class="line">            q.<span class="built_in">push</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    cout &lt;&lt;res;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;v);</span><br><span class="line">        <span class="built_in">addedge</span>(a, b, v);</span><br><span class="line">        <span class="built_in">addedge</span>(b, a, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">prim</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最小生成树-kruskal"><a href="#最小生成树-kruskal" class="headerlink" title="最小生成树-kruskal"></a>最小生成树-kruskal</h3><ol>
<li>将所有的边按大小进行排序</li>
<li>选择一条之前<code>未选择过的</code>且<code>权值最小的</code>边</li>
<li>利用并查集判断选出的边所连接的两个点当前是否在一个集合里，如果不在，就将该边计入，并更新并查集信息</li>
<li>重复2、3操作直到所有的点生成一颗树</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100000</span></span><br><span class="line"><span class="type">int</span> n, m, res = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//边结构体</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, y, v;</span><br><span class="line">&#125;edge[M+<span class="number">1</span>];</span><br><span class="line"><span class="comment">//按边权值升序排列</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(Node a, Node b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.v &lt; b.v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//并查集查找父节点以及路径压缩</span></span><br><span class="line"><span class="type">int</span> fa[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(fa[x] == x)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//初始化并查集</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fa[i] = i;</span><br><span class="line">    <span class="comment">//按边权排序</span></span><br><span class="line">    <span class="built_in">sort</span>(edge+<span class="number">1</span>, edge+<span class="number">1</span>+m, cmp);</span><br><span class="line">    <span class="comment">//依次拿边</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="comment">//判断选定边所连的两个点是否已经在树里</span></span><br><span class="line">        <span class="type">int</span> fx = <span class="built_in">find</span>(edge[i].x);</span><br><span class="line">        <span class="type">int</span> fy = <span class="built_in">find</span>(edge[i].y);</span><br><span class="line">        <span class="keyword">if</span>(fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">        res += edge[i].v;</span><br><span class="line">        fa[fx] = fy;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt;res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m); </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;edge[i].x, &amp;edge[i].y, &amp;edge[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Kruskal</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最短路"><a href="#最短路" class="headerlink" title="最短路"></a>最短路</h3><ul>
<li>简单路：经过路的边都不相同</li>
<li>基本路：路出现的所有结点都不相同</li>
<li>简单回路、基本回路</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Floyed</th>
<th>Dijkstra(优先队列优化)</th>
<th>SPFA(优先队列优化)</th>
</tr>
</thead>
<tbody><tr>
<td>时间复杂度</td>
<td>o(n3)</td>
<td>o(n+m)(log2m)</td>
<td>o(km)</td>
</tr>
<tr>
<td>基本思想</td>
<td>动态规划</td>
<td>贪心</td>
<td>贪心</td>
</tr>
<tr>
<td>适用范围</td>
<td>无负环图</td>
<td>无负权图</td>
<td>无负环图</td>
</tr>
<tr>
<td>适用范围</td>
<td>多源最短路</td>
<td>不含负权图的低复杂度解</td>
<td>含负权边时的单源最短路求解</td>
</tr>
</tbody></table>
<ul>
<li>懒得重写了，CSDN链接如下</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_59700927/article/details/124547139?ops_request_misc=%7B%22request_id%22:%22167099472316782390553941%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=167099472316782390553941&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-3-124547139-null-null.nonecase&utm_term=%E6%9C%80%E7%9F%AD%E8%B7%AF&spm=1018.2226.3001.4450">三种求最短路算法基本描述及实现(C++)_Woodenman杜的博客-CSDN博客_最短路算法c++</a></p>
<h3 id="一些特殊的图"><a href="#一些特殊的图" class="headerlink" title="一些特殊的图"></a>一些特殊的图</h3><h4 id="AOE网"><a href="#AOE网" class="headerlink" title="AOE网"></a>AOE网</h4><ul>
<li>工程图，可以用来评估工程进度</li>
<li>具体表示<ul>
<li>总的来说还是一个带权有向图</li>
<li>只有一个入度为0的点和出度为0的点，表示工程的起点和终点，也叫入点和汇点</li>
<li>每一条边表示一项工程，其权值可表示完成工程所需要的时间</li>
<li>每一个结点，相当于一个锁，只有指向它的所有工程全部完成以后，它所指向的工程才能进行</li>
<li>多个工程可以同时进行</li>
</ul>
</li>
<li>一些需要关注的点<ul>
<li>每个工程的最早开始时间</li>
<li>每个工程的最迟开始时间</li>
<li>工程的最快完成时间（也就是从入点到汇点的最长路径）</li>
<li>关键路径（决定完成时间的路径）</li>
</ul>
</li>
</ul>
<h4 id="欧拉图"><a href="#欧拉图" class="headerlink" title="欧拉图"></a>欧拉图</h4><ul>
<li>欧拉回路：在一个连通图里，每个边走且只走一次的回路</li>
<li>欧拉图就是有欧拉回路的图</li>
</ul>
<h4 id="哈密顿图"><a href="#哈密顿图" class="headerlink" title="哈密顿图"></a>哈密顿图</h4><ul>
<li>哈密顿回路：在一个图里，每个点走且只走一次的回路</li>
<li>哈密顿图就是有哈密顿回路的图</li>
</ul>
<h4 id="二部图"><a href="#二部图" class="headerlink" title="二部图"></a>二部图</h4><ul>
<li>将图中所有的点分成两部分，使得图中所有的边连接的两个点，都属于不同的两部分</li>
</ul>
<h1 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h1><h3 id="线性表查找"><a href="#线性表查找" class="headerlink" title="线性表查找"></a>线性表查找</h3><h4 id="顺序查找"><a href="#顺序查找" class="headerlink" title="顺序查找"></a>顺序查找</h4><ul>
<li>就叫顺序查找（笑哭），线性遍历</li>
</ul>
<h4 id="折半查找"><a href="#折半查找" class="headerlink" title="折半查找"></a>折半查找</h4><ul>
<li>也就是二分查找，一眼可懂。注意被查找的序列必须是按条件有序</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//x为被查找数</span></span><br><span class="line"><span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">  <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(mid &gt;= x) r = mid;</span><br><span class="line">  <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="分块查找"><a href="#分块查找" class="headerlink" title="分块查找"></a>分块查找</h4><ul>
<li>将原来的表拆分成n个表（分块）</li>
<li>将每个表中权值最大的元素作为该表的关键字</li>
<li>find，先通过每个表的关键字定位到正确表中，再进行查找</li>
</ul>
<h3 id="树表查找"><a href="#树表查找" class="headerlink" title="树表查找"></a>树表查找</h3><h4 id="二叉排序树"><a href="#二叉排序树" class="headerlink" title="二叉排序树"></a>二叉排序树</h4><ul>
<li>特殊二叉树，对于每一个结点<ul>
<li>如果有左子树，左子树所有结点的权值均小于根结点</li>
<li>如果有右子树，右子树所有结点的权值均大于根结点</li>
</ul>
</li>
<li>至于查找就很简单了，从根结点一直向下比较就行，有点像二分，或者说它就是二分</li>
</ul>
<h4 id="平衡二叉树（AVL树）"><a href="#平衡二叉树（AVL树）" class="headerlink" title="平衡二叉树（AVL树）"></a>平衡二叉树（AVL树）</h4><ul>
<li>|depth左子树 - depth右子树|&lt;&#x3D;1</li>
</ul>
<h4 id="B-树"><a href="#B-树" class="headerlink" title="B-树"></a>B-树</h4><h4 id="B-树-1"><a href="#B-树-1" class="headerlink" title="B+树"></a>B+树</h4><h3 id="散列表查找"><a href="#散列表查找" class="headerlink" title="散列表查找"></a>散列表查找</h3><h1 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h1><ul>
<li>稳定排序：插入、冒泡、基数、归并</li>
<li>不稳定排序：希尔、选择、快排、堆</li>
</ul>
<p>表格还是来得快哈，非常合理</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>时间复杂度(平均)</th>
<th>空间复杂度</th>
</tr>
</thead>
<tbody><tr>
<td>选择排序</td>
<td>o(n2)</td>
<td>o(1)</td>
</tr>
<tr>
<td>堆排序</td>
<td>o(n2)</td>
<td>o(1)</td>
</tr>
<tr>
<td>冒泡排序</td>
<td>o(n2)</td>
<td>o(1)</td>
</tr>
<tr>
<td>快速排序</td>
<td>o(nlog2n)</td>
<td>o(log2n) –&gt; o(n)</td>
</tr>
<tr>
<td>插入排序</td>
<td>o(n2)</td>
<td>o(1)</td>
</tr>
<tr>
<td>希尔排序</td>
<td>看希尔增量合适不合适，平均n1.3?</td>
<td>o(1)</td>
</tr>
<tr>
<td>基数排序</td>
<td>o(d(n+rd))</td>
<td>o(n+rd)</td>
</tr>
<tr>
<td>归并排序</td>
<td>o(nlog2n)</td>
<td>o(n)</td>
</tr>
<tr>
<td>计数(桶)排序</td>
<td>o(n)</td>
<td>o(max-min+1)</td>
</tr>
</tbody></table>
<h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><ul>
<li>不断选择未排序序列中权值最大的数放到未排序序列末尾</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Select_sort</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> minx, minn;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="comment">//minn存放每一趟排序中的最小数，minx存放下标</span></span><br><span class="line">        minn = a[i];  minx = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(minn &gt; a[j])&#123;</span><br><span class="line">                minn = a[j];</span><br><span class="line">                minx = j;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(minx != i) <span class="built_in">swap</span>(a[i],a[minx]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><p>首先明确这玩意是要顺序存储的完全二叉树，然后利用根堆的根最大（小）的性质</p>
<ol>
<li>实现一个大(小)根堆（建初堆）</li>
<li>将根节点和末尾节点替换</li>
<li>将除末尾节点（也就是之前根堆的根）之外的其它元素继续执行上述操作，直到排序结束</li>
</ol>
<h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><ul>
<li>通过邻近两元素的不断比较交换实现排序，共n-1趟，期间权值较大的元素不断下浮，故名冒泡</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Bubble_sort</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> n)</span>				    <span class="comment">//n个数，从1下标开始</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt; n; i++)&#123;			        <span class="comment">//n-1趟排序</span></span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n-i; j++)&#123;				<span class="comment">//第i趟排序后有n-i个未排序的数</span></span><br><span class="line">        <span class="keyword">if</span>(a[j] &gt; a[j+<span class="number">1</span>]) <span class="built_in">swap</span>(a[j], a[j+<span class="number">1</span>]);	<span class="comment">//冒泡交换</span></span><br><span class="line">     &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><p>这个像所有排序的结合体，虽然说是由冒泡改进而来。同时消除多次逆序</p>
<ol>
<li>选择一个枢轴（pivotkey）</li>
<li>将所有权值小于pivotkey的放在左边，权值大于pivotkey的放在右边</li>
<li>再将pivotkey归位，放在分界处</li>
<li>对pivotkey两边的数列重复上述操作，也就是一个递归，直到排序完成</li>
</ol>
<h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><p>拿出第一个乱序数，放到已经排好序的序列的合适位置</p>
<p>好像挺明了的，可以看成是一个选择排序的进化？</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert_sort</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i,j,temp;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">        temp = a[i];		                         <span class="comment">//取出要插入的数</span></span><br><span class="line">		<span class="keyword">for</span>(j = i; j &gt; <span class="number">1</span> &amp;&amp; a[j - <span class="number">1</span>] &gt; temp; j--)    <span class="comment">//寻找合适的插入位置</span></span><br><span class="line">            a[j] = a[j - <span class="number">1</span>];						 <span class="comment">//没有找到的时候就向后推，把位置空出来</span></span><br><span class="line">		a[j] = temp;                                 <span class="comment">//插入数值</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h3><p>这个东西吧，就是分组和插入排序的循环</p>
<ol>
<li>在原数组中按照一定间隔从头到尾取出一系列数形成几个新的序列</li>
<li>对每个新的序列进行插入排序</li>
<li>按原位置序列合并</li>
</ol>
<p>至于这个间隔，就涉及到希尔增量，举个例子就明白了，分组不断降低。</p>
<p>比如对半式增量：</p>
<ul>
<li>一个长度为8的数组，8&#x2F;2 &#x3D; 4，所以第一次就按间隔为4取数，那么形成的新序列的下标就是：&lt;1 5&gt;,&lt;2 6&gt;,&lt;3 7&gt;,&lt;4 8&gt;</li>
<li>第二次间隔为4&#x2F;2 &#x3D; 2，则新取出的序列为&lt;1 3 5 7&gt;,&lt;2 4 6 8&gt;</li>
<li>然后下一次就是2&#x2F;2 &#x3D; 1，没得分了，排序也就结束了</li>
</ul>
<h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><p>这个不好描述，不写了~</p>
<ol>
<li>选取有效位(个十百千万)</li>
<li>将元素按顺序放进对应数字（0-9）的队列</li>
<li>再按0-9的顺序将每个队列的元素拿出来</li>
<li>重复上述过程，直到排序完成（有效位的选取是从低到高的）</li>
</ol>
<h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h3><p>整体就是无限二分和选数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里a和b数组没有声明，应该写到外面，a数组是录入数据的数组</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Merge_sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//递归到了只有一个元素，直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//找到中点，然后两边分别再归并（二分）</span></span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">Merge_sort</span>(<span class="number">1</span>, mid);</span><br><span class="line">    <span class="built_in">Merge_sort</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="comment">//合并序列（选数）</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">1</span>, q = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(q &gt; r || (p &lt;= mid &amp;&amp; a[p] &lt;= a[q])) b[i] = a[p++];</span><br><span class="line">        <span class="keyword">else</span> b[i] = a[q++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//还原到a数组里</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r; i++) a[i] = b[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="桶（计数）排序"><a href="#桶（计数）排序" class="headerlink" title="桶（计数）排序"></a>桶（计数）排序</h3><ul>
<li>适用于数据集中，数据范围较小且比较明确的情况</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 10000</span></span><br><span class="line"><span class="type">int</span> cnt[MAXN+<span class="number">1</span>],n,temp;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//输入</span></span><br><span class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    cin &gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        cin &gt;&gt;temp;</span><br><span class="line">        cnt[temp]++; <span class="comment">//计数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= MAXN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt[i])&#123; <span class="comment">//检测数字i有没有出现过</span></span><br><span class="line">            <span class="comment">//出现几次输出几个i</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt[i]; j++) cout &lt;&lt;i &lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/GFSJ-Android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/GFSJ-Android/" class="post-title-link" itemprop="url">GFSJ-Android</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:50:10" itemprop="dateCreated datePublished" datetime="2023-03-31T18:50:10+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 00:53:16" itemprop="dateModified" datetime="2023-04-01T00:53:16+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="app1"><a href="#app1" class="headerlink" title="app1"></a>app1</h3><ul>
<li>jad直接反编译，MainActivity发现版本号与版本名的异或</li>
<li><code>水题</code>，<code>简单使用工具</code></li>
</ul>
<h3 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy-apk"></a>easy-apk</h3><ul>
<li>变表base64</li>
<li><code>水题</code></li>
</ul>
<h3 id="app2"><a href="#app2" class="headerlink" title="app2"></a>app2</h3><ul>
<li>逻辑分析SecondActivity，从而找到加密so文件，确定AES加密，解密</li>
<li><code>so分析</code>，<code>AES</code></li>
</ul>
<h3 id="easy-so"><a href="#easy-so" class="headerlink" title="easy-so"></a>easy-so</h3><ul>
<li>同样从java代码找到so文件关键代码分析，两个简单换位加密</li>
<li><code>so分析</code>，<code>简单加密</code></li>
</ul>
<h3 id="easy-jni"><a href="#easy-jni" class="headerlink" title="easy-jni"></a>easy-jni</h3><ul>
<li>毫无新意，同样so分析，变表base64加换位</li>
</ul>
<h3 id="RememberOther"><a href="#RememberOther" class="headerlink" title="RememberOther"></a>RememberOther</h3><ul>
<li>评价就是有病</li>
<li>直接jadx查看逻辑发现啥都不填return true，MD5解密+安卓就是flag</li>
</ul>
<h3 id="基础android"><a href="#基础android" class="headerlink" title="基础android"></a>基础android</h3><ul>
<li>好题，java层简单加密，以及对广播的一个考察</li>
<li><code>简单逆向</code>，<code>Broadcast</code>，<code>页面跳转</code>，<code>文件流</code></li>
</ul>
<h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><ul>
<li>ab文件–&gt;安卓备份文件</li>
<li>先用<a target="_blank" rel="noopener" href="https://github.com/nelenkov/android-backup-extractor">abe</a>提取一下apk</li>
<li>java -jar abe.jar unpack app3.ab app3.tar</li>
<li>破解数据库密码</li>
<li><a target="_blank" rel="noopener" href="https://github.com/sqlitebrowser/sqlitebrowser">sqlitebrowser</a> 打开携带的数据库找到flag</li>
<li><code>sqlite</code>、<code>安卓备份</code></li>
</ul>
<h3 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h3><ul>
<li>同样是native层对flag的一个加密，解法很多</li>
<li>本质就是一个getflag函数外套了一个getSecret函数，IDA分析getSecret发现就是一个rot1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(this.getSecret(this.getFlag()).equals(this.getSecret(this.encrypt(sInput)))) &#123;</span><br><span class="line">          Toast.makeText(this, <span class="string">&quot;Success&quot;</span>, <span class="number">1</span>).show();</span><br></pre></td></tr></table></figure>

<ul>
<li>1：直接androidkiller篡改代码，打印出执行完getSecret(getflag())函数的返回值，然后进行回转得到flag</li>
<li>2：jeb下断点，动调获得返回值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;ek`fz@q2^x/t^fn0mF^6/^rb`qanqntfg^E`hq|&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>native</code>,<code>hook</code></li>
</ul>
<h3 id="APK逆向"><a href="#APK逆向" class="headerlink" title="APK逆向"></a>APK逆向</h3><ul>
<li>java层仿写加密即可，但是md5加密时候给我报错了：<ul>
<li>Unhandled exception: java.security.NoSuchAlgorithmException</li>
</ul>
</li>
<li>所以我直接jeb动调把加密后的串提取出来了</li>
<li>逻辑分析也可以，不难</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        checkSN(<span class="string">&quot;Tenshine&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">toHexString</span><span class="params">(<span class="type">byte</span>[] bytes, String separator)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(b &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hexString.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            hexString.append(hex).append(separator);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hexString.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkSN</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hexstr</span> <span class="operator">=</span> <span class="string">&quot;b9c77224ff234f27ac6badf83b855c76&quot;</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hexstr.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">            sb.append(hexstr.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userSN</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">        System.out.println(userSN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>难度一般</li>
</ul>
<h3 id="人民的名义-抓捕赵德汉1-200"><a href="#人民的名义-抓捕赵德汉1-200" class="headerlink" title="人民的名义-抓捕赵德汉1-200"></a>人民的名义-抓捕赵德汉1-200</h3><ul>
<li>🤡题，生成flag的md5结果裸奔，直接拿去解密即可</li>
<li>原意应该是利用hexkey对&#x2F;ClassEnc文件进行aes解密，得到已经存在的CheckPass代码，然后生成passCheckObject对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">filename=<span class="string">&quot;ClassEnc&quot;</span></span><br><span class="line">key = <span class="string">&quot;bb27630cf264f8567d185008c10c3f96&quot;</span></span><br><span class="line">key_bytes = <span class="built_in">bytes</span>.fromhex(key)</span><br><span class="line">aes = AES.new((key_bytes), AES.MODE_ECB)</span><br><span class="line">data = <span class="built_in">bytearray</span>(os.path.getsize(filename))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.readinto(data)</span><br><span class="line">	f.close()</span><br><span class="line">decryption_data = aes.decrypt(data)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename+<span class="string">&quot;_decryption.classs&quot;</span>, <span class="string">&#x27;ba&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decryption_data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h3 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h3><ul>
<li>native层的一个题，加密类似于栅栏密码之后三组异或，分别解开就行</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分组init</span></span><br><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">Init</span><span class="params">(<span class="type">char</span> *a2, <span class="type">char</span> *a3, <span class="type">const</span> <span class="type">char</span> *a4, <span class="type">int</span> a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r6</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = v5 % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (v7== <span class="number">2</span>)&#123;</span><br><span class="line">      a3[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">1</span>)&#123;</span><br><span class="line">      a2[v5/<span class="number">3</span>] = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (v7 == <span class="number">0</span>)&#123;</span><br><span class="line">      *(v5/<span class="number">3</span>) = a4[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(a5 != v5);</span><br><span class="line">&#125;</span><br><span class="line">s1 = <span class="string">&quot;fgorl&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;l&#123;sra&quot;</span></span><br><span class="line">s3 = <span class="string">&quot;asoy&#125;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">	<span class="built_in">print</span>(s1[i]+s2[i]+s3[i],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="easy-dex"><a href="#easy-dex" class="headerlink" title="easy-dex"></a>easy-dex</h3><h4 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h4><ul>
<li>这个题蛮有意思，把dex文件放进了native层</li>
<li>so文件拖进IDA找到android-main函数定位关键代码</li>
<li>之后分析解密dump出dex文件，放进原apk中重新识别</li>
<li>jadx分析发现twofish加密，在线网站解密</li>
</ul>
<h4 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h4><ul>
<li>dex段的数据，可以看到从0x7004开始，长度为0x34c10。</li>
<li>至于dex的加密，他是设定了10秒摇手机90次，然后用dex文件段的数据分10组去和摇晃次数做一个异或，最后释放解密的dex文件，进行正常的程序运行，这里放一个网上的代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取数据</span></span><br><span class="line">fLib = <span class="built_in">open</span>(<span class="string">&quot;libnative.so&quot;</span>,<span class="string">&quot;rb&quot;</span>);</span><br><span class="line">fLib.seek(<span class="number">0x6004</span>, <span class="number">0</span>);</span><br><span class="line">read_buf = fLib.read(<span class="number">0x3CA10</span>)</span><br><span class="line">fDump = <span class="built_in">open</span>(<span class="string">&quot;out.dump&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">fDump.write(read_buf);</span><br><span class="line">fDump.close();</span><br><span class="line">fLib.close();</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/out.dump&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    data_len = <span class="built_in">len</span>(data)</span><br><span class="line">    decode_bytes = [<span class="number">0</span>] * data_len</span><br><span class="line"><span class="comment"># 分组异或</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">        per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">        start = i * per_seg_len</span><br><span class="line">        <span class="keyword">while</span> start &lt; (i + <span class="number">1</span>) * per_seg_len:</span><br><span class="line">            decode_bytes[start] = data[start] ^ (i * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 末端</span></span><br><span class="line">    per_seg_len = <span class="built_in">int</span>(<span class="built_in">len</span>(data) // <span class="number">10</span>)</span><br><span class="line">    start = <span class="number">9</span> * per_seg_len</span><br><span class="line">    <span class="keyword">while</span> start &lt; data_len:</span><br><span class="line">        decode_bytes[start] = data[start] ^ <span class="number">89</span></span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line"><span class="comment"># 解压写文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./blog/decode.dex&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(zlib.decompress(<span class="built_in">bytes</span>(decode_bytes)))</span><br><span class="line">java--&gt;native`，`twofish加密`，`dumpdex</span><br></pre></td></tr></table></figure>

<h3 id="boomshakalaka-3"><a href="#boomshakalaka-3" class="headerlink" title="boomshakalaka-3"></a>boomshakalaka-3</h3><ul>
<li>这个题本身不难，但跟鬼打了一样</li>
<li>一个老版飞机大战游戏，jadx打开发现两个包plane和lib，lib明显是原本的游戏，plane是出题人加的</li>
<li>核心在于<code>SharedPreferences接口</code>的数据传输，查资料后了解到这玩意会在&#x2F;data&#x2F;data&#x2F;package name&#x2F;shared_prefs目录以xml格式接受数据</li>
<li>查看Cocos2dxPrefsFile.xml，结合游戏，发现是一个不断追加字符的过程，没在java层找到对应代码，那就去so</li>
<li>so加载了老半天，发现一个score函数，里面就是不断加字符，然后结合题目要求最高分，所以按分数顺序把字符添上得到终极字符串</li>
<li>最后根据题目给出的传参提示串<code>YmF6aW5nYWFhYQ==</code>猜测base64，解码得到flag</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">native`,`cocos2d`,``SharedPreferences</span><br></pre></td></tr></table></figure>

<h3 id="Illusion"><a href="#Illusion" class="headerlink" title="Illusion"></a>Illusion</h3><ul>
<li>发现关键调用checkflag，同时encflag已知，进入so分析</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">encflag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(MainActivity.<span class="built_in">this</span>.getAssets().open(<span class="string">&quot;Flag&quot;</span>))).readLine();</span><br><span class="line"></span><br><span class="line">CheckFlag(flag, encflag))</span><br></pre></td></tr></table></figure>

<ul>
<li>直接搜索checkflag函数，是个假函数，未经调用</li>
<li>搜索onload函数，找到动态加载的真正checkflag函数进行分析</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_DC8</span><span class="params">(_JNIEnv *a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [sp+28h] [bp-34h]</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// [sp+30h] [bp-2Ch]</span></span><br><span class="line">  <span class="type">char</span> *v9; <span class="comment">// [sp+34h] [bp-28h]</span></span><br><span class="line">  <span class="type">char</span> *v10; <span class="comment">// [sp+38h] [bp-24h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a3);	<span class="comment">//input flag</span></span><br><span class="line">  v4 = <span class="built_in">j_strlen</span>(v10);</span><br><span class="line">  v9 = <span class="built_in">j_calloc</span>(<span class="number">1u</span>, v4 + <span class="number">1</span>);</span><br><span class="line">  v8 = <span class="built_in">j_j_Jstring2CStr</span>(a1, a4);	<span class="comment">//encflag</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(v10); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_10C0</span>(v10[i] + aLjavaLangStrin_0[i] - <span class="number">64</span>, <span class="number">93</span>);</span><br><span class="line">    v9[i] = v5 + <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">j_strcmp</span>(v9, v8) )</span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> j__JNIEnv::<span class="built_in">NewStringUTF</span>(a1, <span class="string">&quot;Try Again!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>分析sub_10C0函数，第一层的if判断必为真，只执行第一个函数，函数目的为<code>a1%a2</code>，思路明了，写脚本</li>
<li>网友这个脚本还是有东西的</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">enc_flag = <span class="string">&quot;Ku@&#x27;G_V9v(yGS&quot;</span></span><br><span class="line">data = <span class="string">&quot;(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;&quot;</span></span><br><span class="line">data = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    enc = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> enc_flag]</span><br><span class="line">    flag = [<span class="number">0</span>]*<span class="built_in">len</span>(enc)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        flag[i] = (enc[i]-<span class="number">32</span>)+<span class="number">64</span>-data[i]</span><br><span class="line">        <span class="keyword">while</span> flag[i] &lt; <span class="number">0x32</span>:</span><br><span class="line">            flag[i] += <span class="number">93</span></span><br><span class="line">        <span class="keyword">while</span> flag[i] &gt; <span class="number">125</span>:</span><br><span class="line">            flag[i] -= <span class="number">93</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># CISCN&#123;GJ5728&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Android-Create/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="已经魔化的CTF逆向手">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逆向光点">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Android-Create/" class="post-title-link" itemprop="url">Android-Create</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-31 18:48:58" itemprop="dateCreated datePublished" datetime="2023-03-31T18:48:58+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 10:14:36" itemprop="dateModified" datetime="2023-04-01T10:14:36+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>安卓开发</li>
</ul>
<hr>
<h3 id="主界面"><a href="#主界面" class="headerlink" title="主界面"></a>主界面</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span>                                    </span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="AndroidManifest-xml常见参数"><a href="#AndroidManifest-xml常见参数" class="headerlink" title="AndroidManifest.xml常见参数"></a>AndroidManifest.xml常见参数</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android:name=&quot;&quot;                 //设置activity所属application</span><br><span class="line">android:exported=&quot;true&quot;         //允许外部组件启动这个Activity</span><br><span class="line">android:debuggable=&quot;true&quot;       //设定apk可调试</span><br></pre></td></tr></table></figure>

<h3 id="夜神模拟器无法adb识别"><a href="#夜神模拟器无法adb识别" class="headerlink" title="夜神模拟器无法adb识别"></a>夜神模拟器无法adb识别</h3><ul>
<li>adb版本不一致，CV</li>
</ul>
<h3 id="隐藏标题栏失效"><a href="#隐藏标题栏失效" class="headerlink" title="隐藏标题栏失效"></a>隐藏标题栏失效</h3><ul>
<li>继承的是 Activity</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Java:</span><br><span class="line">requestWindowFeature(Window.FEATURE_NO_TITLE);</span><br><span class="line">//写在setContentView()方法的前面</span><br><span class="line"></span><br><span class="line">AndroidManifest.xml:</span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@android:style/Theme.NoTitleBar&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>继承的是 AppCompatActivity</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Java:</span><br><span class="line">getSupportActionBar().hide();</span><br><span class="line">//写在setContentView()方法的后面</span><br><span class="line"></span><br><span class="line">AndroidManifest.xml:</span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.AppCompat.NoActionBar&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Java问题"><a href="#Java问题" class="headerlink" title="Java问题"></a>Java问题</h2><ul>
<li>trim函数，去掉字符串头尾空白字符</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">UmVfX1BvaW50</p>
  <div class="site-description" itemprop="description">已经魔化的CTF逆向手</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">UmVfX1BvaW50</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
